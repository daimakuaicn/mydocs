<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.67" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://vuepress-theme-hope-docs-demo.netlify.app/SpringBoot/SpringCloud.html"><meta property="og:site_name" content="ä»£ç å—"><meta property="og:title" content="SpringCloud"><meta property="og:description" content="1.åŸºæœ¬æ¦‚å¿µ 1.1å•ä½“æ¶æ„ å•ä½“æ¶æ„: æŠŠé¡¹ç›®ä¸­æ‰€æœ‰åŠŸèƒ½æ¨¡å—å…¨éƒ¨å†™åœ¨ä¸€ä¸ªå·¥ç¨‹ä¸­ ç¼ºç‚¹ ä»£ç æ··ä¹±,ç»´æŠ¤å›°éš¾.; ä¿®æ”¹ä¸€ä¸ªåŠŸèƒ½,å¯¹å…¶ä»–åŠŸèƒ½äº§ç”Ÿå½±å“,ç‰µä¸€å‘åŠ¨å…¨èº«.; æ‹“å±•æ€§å·®,å¯é æ€§å·®,é£é™©é«˜; ä¼˜ç‚¹ ç»“æ„ç®€å•,éƒ¨ç½²æ–¹ä¾¿,æ˜“äºç»´æŠ¤; 1.2å¾®æœåŠ¡æ¶æ„ å¾®æœåŠ¡æ¶æ„: å¾®å°æœåŠ¡,æŠŠä¸€ä¸ªå®Œæ•´é¡¹ç›®,æŒ‰ç…§åŠŸèƒ½æ‹†åˆ†æˆå¤šä¸ªç‹¬ç«‹çš„æœåŠ¡æ¨¡å—,æ¯ä¸ªæœåŠ¡æ¨¡å—ç‹¬ç«‹è¿è¡Œ,..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="Mr.Hope"><meta property="article:tag" content="Markdown"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"SpringCloud","image":[""],"dateModified":null,"author":[{"@type":"Person","name":"Mr.Hope","url":"https://mister-hope.com"}]}</script><title>SpringCloud | ä»£ç å—</title><meta name="description" content="1.åŸºæœ¬æ¦‚å¿µ 1.1å•ä½“æ¶æ„ å•ä½“æ¶æ„: æŠŠé¡¹ç›®ä¸­æ‰€æœ‰åŠŸèƒ½æ¨¡å—å…¨éƒ¨å†™åœ¨ä¸€ä¸ªå·¥ç¨‹ä¸­ ç¼ºç‚¹ ä»£ç æ··ä¹±,ç»´æŠ¤å›°éš¾.; ä¿®æ”¹ä¸€ä¸ªåŠŸèƒ½,å¯¹å…¶ä»–åŠŸèƒ½äº§ç”Ÿå½±å“,ç‰µä¸€å‘åŠ¨å…¨èº«.; æ‹“å±•æ€§å·®,å¯é æ€§å·®,é£é™©é«˜; ä¼˜ç‚¹ ç»“æ„ç®€å•,éƒ¨ç½²æ–¹ä¾¿,æ˜“äºç»´æŠ¤; 1.2å¾®æœåŠ¡æ¶æ„ å¾®æœåŠ¡æ¶æ„: å¾®å°æœåŠ¡,æŠŠä¸€ä¸ªå®Œæ•´é¡¹ç›®,æŒ‰ç…§åŠŸèƒ½æ‹†åˆ†æˆå¤šä¸ªç‹¬ç«‹çš„æœåŠ¡æ¨¡å—,æ¯ä¸ªæœåŠ¡æ¨¡å—ç‹¬ç«‹è¿è¡Œ,...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-6d08976d.css" as="style"><link rel="stylesheet" href="/assets/style-6d08976d.css">
    <link rel="modulepreload" href="/assets/app-bcb92fc7.js"><link rel="modulepreload" href="/assets/SpringCloud.html-8962b090.js"><link rel="modulepreload" href="/assets/SpringCloud.html-09a01dc3.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-c27b6911.js"><link rel="prefetch" href="/assets/index.html-dc6d6992.js" as="script"><link rel="prefetch" href="/assets/slides.html-e986989a.js" as="script"><link rel="prefetch" href="/assets/disable.html-f7e02136.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-c3dc937a.js" as="script"><link rel="prefetch" href="/assets/markdown.html-70b9d199.js" as="script"><link rel="prefetch" href="/assets/page.html-5669bbf9.js" as="script"><link rel="prefetch" href="/assets/index.html-c66c9b5f.js" as="script"><link rel="prefetch" href="/assets/index.html-b473a5ac.js" as="script"><link rel="prefetch" href="/assets/index.html-7693cf65.js" as="script"><link rel="prefetch" href="/assets/baz.html-eb62bfa4.js" as="script"><link rel="prefetch" href="/assets/index.html-4dc4f810.js" as="script"><link rel="prefetch" href="/assets/ray.html-7000db6e.js" as="script"><link rel="prefetch" href="/assets/index.html-6542ee07.js" as="script"><link rel="prefetch" href="/assets/404.html-1fa9fca5.js" as="script"><link rel="prefetch" href="/assets/index.html-ccd9eb2c.js" as="script"><link rel="prefetch" href="/assets/slides.html-2937d889.js" as="script"><link rel="prefetch" href="/assets/disable.html-01b25145.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-11baeb2a.js" as="script"><link rel="prefetch" href="/assets/markdown.html-2db3f0a8.js" as="script"><link rel="prefetch" href="/assets/page.html-8a6f22ae.js" as="script"><link rel="prefetch" href="/assets/index.html-7d18c8ce.js" as="script"><link rel="prefetch" href="/assets/index.html-c509d4c9.js" as="script"><link rel="prefetch" href="/assets/index.html-3dea0939.js" as="script"><link rel="prefetch" href="/assets/baz.html-1e734202.js" as="script"><link rel="prefetch" href="/assets/index.html-fde2345c.js" as="script"><link rel="prefetch" href="/assets/ray.html-628f98bb.js" as="script"><link rel="prefetch" href="/assets/index.html-df10228f.js" as="script"><link rel="prefetch" href="/assets/404.html-278e1aa5.js" as="script"><link rel="prefetch" href="/assets/giscus-0b7adcf8.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-1464cdb9.js" as="script"><link rel="prefetch" href="/assets/SearchResult-ce4d988b.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt="ä»£ç å—"><!----><span class="vp-site-name hide-in-pad">ä»£ç å—</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a aria-label="ä»£ç å—" class="vp-link nav-link nav-link" href="/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>ä»£ç å—<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="ä¸»è¦åŠŸèƒ½ä¸é…ç½®æ¼”ç¤º" class="vp-link nav-link nav-link" href="/demo/"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>ä¸»è¦åŠŸèƒ½ä¸é…ç½®æ¼”ç¤º<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="SpringBoot" class="vp-link nav-link active nav-link active" href="/SpringBoot/"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>SpringBoot<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="æŒ‡å—"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span>æŒ‡å—</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Bar</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a aria-label="Baz" class="vp-link nav-link nav-link" href="/guide/bar/baz.html"><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>Baz<!----></a></li><li class="dropdown-subitem"><a aria-label="..." class="vp-link nav-link nav-link" href="/guide/bar/"><span class="font-icon icon fa-fw fa-sm fas fa-ellipsis" style=""></span>...<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Foo</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a aria-label="Ray" class="vp-link nav-link nav-link" href="/guide/foo/ray.html"><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>Ray<!----></a></li><li class="dropdown-subitem"><a aria-label="..." class="vp-link nav-link nav-link" href="/guide/foo/"><span class="font-icon icon fa-fw fa-sm fas fa-ellipsis" style=""></span>...<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="æŒ‡å—"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-lightbulb" style=""></span>æŒ‡å—</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Bar</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a aria-label="Baz" class="vp-link nav-link nav-link" href="/guide/bar/baz.html"><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>Baz<!----></a></li><li class="dropdown-subitem"><a aria-label="..." class="vp-link nav-link nav-link" href="/guide/bar/"><span class="font-icon icon fa-fw fa-sm fas fa-ellipsis" style=""></span>...<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Foo</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a aria-label="Ray" class="vp-link nav-link nav-link" href="/guide/foo/ray.html"><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span>Ray<!----></a></li><li class="dropdown-subitem"><a aria-label="..." class="vp-link nav-link nav-link" href="/guide/foo/"><span class="font-icon icon fa-fw fa-sm fas fa-ellipsis" style=""></span>...<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="https://theme-hope.vuejs.press/zh/" rel="noopener noreferrer" target="_blank" aria-label="V2 æ–‡æ¡£" class="nav-link"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>V2 æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><button type="button" class="search-pro-button" role="search" aria-label="æœç´¢"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">æœç´¢</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><!--[--><a aria-label="SpringBoot" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/SpringBoot/"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>SpringBoot<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="SpringBoot" class="vp-link nav-link active vp-sidebar-link vp-sidebar-page active nav-link active vp-sidebar-link vp-sidebar-page active" href="/SpringBoot/SpringCloud.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>SpringBoot<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="1.åŸºæœ¬æ¦‚å¿µ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_1-åŸºæœ¬æ¦‚å¿µ"><!---->1.åŸºæœ¬æ¦‚å¿µ<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="1.1å•ä½“æ¶æ„" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_1-1å•ä½“æ¶æ„"><!---->1.1å•ä½“æ¶æ„<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1.2å¾®æœåŠ¡æ¶æ„" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_1-2å¾®æœåŠ¡æ¶æ„"><!---->1.2å¾®æœåŠ¡æ¶æ„<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.SpringCloudåˆä½“éªŒ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_2-springcloudåˆä½“éªŒ"><!---->2.SpringCloudåˆä½“éªŒ<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="2.1ä»€ä¹ˆæ˜¯SpringCloud" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_2-1ä»€ä¹ˆæ˜¯springcloud"><!---->2.1ä»€ä¹ˆæ˜¯SpringCloud<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.2SpringCloudç»„æˆ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_2-2springcloudç»„æˆ"><!---->2.2SpringCloudç»„æˆ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.3SpringCloudåˆä½“éªŒ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_2-3springcloudåˆä½“éªŒ"><!---->2.3SpringCloudåˆä½“éªŒ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.Nacosæ³¨å†Œä¸­å¿ƒ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_3-nacosæ³¨å†Œä¸­å¿ƒ"><!---->3.Nacosæ³¨å†Œä¸­å¿ƒ<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="3.1 Nacosæ³¨å†Œä¸­å¿ƒç®€ä»‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_3-1-nacosæ³¨å†Œä¸­å¿ƒç®€ä»‹"><!---->3.1 Nacosæ³¨å†Œä¸­å¿ƒç®€ä»‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.2æ³¨å†Œä¸­å¿ƒäº§å“" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_3-2æ³¨å†Œä¸­å¿ƒäº§å“"><!---->3.2æ³¨å†Œä¸­å¿ƒäº§å“<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Eurela" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#eurela"><!---->Eurela<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="nacos" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#nacos"><!---->nacos<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.3å¾®æœåŠ¡é›†æˆnacos" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_3-3å¾®æœåŠ¡é›†æˆnacos"><!---->3.3å¾®æœåŠ¡é›†æˆnacos<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.4Nacosé«˜çº§ç‰¹æ€§:æœåŠ¡é›†ç¾¤" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_3-4nacosé«˜çº§ç‰¹æ€§-æœåŠ¡é›†ç¾¤"><!---->3.4Nacosé«˜çº§ç‰¹æ€§:æœåŠ¡é›†ç¾¤<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.5Nacosé«˜çº§ç‰¹æ€§:æƒé‡é…ç½®(äº†è§£)" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_3-5nacosé«˜çº§ç‰¹æ€§-æƒé‡é…ç½®-äº†è§£"><!---->3.5Nacosé«˜çº§ç‰¹æ€§:æƒé‡é…ç½®(äº†è§£)<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.6Nacosé«˜çº§ç‰¹æ€§:ç¯å¢ƒéš”ç¦»" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_3-6nacosé«˜çº§ç‰¹æ€§-ç¯å¢ƒéš”ç¦»"><!---->3.6Nacosé«˜çº§ç‰¹æ€§:ç¯å¢ƒéš”ç¦»<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.7Nacosé«˜çº§ç‰¹æ€§:å®ä¾‹ç±»å‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_3-7nacosé«˜çº§ç‰¹æ€§-å®ä¾‹ç±»å‹"><!---->3.7Nacosé«˜çº§ç‰¹æ€§:å®ä¾‹ç±»å‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.LoadBalancer" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_4-loadbalancer"><!---->4.LoadBalancer<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="4.1ç®€ä»‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_4-1ç®€ä»‹"><!---->4.1ç®€ä»‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.2 LoadBalancerçš„æ‰§è¡Œæµç¨‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_4-2-loadbalancerçš„æ‰§è¡Œæµç¨‹"><!---->4.2 LoadBalancerçš„æ‰§è¡Œæµç¨‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.3æºç è·Ÿè¸ª" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_4-3æºç è·Ÿè¸ª"><!---->4.3æºç è·Ÿè¸ª<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.4è¡¥å……çŸ¥è¯†:è´Ÿè½½å‡è¡¡ç®—æ³•:" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_4-4è¡¥å……çŸ¥è¯†-è´Ÿè½½å‡è¡¡ç®—æ³•"><!---->4.4è¡¥å……çŸ¥è¯†:è´Ÿè½½å‡è¡¡ç®—æ³•:<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.5æ›´æ”¹è´Ÿè½½å‡è¡¡ç®—æ³•" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_4-5æ›´æ”¹è´Ÿè½½å‡è¡¡ç®—æ³•"><!---->4.5æ›´æ”¹è´Ÿè½½å‡è¡¡ç®—æ³•<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.OpenFeignç»„ä»¶" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_5-openfeignç»„ä»¶"><!---->5.OpenFeignç»„ä»¶<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="5.1OpenFeignç»„ä»¶ä»‹ç»" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_5-1openfeignç»„ä»¶ä»‹ç»"><!---->5.1OpenFeignç»„ä»¶ä»‹ç»<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.2OpenFeignåˆä½“éªŒ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_5-2openfeignåˆä½“éªŒ"><!---->5.2OpenFeignåˆä½“éªŒ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.3OpenFeignè‡ªå®šä¹‰é…ç½®" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_5-3openfeignè‡ªå®šä¹‰é…ç½®"><!---->5.3OpenFeignè‡ªå®šä¹‰é…ç½®<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.4ä»£ç ä¼˜åŒ–" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_5-4ä»£ç ä¼˜åŒ–"><!---->5.4ä»£ç ä¼˜åŒ–<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6.Gatewayç»„ä»¶" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_6-gatewayç»„ä»¶"><!---->6.Gatewayç»„ä»¶<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="6.1è®¤è¯†Gateway" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_6-1è®¤è¯†gateway"><!---->6.1è®¤è¯†Gateway<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6.2ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_6-2ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ"><!---->6.2ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6.3Gatewayå·¥ä½œæµç¨‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_6-3gatewayå·¥ä½œæµç¨‹"><!---->6.3Gatewayå·¥ä½œæµç¨‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6.4Gatewayåˆä½“éªŒ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_6-4gatewayåˆä½“éªŒ"><!---->6.4Gatewayåˆä½“éªŒ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6.5Predicateçš„ä½¿ç”¨(è·¯ç”±æ–­è¨€å·¥å‚)" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_6-5predicateçš„ä½¿ç”¨-è·¯ç”±æ–­è¨€å·¥å‚"><!---->6.5Predicateçš„ä½¿ç”¨(è·¯ç”±æ–­è¨€å·¥å‚)<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6.6è¿‡æ»¤å™¨" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_6-6è¿‡æ»¤å™¨"><!---->6.6è¿‡æ»¤å™¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="7.Nacosé…ç½®ä¸­å¿ƒ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_7-nacosé…ç½®ä¸­å¿ƒ"><!---->7.Nacosé…ç½®ä¸­å¿ƒ<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="7.1 ç»Ÿä¸€é…ç½®ç®¡ç†" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_7-1-ç»Ÿä¸€é…ç½®ç®¡ç†"><!---->7.1 ç»Ÿä¸€é…ç½®ç®¡ç†<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="7.2 Nacoså…¥é—¨" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_7-2-nacoså…¥é—¨"><!---->7.2 Nacoså…¥é—¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="7.3 é…ç½®çƒ­æ›´æ–°" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_7-3-é…ç½®çƒ­æ›´æ–°"><!---->7.3 é…ç½®çƒ­æ›´æ–°<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="7.4 é…ç½®ä¼˜å…ˆçº§" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_7-4-é…ç½®ä¼˜å…ˆçº§"><!---->7.4 é…ç½®ä¼˜å…ˆçº§<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="8.Sentineléƒ¨åˆ†" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_8-sentineléƒ¨åˆ†"><!---->8.Sentineléƒ¨åˆ†<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="8.1 åˆè¯†sentinel" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_8-1-åˆè¯†sentinel"><!---->8.1 åˆè¯†sentinel<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="8.2 sentinelå…¥é—¨" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_8-2-sentinelå…¥é—¨"><!---->8.2 sentinelå…¥é—¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="8.3 æµé‡æ§åˆ¶" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_8-3-æµé‡æ§åˆ¶"><!---->8.3 æµé‡æ§åˆ¶<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a aria-label="SpringCloud" class="vp-link nav-link active vp-sidebar-link vp-sidebar-page active nav-link active vp-sidebar-link vp-sidebar-page active" href="/SpringBoot/SpringCloud.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>SpringCloud<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="1.åŸºæœ¬æ¦‚å¿µ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_1-åŸºæœ¬æ¦‚å¿µ"><!---->1.åŸºæœ¬æ¦‚å¿µ<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="1.1å•ä½“æ¶æ„" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_1-1å•ä½“æ¶æ„"><!---->1.1å•ä½“æ¶æ„<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1.2å¾®æœåŠ¡æ¶æ„" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_1-2å¾®æœåŠ¡æ¶æ„"><!---->1.2å¾®æœåŠ¡æ¶æ„<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.SpringCloudåˆä½“éªŒ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_2-springcloudåˆä½“éªŒ"><!---->2.SpringCloudåˆä½“éªŒ<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="2.1ä»€ä¹ˆæ˜¯SpringCloud" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_2-1ä»€ä¹ˆæ˜¯springcloud"><!---->2.1ä»€ä¹ˆæ˜¯SpringCloud<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.2SpringCloudç»„æˆ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_2-2springcloudç»„æˆ"><!---->2.2SpringCloudç»„æˆ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.3SpringCloudåˆä½“éªŒ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_2-3springcloudåˆä½“éªŒ"><!---->2.3SpringCloudåˆä½“éªŒ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.Nacosæ³¨å†Œä¸­å¿ƒ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_3-nacosæ³¨å†Œä¸­å¿ƒ"><!---->3.Nacosæ³¨å†Œä¸­å¿ƒ<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="3.1 Nacosæ³¨å†Œä¸­å¿ƒç®€ä»‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_3-1-nacosæ³¨å†Œä¸­å¿ƒç®€ä»‹"><!---->3.1 Nacosæ³¨å†Œä¸­å¿ƒç®€ä»‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.2æ³¨å†Œä¸­å¿ƒäº§å“" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_3-2æ³¨å†Œä¸­å¿ƒäº§å“"><!---->3.2æ³¨å†Œä¸­å¿ƒäº§å“<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="Eurela" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#eurela"><!---->Eurela<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="nacos" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#nacos"><!---->nacos<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.3å¾®æœåŠ¡é›†æˆnacos" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_3-3å¾®æœåŠ¡é›†æˆnacos"><!---->3.3å¾®æœåŠ¡é›†æˆnacos<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.4Nacosé«˜çº§ç‰¹æ€§:æœåŠ¡é›†ç¾¤" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_3-4nacosé«˜çº§ç‰¹æ€§-æœåŠ¡é›†ç¾¤"><!---->3.4Nacosé«˜çº§ç‰¹æ€§:æœåŠ¡é›†ç¾¤<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.5Nacosé«˜çº§ç‰¹æ€§:æƒé‡é…ç½®(äº†è§£)" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_3-5nacosé«˜çº§ç‰¹æ€§-æƒé‡é…ç½®-äº†è§£"><!---->3.5Nacosé«˜çº§ç‰¹æ€§:æƒé‡é…ç½®(äº†è§£)<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.6Nacosé«˜çº§ç‰¹æ€§:ç¯å¢ƒéš”ç¦»" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_3-6nacosé«˜çº§ç‰¹æ€§-ç¯å¢ƒéš”ç¦»"><!---->3.6Nacosé«˜çº§ç‰¹æ€§:ç¯å¢ƒéš”ç¦»<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="3.7Nacosé«˜çº§ç‰¹æ€§:å®ä¾‹ç±»å‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_3-7nacosé«˜çº§ç‰¹æ€§-å®ä¾‹ç±»å‹"><!---->3.7Nacosé«˜çº§ç‰¹æ€§:å®ä¾‹ç±»å‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.LoadBalancer" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_4-loadbalancer"><!---->4.LoadBalancer<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="4.1ç®€ä»‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_4-1ç®€ä»‹"><!---->4.1ç®€ä»‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.2 LoadBalancerçš„æ‰§è¡Œæµç¨‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_4-2-loadbalancerçš„æ‰§è¡Œæµç¨‹"><!---->4.2 LoadBalancerçš„æ‰§è¡Œæµç¨‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.3æºç è·Ÿè¸ª" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_4-3æºç è·Ÿè¸ª"><!---->4.3æºç è·Ÿè¸ª<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.4è¡¥å……çŸ¥è¯†:è´Ÿè½½å‡è¡¡ç®—æ³•:" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_4-4è¡¥å……çŸ¥è¯†-è´Ÿè½½å‡è¡¡ç®—æ³•"><!---->4.4è¡¥å……çŸ¥è¯†:è´Ÿè½½å‡è¡¡ç®—æ³•:<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.5æ›´æ”¹è´Ÿè½½å‡è¡¡ç®—æ³•" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_4-5æ›´æ”¹è´Ÿè½½å‡è¡¡ç®—æ³•"><!---->4.5æ›´æ”¹è´Ÿè½½å‡è¡¡ç®—æ³•<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.OpenFeignç»„ä»¶" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_5-openfeignç»„ä»¶"><!---->5.OpenFeignç»„ä»¶<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="5.1OpenFeignç»„ä»¶ä»‹ç»" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_5-1openfeignç»„ä»¶ä»‹ç»"><!---->5.1OpenFeignç»„ä»¶ä»‹ç»<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.2OpenFeignåˆä½“éªŒ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_5-2openfeignåˆä½“éªŒ"><!---->5.2OpenFeignåˆä½“éªŒ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.3OpenFeignè‡ªå®šä¹‰é…ç½®" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_5-3openfeignè‡ªå®šä¹‰é…ç½®"><!---->5.3OpenFeignè‡ªå®šä¹‰é…ç½®<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.4ä»£ç ä¼˜åŒ–" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_5-4ä»£ç ä¼˜åŒ–"><!---->5.4ä»£ç ä¼˜åŒ–<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6.Gatewayç»„ä»¶" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_6-gatewayç»„ä»¶"><!---->6.Gatewayç»„ä»¶<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="6.1è®¤è¯†Gateway" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_6-1è®¤è¯†gateway"><!---->6.1è®¤è¯†Gateway<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6.2ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_6-2ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ"><!---->6.2ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6.3Gatewayå·¥ä½œæµç¨‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_6-3gatewayå·¥ä½œæµç¨‹"><!---->6.3Gatewayå·¥ä½œæµç¨‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6.4Gatewayåˆä½“éªŒ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_6-4gatewayåˆä½“éªŒ"><!---->6.4Gatewayåˆä½“éªŒ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6.5Predicateçš„ä½¿ç”¨(è·¯ç”±æ–­è¨€å·¥å‚)" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_6-5predicateçš„ä½¿ç”¨-è·¯ç”±æ–­è¨€å·¥å‚"><!---->6.5Predicateçš„ä½¿ç”¨(è·¯ç”±æ–­è¨€å·¥å‚)<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6.6è¿‡æ»¤å™¨" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_6-6è¿‡æ»¤å™¨"><!---->6.6è¿‡æ»¤å™¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="7.Nacosé…ç½®ä¸­å¿ƒ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_7-nacosé…ç½®ä¸­å¿ƒ"><!---->7.Nacosé…ç½®ä¸­å¿ƒ<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="7.1 ç»Ÿä¸€é…ç½®ç®¡ç†" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_7-1-ç»Ÿä¸€é…ç½®ç®¡ç†"><!---->7.1 ç»Ÿä¸€é…ç½®ç®¡ç†<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="7.2 Nacoså…¥é—¨" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_7-2-nacoså…¥é—¨"><!---->7.2 Nacoså…¥é—¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="7.3 é…ç½®çƒ­æ›´æ–°" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_7-3-é…ç½®çƒ­æ›´æ–°"><!---->7.3 é…ç½®çƒ­æ›´æ–°<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="7.4 é…ç½®ä¼˜å…ˆçº§" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_7-4-é…ç½®ä¼˜å…ˆçº§"><!---->7.4 é…ç½®ä¼˜å…ˆçº§<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="8.Sentineléƒ¨åˆ†" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_8-sentineléƒ¨åˆ†"><!---->8.Sentineléƒ¨åˆ†<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="8.1 åˆè¯†sentinel" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_8-1-åˆè¯†sentinel"><!---->8.1 åˆè¯†sentinel<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="8.2 sentinelå…¥é—¨" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_8-2-sentinelå…¥é—¨"><!---->8.2 sentinelå…¥é—¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="8.3 æµé‡æ§åˆ¶" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/SpringBoot/SpringCloud.html#_8-3-æµé‡æ§åˆ¶"><!---->8.3 æµé‡æ§åˆ¶<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon fa-fw fa-sm fab fa-markdown" style=""></span>SpringCloud</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://mister-hope.com" target="_blank" rel="noopener noreferrer">Mr.Hope</a></span><span property="author" content="Mr.Hope"></span></span><!----><!----><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 52 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT52M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category8" role>SpringåŸºç¡€</span><!--]--><meta property="articleSection" content="SpringåŸºç¡€"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item tag1" role>Markdown</span><!--]--><meta property="keywords" content="Markdown"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#_1-åŸºæœ¬æ¦‚å¿µ">1.åŸºæœ¬æ¦‚å¿µ</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_1-1å•ä½“æ¶æ„">1.1å•ä½“æ¶æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_1-2å¾®æœåŠ¡æ¶æ„">1.2å¾®æœåŠ¡æ¶æ„</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#_2-springcloudåˆä½“éªŒ">2.SpringCloudåˆä½“éªŒ</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_2-1ä»€ä¹ˆæ˜¯springcloud">2.1ä»€ä¹ˆæ˜¯SpringCloud</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_2-2springcloudç»„æˆ">2.2SpringCloudç»„æˆ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_2-3springcloudåˆä½“éªŒ">2.3SpringCloudåˆä½“éªŒ</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#_3-nacosæ³¨å†Œä¸­å¿ƒ">3.Nacosæ³¨å†Œä¸­å¿ƒ</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_3-1-nacosæ³¨å†Œä¸­å¿ƒç®€ä»‹">3.1 Nacosæ³¨å†Œä¸­å¿ƒç®€ä»‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_3-2æ³¨å†Œä¸­å¿ƒäº§å“">3.2æ³¨å†Œä¸­å¿ƒäº§å“</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#eurela">Eurela</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#nacos">nacos</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_3-3å¾®æœåŠ¡é›†æˆnacos">3.3å¾®æœåŠ¡é›†æˆnacos</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_3-4nacosé«˜çº§ç‰¹æ€§-æœåŠ¡é›†ç¾¤">3.4Nacosé«˜çº§ç‰¹æ€§:æœåŠ¡é›†ç¾¤</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_3-5nacosé«˜çº§ç‰¹æ€§-æƒé‡é…ç½®-äº†è§£">3.5Nacosé«˜çº§ç‰¹æ€§:æƒé‡é…ç½®(äº†è§£)</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_3-6nacosé«˜çº§ç‰¹æ€§-ç¯å¢ƒéš”ç¦»">3.6Nacosé«˜çº§ç‰¹æ€§:ç¯å¢ƒéš”ç¦»</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_3-7nacosé«˜çº§ç‰¹æ€§-å®ä¾‹ç±»å‹">3.7Nacosé«˜çº§ç‰¹æ€§:å®ä¾‹ç±»å‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#_4-loadbalancer">4.LoadBalancer</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_4-1ç®€ä»‹">4.1ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_4-2-loadbalancerçš„æ‰§è¡Œæµç¨‹">4.2 LoadBalancerçš„æ‰§è¡Œæµç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_4-3æºç è·Ÿè¸ª">4.3æºç è·Ÿè¸ª</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_4-4è¡¥å……çŸ¥è¯†-è´Ÿè½½å‡è¡¡ç®—æ³•">4.4è¡¥å……çŸ¥è¯†:è´Ÿè½½å‡è¡¡ç®—æ³•:</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_4-5æ›´æ”¹è´Ÿè½½å‡è¡¡ç®—æ³•">4.5æ›´æ”¹è´Ÿè½½å‡è¡¡ç®—æ³•</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#_5-openfeignç»„ä»¶">5.OpenFeignç»„ä»¶</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_5-1openfeignç»„ä»¶ä»‹ç»">5.1OpenFeignç»„ä»¶ä»‹ç»</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_5-2openfeignåˆä½“éªŒ">5.2OpenFeignåˆä½“éªŒ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_5-3openfeignè‡ªå®šä¹‰é…ç½®">5.3OpenFeignè‡ªå®šä¹‰é…ç½®</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_5-4ä»£ç ä¼˜åŒ–">5.4ä»£ç ä¼˜åŒ–</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#_6-gatewayç»„ä»¶">6.Gatewayç»„ä»¶</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_6-1è®¤è¯†gateway">6.1è®¤è¯†Gateway</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_6-2ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ">6.2ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_6-3gatewayå·¥ä½œæµç¨‹">6.3Gatewayå·¥ä½œæµç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_6-4gatewayåˆä½“éªŒ">6.4Gatewayåˆä½“éªŒ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_6-5predicateçš„ä½¿ç”¨-è·¯ç”±æ–­è¨€å·¥å‚">6.5Predicateçš„ä½¿ç”¨(è·¯ç”±æ–­è¨€å·¥å‚)</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_6-6è¿‡æ»¤å™¨">6.6è¿‡æ»¤å™¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#_7-nacosé…ç½®ä¸­å¿ƒ">7.Nacosé…ç½®ä¸­å¿ƒ</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_7-1-ç»Ÿä¸€é…ç½®ç®¡ç†">7.1 ç»Ÿä¸€é…ç½®ç®¡ç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_7-2-nacoså…¥é—¨">7.2 Nacoså…¥é—¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_7-3-é…ç½®çƒ­æ›´æ–°">7.3 é…ç½®çƒ­æ›´æ–°</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_7-4-é…ç½®ä¼˜å…ˆçº§">7.4 é…ç½®ä¼˜å…ˆçº§</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/#_8-sentineléƒ¨åˆ†">8.Sentineléƒ¨åˆ†</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_8-1-åˆè¯†sentinel">8.1 åˆè¯†sentinel</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_8-2-sentinelå…¥é—¨">8.2 sentinelå…¥é—¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/#_8-3-æµé‡æ§åˆ¶">8.3 æµé‡æ§åˆ¶</a></li><!----><!--]--></ul></li><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h2 id="_1-åŸºæœ¬æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#_1-åŸºæœ¬æ¦‚å¿µ" aria-hidden="true">#</a> 1.åŸºæœ¬æ¦‚å¿µ</h2><h3 id="_1-1å•ä½“æ¶æ„" tabindex="-1"><a class="header-anchor" href="#_1-1å•ä½“æ¶æ„" aria-hidden="true">#</a> 1.1å•ä½“æ¶æ„</h3><p><strong>å•ä½“æ¶æ„:</strong> æŠŠé¡¹ç›®ä¸­æ‰€æœ‰åŠŸèƒ½æ¨¡å—å…¨éƒ¨å†™åœ¨ä¸€ä¸ªå·¥ç¨‹ä¸­</p><p><strong>ç¼ºç‚¹</strong></p><ul><li>ä»£ç æ··ä¹±,ç»´æŠ¤å›°éš¾.</li><li>ä¿®æ”¹ä¸€ä¸ªåŠŸèƒ½,å¯¹å…¶ä»–åŠŸèƒ½äº§ç”Ÿå½±å“,ç‰µä¸€å‘åŠ¨å…¨èº«.</li><li>æ‹“å±•æ€§å·®,å¯é æ€§å·®,é£é™©é«˜</li></ul><p><strong>ä¼˜ç‚¹</strong></p><ul><li>ç»“æ„ç®€å•,éƒ¨ç½²æ–¹ä¾¿,æ˜“äºç»´æŠ¤</li></ul><h3 id="_1-2å¾®æœåŠ¡æ¶æ„" tabindex="-1"><a class="header-anchor" href="#_1-2å¾®æœåŠ¡æ¶æ„" aria-hidden="true">#</a> 1.2å¾®æœåŠ¡æ¶æ„</h3><p><strong>å¾®æœåŠ¡æ¶æ„:</strong> å¾®å°æœåŠ¡,æŠŠä¸€ä¸ªå®Œæ•´é¡¹ç›®,æŒ‰ç…§åŠŸèƒ½æ‹†åˆ†æˆå¤šä¸ªç‹¬ç«‹çš„æœåŠ¡æ¨¡å—,æ¯ä¸ªæœåŠ¡æ¨¡å—ç‹¬ç«‹è¿è¡Œ,ç‹¬ç«‹éƒ¨ç½²,å¯ä»¥ä½¿ç”¨ä¸åŒçš„æ•°æ®åº“,å¯ä»¥ä½¿ç”¨ä¸åŒçš„è¯­è¨€.</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025150308975.png" alt="image-20231025150308975" tabindex="0" loading="lazy"><figcaption>image-20231025150308975</figcaption></figure><p><strong>ä¼˜ç‚¹:</strong></p><ul><li>ç›¸äº’ç‹¬ç«‹,è°ä¿®æ”¹æŸä¸ªæœåŠ¡,å…¶ä»–æœåŠ¡ä¸å—å½±å“,è§£è€¦åˆ</li><li>å¯æ‹“å±•æ€§å¥½</li><li>å®¹é”™æ€§é«˜</li><li>é«˜æ•ˆæ€§å¼º</li><li>çµæ´»æ€§å¼º</li></ul><p><strong>ç¼ºç‚¹:</strong></p><ul><li>éƒ¨ç½²ä¸æ˜¯å¾ˆæ–¹ä¾¿</li><li>å¾®æœåŠ¡çš„ç®¡ç†</li><li>æœåŠ¡é—´çš„é€šè®¯</li><li>å‰ç«¯è®¿é—®é—®é¢˜</li><li>é…ç½®æ–‡ä»¶ç®¡ç†</li></ul><p><strong>ç‰¹ç‚¹:</strong></p><ol><li>å•ä¸€èŒè´£:æ¯ä¸ªæœåŠ¡åšåˆ°å¯¹åº”å”¯ä¸€ä¸šåŠ¡èƒ½åŠ›</li><li>è‡ªæ²»:å›¢é˜Ÿç‹¬ç«‹,æ•°æ®ç‹¬ç«‹,å µè·¯éƒ¨ç½²å’Œäº¤ä»˜</li><li>é¢å‘æœåŠ¡:æœåŠ¡æä¾›å”¯ä¸€æ ‡å‡†çš„æ¥å£,ä¸è¯­è¨€å’ŒæŠ€æœ¯æ— å…³</li></ol><p>###1.3åˆ†å¸ƒå¼å’Œé›†ç¾¤</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025150319539.png" alt="image-20231025150319539" tabindex="0" loading="lazy"><figcaption>image-20231025150319539</figcaption></figure><p>éƒ¨ç½²é¡¹ç›®çš„æ—¶å€™,ä½¿ç”¨å¤§äºä¸¤å°æœåŠ¡å™¨è¿›è¡Œéƒ¨ç½²:</p><p><strong>è´Ÿè½½å‡è¡¡:å¹³å‡è´Ÿæ‹…å‹åŠ›</strong></p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025150331327.png" alt="image-20231025150331327" tabindex="0" loading="lazy"><figcaption>image-20231025150331327</figcaption></figure><p>**é›†ç¾¤:**å¤šå°æœåŠ¡å™¨ä¸Šéƒ¨ç½²ç›¸åŒçš„é¡¹ç›®(å†…å®¹)åˆ†æ‹…æœåŠ¡å™¨è®¿é—®å‹åŠ›</p><hr><p>æ¯å°æœåŠ¡å™¨æ”¾çš„ä¸åŒå†…å®¹,ä¸åŒæ¨¡å—.</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025150343310.png" alt="image-20231025150343310" tabindex="0" loading="lazy"><figcaption>image-20231025150343310</figcaption></figure><p>**åˆ†å¸ƒå¼:**å¤šå°æœåŠ¡å™¨ä¸Šé¢éƒ¨ç½²ä¸åŒå†…å®¹æ¨¡å—</p><h2 id="_2-springcloudåˆä½“éªŒ" tabindex="-1"><a class="header-anchor" href="#_2-springcloudåˆä½“éªŒ" aria-hidden="true">#</a> 2.SpringCloudåˆä½“éªŒ</h2><h3 id="_2-1ä»€ä¹ˆæ˜¯springcloud" tabindex="-1"><a class="header-anchor" href="#_2-1ä»€ä¹ˆæ˜¯springcloud" aria-hidden="true">#</a> 2.1ä»€ä¹ˆæ˜¯SpringCloud</h3><ul><li>SpringCloudå¹¶ä¸æ˜¯ä¸€ç§æŠ€æœ¯,springcloudæ˜¯ä¸€ç³»åˆ—æ¡†æ¶æˆ–è€…ç»„ä»¶çš„é›†åˆ,springcloudé‡Œé¢åŒ…å«äº†å¾ˆå¤šç»„ä»¶å’Œæ¡†æ¶,ä½¿ç”¨è¿™äº›ç»„ä»¶å¯ä»¥å®ç°å¾®æœåŠ¡æ¶æ„.</li><li>SpringCloudæ˜¯ä¸€ç³»åˆ—æ¡†æ¶çš„æœ‰åºé›†åˆ.åœ¨SpringCloudè¿™ä¸ªé¡¹ç›®ä¸­åŒ…å«å¾ˆå¤šçš„ç»„ä»¶,å­æ¡†æ¶,æ¯ä¸€ä¸ªç»„ä»¶éƒ½æ˜¯ç”¨æ¥è§£å†³é—®é¢˜æ¶æ„ä¸­æ‰€é‡åˆ°çš„é—®é¢˜,å› æ­¤SpringCloudå¯ä»¥çœ‹åšæ˜¯ä¸€å¥—å¾®æœåŠ¡çš„è§£å†³æ–¹æ¡ˆ.</li><li>springcloudå®ç°å¾®æœåŠ¡æ¶æ„ç¦»ä¸å¼€SpringBoot</li></ul><h3 id="_2-2springcloudç»„æˆ" tabindex="-1"><a class="header-anchor" href="#_2-2springcloudç»„æˆ" aria-hidden="true">#</a> 2.2SpringCloudç»„æˆ</h3><ul><li>SpringCloudåŒ…å«å¾ˆå¤šç»„ä»¶</li><li>åŸç”Ÿç»„ä»¶:ç”±ç½‘é£å…¬å¸å¼€å‘,éšç€æ—¶é—´æ¨è¿Ÿ,å¤„äºç»´æŠ¤çŠ¶æ€,ä¸å†æ›´æ–°.</li><li>Spring Cloud alibabaç»„ä»¶:ç›®å‰æœ€æµè¡Œçš„ç»„ä»¶</li><li>Spring Cloud è…¾è®¯ç»„ä»¶:</li><li>SpringCloudç»„ä»¶è‡ªå·±ç ”å‘çš„ç»„ä»¶:GatWayç½‘å…³</li><li><strong>å¸¸ç”¨ç»„ä»¶</strong></li></ul><p>â­Nacos(æ³¨å†Œä¸­å¿ƒ,é…ç½®ä¸­å¿ƒ)</p><p>â­Openfeign(è¿œç¨‹è°ƒç”¨)</p><p>â­LoadBalancer(è´Ÿè½½å‡è¡¡)</p><p>â­Gateway(æœåŠ¡ç½‘å…³)</p><p>â­Sentinel(æœåŠ¡ä¿æŠ¤ç»„ä»¶)</p><h3 id="_2-3springcloudåˆä½“éªŒ" tabindex="-1"><a class="header-anchor" href="#_2-3springcloudåˆä½“éªŒ" aria-hidden="true">#</a> 2.3SpringCloudåˆä½“éªŒ</h3><h4 id="_2-3-1å·¥ç¨‹ç»“æ„è¯´æ˜" tabindex="-1"><a class="header-anchor" href="#_2-3-1å·¥ç¨‹ç»“æ„è¯´æ˜" aria-hidden="true">#</a> 2.3.1å·¥ç¨‹ç»“æ„è¯´æ˜</h4><p>åœ¨åˆ›å»ºå¾®æœåŠ¡å·¥ç¨‹çš„æ—¶å€™éƒ½éœ€è¦å…ˆæä¾›ä¸€ä¸ªå·¥ç¨‹,ä½¿ç”¨çˆ¶å·¥ç¨‹æ¥ç®¡ç†å¤šä¸ªå¾®æœåŠ¡æ‰€éœ€çš„ä¾èµ–,æˆ‘ä»¬çš„å¾®æœåŠ¡ç³»ç»Ÿç»“æ„å¦‚ä¸‹:</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025150259507.png" alt="image-20231025150259507" tabindex="0" loading="lazy"><figcaption>image-20231025150259507</figcaption></figure><h4 id="_2-3-2-çˆ¶å·¥ç¨‹æ­å»º" tabindex="-1"><a class="header-anchor" href="#_2-3-2-çˆ¶å·¥ç¨‹æ­å»º" aria-hidden="true">#</a> 2.3.2 çˆ¶å·¥ç¨‹æ­å»º</h4><p><strong>æ­¥éª¤</strong></p><ol><li>åˆ›å»ºä¸€ä¸ªmavençˆ¶å·¥ç¨‹</li><li>æ·»åŠ ä¾èµ–:</li></ol><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- å®šä¹‰å±æ€§ --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project.build.sourceEncoding</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project.build.sourceEncoding</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>spring-cloud.version</span><span class="token punctuation">&gt;</span></span>2022.0.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>spring-cloud.version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>spring-cloud-alibaba.version</span><span class="token punctuation">&gt;</span></span>2022.0.0.0-RC2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>spring-cloud-alibaba.version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mybatis-spring-boot.version</span><span class="token punctuation">&gt;</span></span>3.0.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mybatis-spring-boot.version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mysql.version</span><span class="token punctuation">&gt;</span></span>8.0.30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mysql.version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- æŒ‡å®šspring bootçˆ¶å·¥ç¨‹ --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.0.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencyManagement</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- åœ¨dependencyManagementæ ‡ç­¾ä¸­æ‰€å®šä¹‰çš„ä¾èµ–ä¸ä¼šè¢«å­å·¥ç¨‹ç›´æ¥è¿›è¡Œç»§æ‰¿ --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>

        <span class="token comment">&lt;!-- spring cloudçš„ä¾èµ– --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${spring-cloud.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

        <span class="token comment">&lt;!-- spring cloud alibabaçš„ä¾èµ– --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-alibaba-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${spring-cloud-alibaba.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

        <span class="token comment">&lt;!-- mysqlçš„é©±åŠ¨ --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${mysql.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

        <span class="token comment">&lt;!-- mybatiså’Œspring bootæ•´åˆçš„èµ·æ­¥ä¾èµ– --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis.spring.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${mybatis-spring-boot.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencyManagement</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>åˆ é™¤srcç›®å½•</li></ol><h4 id="_2-3-3å­å·¥ç¨‹æ­å»º" tabindex="-1"><a class="header-anchor" href="#_2-3-3å­å·¥ç¨‹æ­å»º" aria-hidden="true">#</a> 2.3.3å­å·¥ç¨‹æ­å»º</h4><ol><li>åˆ›å»ºå­æ¨¡å—</li><li>åœ¨å­æ¨¡å—ä¸­æ·»åŠ ä¾èµ–:</li></ol><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>17<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project.build.sourceEncoding</span><span class="token punctuation">&gt;</span></span>UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project.build.sourceEncoding</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- spring bootçš„webå¼€å‘æ‰€éœ€è¦çš„èµ·æ­¥ä¾èµ– --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- mysqlçš„é©±åŠ¨ --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- mybatiså’Œspring bootæ•´åˆçš„èµ·æ­¥ä¾èµ– --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis.spring.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    
    <span class="token comment">&lt;!-- lombokä¾èµ–ï¼Œå¿«é€Ÿç”Ÿæˆgetterå’Œsetteræ–¹æ³• --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>åœ¨resourseç›®å½•ä¸‹é¢åˆ›å»ºä¸€ä¸ªapplication.ymlæ–‡ä»¶,æ–‡ä»¶å¦‚ä¸‹:</li></ol><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># é…ç½®æœåŠ¡ç«¯å£å·</span>
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">10100</span>

<span class="token comment"># é…ç½®æ•°æ®åº“çš„è¿æ¥ä¿¡æ¯</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/spzx<span class="token punctuation">-</span>cloud<span class="token punctuation">-</span>user<span class="token punctuation">?</span>characterEncoding=UTF8
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> root

<span class="token comment"># é…ç½®mybatisçš„ç›¸å…³ä¿¡æ¯</span>
<span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
  <span class="token key atrule">configuration</span><span class="token punctuation">:</span>
    <span class="token key atrule">log-impl</span><span class="token punctuation">:</span> org.apache.ibatis.logging.stdout.StdOutImpl
  <span class="token key atrule">type-aliases-package</span><span class="token punctuation">:</span> com.atguigu.spzx.cloud.user.entity
  <span class="token key atrule">mapper-locations</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>/mapper/<span class="token important">*.xml</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>###2.4 SpringCloudè¿œç¨‹è°ƒç”¨</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025150254012.png" alt="image-20231025150254012" tabindex="0" loading="lazy"><figcaption>image-20231025150254012</figcaption></figure><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025150247970.png" alt="image-20231025150247970" tabindex="0" loading="lazy"><figcaption>image-20231025150247970</figcaption></figure><h4 id="_2-4-1ä¼ ç»Ÿè°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#_2-4-1ä¼ ç»Ÿè°ƒç”¨" aria-hidden="true">#</a> 2.4.1ä¼ ç»Ÿè°ƒç”¨</h4><p>å¦‚æœæƒ³å®Œæˆä¸Šé¢çš„éœ€æ±‚,æˆ‘ä»¬å°±éœ€è¦åœ¨Orderä¸ºæœåŠ¡ä¸­å‘Userå¾®æœåŠ¡å‘èµ·ä¸€ä¸ªhttpè¯·æ±‚,è°ƒç”¨<code>http://localhost:10100/api/user/findUserByuserId/{userId}</code>è¿™ä¸ªæ¥å£</p><ul><li>ç¬¬ä¸€æ­¥:åœ¨è°ƒç”¨ç«¯orderæ¨¡å—åˆ›å»ºé…ç½®ç±»,åˆ›å»ºRestTemplateå¯¹è±¡</li></ul><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025181951482.png" alt="image-20231025181951482" tabindex="0" loading="lazy"><figcaption>image-20231025181951482</figcaption></figure><ul><li><p>ç¬¬äºŒæ­¥:åœ¨è°ƒç”¨ç«¯orderæ¨¡å—åˆ›å»ºUserå®ä½“ç±»,æ¥æ”¶è¿”å›ä¸»å¥</p></li><li><p>ç¬¬ä¸‰æ­¥:åœ¨Orderå®ç°ç±»çš„æ–¹æ³•ä½¿ç”¨RestTemplateå‘èµ·è¿œç¨‹è°ƒç”¨(åœ¨Orderå¾®æœåŠ¡çš„Springå®¹å™¨ä¸­æ³¨å†Œä¸€ä¸ªRestTemplate)</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// com.atguigu.spzx.cloud.order.config;</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RestTemplateConfiguration</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RestTemplate</span> <span class="token function">restTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ç¬¬å››æ­¥:è·å–RestTemplateè¿œç¨‹è°ƒç”¨è¿”å›ç»“æœ,æ•°æ®å°è£…</p></li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderServiceImpl</span> implement <span class="token class-name">OrderService</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@AutoWired</span>
    <span class="token keyword">private</span> <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@AutoWired</span>
    <span class="token keyword">private</span> <span class="token class-name">OrderMapper</span> orderMapper<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Order</span> <span class="token function">findOrderByOrderId</span><span class="token punctuation">(</span><span class="token class-name">Long</span> <span class="token class-name">OrderId</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//æ ¹æ®IdæŸ¥è¯¢è®¢å•æ•°æ®</span>
        <span class="token class-name">Order</span> order <span class="token operator">=</span> orderMapper<span class="token punctuation">.</span><span class="token function">findOrderByOrderId</span><span class="token punctuation">(</span>orderId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å‘èµ·è¿œç¨‹è°ƒç”¨</span>
        <span class="token class-name">User</span> <span class="token class-name">User</span> <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:10100/api/user/findUserByUserId/1&quot;</span><span class="token operator">+</span>order<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        order<span class="token punctuation">.</span><span class="token function">serUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è¿”å›è®¢å•æ•°æ®</span>
        <span class="token keyword">return</span> order<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-4-2ä¼ ç»Ÿæ–¹å¼è°ƒç”¨çš„é—®é¢˜æ‰€åœ¨" tabindex="-1"><a class="header-anchor" href="#_2-4-2ä¼ ç»Ÿæ–¹å¼è°ƒç”¨çš„é—®é¢˜æ‰€åœ¨" aria-hidden="true">#</a> 2.4.2ä¼ ç»Ÿæ–¹å¼è°ƒç”¨çš„é—®é¢˜æ‰€åœ¨</h4><ol><li>ç»´æŠ¤æ€§å·®:æœåŠ¡æ–¹æä¾›IPåœ°å€å‘ç”Ÿæ”¹å˜,é‚£ä¹ˆæ­¤æ—¶æœåŠ¡æ¶ˆè´¹æ–¹å°±éœ€è¦ä¿®æ”¹ä»£ç </li><li>ç¼ºå°‘è´Ÿè½½å‡è¡¡æœºåˆ¶:è´Ÿè½½å‡è¡¡å°±æ˜¯è´Ÿè½½è¯·æ±‚é€šè¿‡å¤šå°æœåŠ¡å™¨è¿›è¡Œå¤„ç†</li></ol><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025150240929.png" alt="image-20231025150240929" tabindex="0" loading="lazy"><figcaption>image-20231025150240929</figcaption></figure><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025150235228.png" alt="image-20231025150235228" tabindex="0" loading="lazy"><figcaption>image-20231025150235228</figcaption></figure><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025183404072.png" alt="image-20231025183404072" tabindex="0" loading="lazy"><figcaption>image-20231025183404072</figcaption></figure><h4 id="_2-4-3å…¶ä»–é—®é¢˜é¡»çŸ¥" tabindex="-1"><a class="header-anchor" href="#_2-4-3å…¶ä»–é—®é¢˜é¡»çŸ¥" aria-hidden="true">#</a> 2.4.3å…¶ä»–é—®é¢˜é¡»çŸ¥</h4><ul><li>SpringBoot <ul><li>SpringCloudæ˜¯ä¸€ç³»åˆ—æ¡†æ¶é›†åˆ,ä½¿ç”¨è¿™äº›æ¡†æ¶(ç»„ä»¶)å®ç°å¾®æœåŠ¡</li><li>SpringCloudå®ç°å¾®æœåŠ¡æ¡†æ¶,å¿…é¡»ä½¿ç”¨SpringBoot</li></ul></li></ul><h2 id="_3-nacosæ³¨å†Œä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#_3-nacosæ³¨å†Œä¸­å¿ƒ" aria-hidden="true">#</a> 3.Nacosæ³¨å†Œä¸­å¿ƒ</h2><p>è§£å†³ä¼ ç»Ÿè¿œç¨‹è°ƒç”¨æ‰€å­˜åœ¨çš„é—®é¢˜,SpringCloud Alibaba æä¾›äº†nacosæ³¨å†Œä¸­å¿ƒ:</p><h3 id="_3-1-nacosæ³¨å†Œä¸­å¿ƒç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#_3-1-nacosæ³¨å†Œä¸­å¿ƒç®€ä»‹" aria-hidden="true">#</a> 3.1 Nacosæ³¨å†Œä¸­å¿ƒç®€ä»‹</h3><p>é€šè¿‡æ³¨å†Œä¸­å¿ƒå¯ä»¥å¯¹æœåŠ¡æä¾›æ–¹å’Œæ¶ˆè´¹æ–¹è§£è€¦åˆ.</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025150229500.png" alt="image-20231025150229500" tabindex="0" loading="lazy"><figcaption>image-20231025150229500</figcaption></figure><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025183451126.png" alt="image-20231025183451126" tabindex="0" loading="lazy"><figcaption>image-20231025183451126</figcaption></figure><p><strong>å·¥ä½œæµç¨‹</strong>:<br> æœåŠ¡æä¾›æ–¹åœ¨å¯åŠ¨çš„æ—¶å€™,ä¼šå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æœåŠ¡çš„è¯¦æƒ…ä¿¡æ¯(ip,ç«¯å£å·ç­‰).åœ¨æ³¨å†Œä¸­å¿ƒä¼šç»´æŠ¤ä¸€å¼ æœåŠ¡æ¸…å•,ä¿å­˜è¿™äº›æ³¨å†Œä¿¡æ¯,æ³¨å†Œä¸­å¿ƒéœ€è¦ä»¥å¿ƒè·³çš„æ–¹å¼å»æ£€æµ‹æ¸…å•ä¸­çš„æœåŠ¡æ˜¯å¦å¯ç”¨,å¦‚æœä¸å¯ç”¨,éœ€è¦åœ¨æœåŠ¡æ¸…å•ä¸­å‰”é™¤ä¸å¯ç”¨çš„æœåŠ¡.</p><p>æœåŠ¡æ¶ˆè´¹æ–¹å‘æœåŠ¡æ³¨å†Œä¸­å¿ƒå’¨è¯¢æœåŠ¡,å¹¶è·å–æ‰€æœ‰æœåŠ¡çš„å®ä¾‹æ¸…å•,ç„¶åæŒ‰ç…§æŒ‡å®šçš„è´Ÿè½½å‡è¡¡ç®—æ³•ä»æœåŠ¡æ¸…å•ä¸­é€‰æ‹©ä¸€ä¸ªæœåŠ¡å®ä¾‹è¿›è¡Œè®¿é—®.</p><h3 id="_3-2æ³¨å†Œä¸­å¿ƒäº§å“" tabindex="-1"><a class="header-anchor" href="#_3-2æ³¨å†Œä¸­å¿ƒäº§å“" aria-hidden="true">#</a> 3.2æ³¨å†Œä¸­å¿ƒäº§å“</h3><h3 id="eurela" tabindex="-1"><a class="header-anchor" href="#eurela" aria-hidden="true">#</a> Eurela</h3><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025150223666.png" alt="image-20231025150223666" tabindex="0" loading="lazy"><figcaption>image-20231025150223666</figcaption></figure><h3 id="nacos" tabindex="-1"><a class="header-anchor" href="#nacos" aria-hidden="true">#</a> nacos</h3><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025150218218.png" alt="image-20231025150218218" tabindex="0" loading="lazy"><figcaption>image-20231025150218218</figcaption></figure><p>dockerå®‰è£…nacos:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># æ‹‰å–é•œåƒ</span>
<span class="token function">docker</span> pull nacos/nacos-server:v2.2.2

<span class="token comment"># åˆ›å»ºå®¹å™¨</span>
<span class="token function">docker</span> run <span class="token parameter variable">--name</span> nacos <span class="token parameter variable">-e</span> <span class="token assign-left variable">MODE</span><span class="token operator">=</span>standalone <span class="token parameter variable">-p</span> <span class="token number">8848</span>:8848 <span class="token parameter variable">-p</span> <span class="token number">9848</span>:9848 <span class="token parameter variable">-d</span> nacos/nacos-server:v2.2.2

<span class="token comment"># nacos2.xçš„ç‰ˆæœ¬æ–°å¢äº†ä¸€ä¸ªå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„gRpcçš„é€šè®¯ç«¯å£å·9848</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰“å¼€æµè§ˆå™¨è®¿é—®nacosçš„æ‰€æä¾›çš„åç«¯ç®¡ç†ç•Œé¢ï¼š<a href="http://192.168.136.142:8848/nacos" target="_blank" rel="noopener noreferrer">http://192.168.136.142:8848/nacos<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>ç”¨æˆ·åå’Œå¯†ç ï¼šnacos/nacos</p><p>nacoså¯åŠ¨:</p><div class="language-cmd line-numbers-mode" data-ext="cmd"><pre class="language-cmd"><code>#cmdæ–¹å¼è¿›å…¥biné‡Œé¢,æ‰§è¡Œå‘½ä»¤:
startup.cmd -m standalone
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-3å¾®æœåŠ¡é›†æˆnacos" tabindex="-1"><a class="header-anchor" href="#_3-3å¾®æœåŠ¡é›†æˆnacos" aria-hidden="true">#</a> 3.3å¾®æœåŠ¡é›†æˆnacos</h3><h4 id="_3-3-1å‡†å¤‡å·¥ä½œ" tabindex="-1"><a class="header-anchor" href="#_3-3-1å‡†å¤‡å·¥ä½œ" aria-hidden="true">#</a> 3.3.1å‡†å¤‡å·¥ä½œ</h4><p>éœ€æ±‚ï¼šå°†ä¸¤ä¸ªå¾®æœåŠ¡(userã€order)æ³¨å†Œåˆ°nacosä¸­</p><p>å®ç°æ­¥éª¤ï¼š</p><p>1ã€åœ¨ä¸¤ä¸ªå­å·¥ç¨‹ä¸­å¼•å…¥å¦‚ä¸‹ä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- nacosä½œä¸ºæ³¨å†Œä¸­å¿ƒçš„ä¾èµ– --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2ã€åœ¨application.ymlæ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token comment"># é…ç½®nacosæ³¨å†Œä¸­å¿ƒçš„åœ°å€</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> spzx<span class="token punctuation">-</span>cloud<span class="token punctuation">-</span>user   <span class="token comment"># æ¯ä¸€ä¸ªæœåŠ¡æ³¨å†Œåˆ°nacosæ³¨å†Œä¸­å¿ƒéƒ½éœ€è¦æä¾›ä¸€ä¸ªæœåŠ¡åç§°,orderå¾®æœåŠ¡æ³¨å†Œçš„æ—¶å€™éœ€è¦æ›´æ”¹å¾®æœåŠ¡åç§°</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3ã€å¯åŠ¨ä¸¤ä¸ªå¾®æœåŠ¡ï¼šå°±å¯ä»¥åœ¨nacosçš„åå°ç®¡ç†ç³»ç»Ÿä¸­ï¼Œçœ‹åˆ°å¦‚ä¸‹çš„æ³¨å†Œä¿¡æ¯ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230809100204178.png" alt="image-20230809100204178" tabindex="0" loading="lazy"><figcaption>image-20230809100204178</figcaption></figure><h4 id="_3-3-2è¿œç¨‹è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#_3-3-2è¿œç¨‹è°ƒç”¨" aria-hidden="true">#</a> 3.3.2è¿œç¨‹è°ƒç”¨</h4><p>å½“æˆ‘ä»¬æŠŠå¾®æœåŠ¡éƒ½æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒä»¥åï¼Œé‚£ä¹ˆæ­¤æ—¶å°±å¯ä»¥æ ¹æ®æœåŠ¡çš„åç§°ä»æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡çš„ipåœ°å€å’Œç«¯å£å·äº†ï¼Œè¿›è€Œå°±å¯ä»¥æ›´æ”¹è¿œç¨‹è°ƒç”¨ä»£ç ï¼</p><h4 id="_3-3-2-1æ–¹æ¡ˆä¸€" tabindex="-1"><a class="header-anchor" href="#_3-3-2-1æ–¹æ¡ˆä¸€" aria-hidden="true">#</a> 3.3.2.1æ–¹æ¡ˆä¸€</h4><p>ä½¿ç”¨åˆ°Spring Cloudä¸­æ‰€æä¾›çš„ä¸€ä¸ªæœåŠ¡å‘ç°çš„å®¢æˆ·ç«¯å¯¹è±¡ï¼š<strong>DiscoveryClient</strong>ã€‚</p><p>ä»£ç å®ç°ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>          <span class="token comment">// æ³¨å…¥RestTemplateè¿œç¨‹è°ƒç”¨å·¥å…·</span>
    <span class="token keyword">private</span> <span class="token class-name">RestTemplate</span> restTemplate <span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">DiscoveryClient</span> discoveryClient <span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">OrderMapper</span> orderMapper <span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Order</span> <span class="token function">findOrderByOrderId</span><span class="token punctuation">(</span><span class="token class-name">Long</span> orderId<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// æ ¹æ®idæŸ¥è¯¢è®¢å•æ•°æ®</span>
        <span class="token class-name">Order</span> order <span class="token operator">=</span> orderMapper<span class="token punctuation">.</span><span class="token function">findOrderByOrderId</span><span class="token punctuation">(</span>orderId<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// æ ¹æ®æœåŠ¡åç§°ä»æ³¨å†Œä¸­å¿ƒä¸­è·å–æœåŠ¡å®ä¾‹åˆ—è¡¨</span>
        <span class="token class-name">ServiceInstance</span> serviceInstance <span class="token operator">=</span> <span class="token function">chooseServiceInstance</span><span class="token punctuation">(</span><span class="token string">&quot;spzx-cloud-user&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// å‘èµ·è¿œç¨‹è°ƒç”¨</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span><span class="token string">&quot;http://&quot;</span> <span class="token operator">+</span> serviceInstance<span class="token punctuation">.</span><span class="token function">getHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">&quot;:&quot;</span> <span class="token operator">+</span> serviceInstance<span class="token punctuation">.</span><span class="token function">getPort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">&quot;/api/user/findUserByUserId/&quot;</span> <span class="token operator">+</span> order<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        order<span class="token punctuation">.</span><span class="token function">setUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è¿”å›è®¢å•æ•°æ®</span>
        <span class="token keyword">return</span> order<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æ ¹æ®æœåŠ¡çš„åç§°ä»æ³¨å†Œä¸­å¿ƒä¸­è·å–æœåŠ¡åœ°å€ä¿¡æ¯</span>
    <span class="token keyword">public</span> <span class="token class-name">ServiceInstance</span> <span class="token function">chooseServiceInstance</span><span class="token punctuation">(</span><span class="token class-name">String</span> applicationName<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// è·å–æœåŠ¡å®ä¾‹åˆ—è¡¨</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ServiceInstance</span><span class="token punctuation">&gt;</span></span> instances <span class="token operator">=</span> discoveryClient<span class="token punctuation">.</span><span class="token function">getInstances</span><span class="token punctuation">(</span>applicationName<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// ç¼–å†™ä¸€ä¸ªç®€æ˜“çš„éšæœºè´Ÿè½½å‡è¡¡ç®—æ³•</span>
        <span class="token keyword">int</span> size <span class="token operator">=</span> instances<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Random</span> random <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
        <span class="token keyword">int</span> instanceIndex <span class="token operator">=</span> random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ServiceInstance</span> serviceInstance <span class="token operator">=</span> instances<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>instanceIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è¿”å›æœåŠ¡å®ä¾‹</span>
        <span class="token keyword">return</span> serviceInstance <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥å¯åŠ¨å¤šä¸ªuserå¾®æœåŠ¡å®ä¾‹è¿›è¡Œè´Ÿè½½å‡è¡¡çš„æµ‹è¯•ã€‚</p><h4 id="_3-3-2-2æ–¹æ¡ˆäºŒ" tabindex="-1"><a class="header-anchor" href="#_3-3-2-2æ–¹æ¡ˆäºŒ" aria-hidden="true">#</a> 3.3.2.2æ–¹æ¡ˆäºŒ</h4><p>ä½¿ç”¨Spring Cloudä¸­æ‰€æä¾›çš„ä¸€ä¸ªç»„ä»¶ï¼š<strong>spring-cloud-loadbalancer</strong>è´Ÿè½½å‡è¡¡</p><p>ä½¿ç”¨æ­¥éª¤ï¼š</p><p>1ã€åœ¨orderå¾®æœåŠ¡ä¸­æ·»åŠ ä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- spring cloud æ‰€æä¾›çš„è´Ÿè½½å‡è¡¡å™¨ --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-loadbalancer<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2ã€åœ¨å£°æ˜RestTemplateçš„æ–¹æ³•ä¸Šæ·»åŠ **@LoadBalanced**æ³¨è§£</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@LoadBalanced</span>       <span class="token comment">// è®©RestTemplateå…·æœ‰è´Ÿè½½å‡è¡¡çš„èƒ½åŠ›</span>
<span class="token keyword">public</span> <span class="token class-name">RestTemplate</span> <span class="token function">restTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3ã€æ›´æ”¹è¿œç¨‹è°ƒç”¨ä»£ç </p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// æœåŠ¡æä¾›æ–¹çš„æœåŠ¡ipåœ°å€å’Œç«¯å£å·å¯ä»¥ä½¿ç”¨æœåŠ¡æä¾›æ–¹çš„æœåŠ¡åç§°è¿›è¡Œæ›¿æ¢</span>
restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span><span class="token string">&quot;http://spzx-cloud-user/api/user/findUserByUserId/&quot;</span> <span class="token operator">+</span> order<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼šé»˜è®¤ä½¿ç”¨çš„è´Ÿè½½å‡è¡¡ç®—æ³•å°±æ˜¯è½®è¯¢ã€ä¾æ¬¡è°ƒç”¨å¯¹åº”æœåŠ¡ã€‘</p><h3 id="_3-4nacosé«˜çº§ç‰¹æ€§-æœåŠ¡é›†ç¾¤" tabindex="-1"><a class="header-anchor" href="#_3-4nacosé«˜çº§ç‰¹æ€§-æœåŠ¡é›†ç¾¤" aria-hidden="true">#</a> 3.4Nacosé«˜çº§ç‰¹æ€§:æœåŠ¡é›†ç¾¤</h3><h4 id="_3-4-1æœåŠ¡é›†ç¾¤" tabindex="-1"><a class="header-anchor" href="#_3-4-1æœåŠ¡é›†ç¾¤" aria-hidden="true">#</a> 3.4.1æœåŠ¡é›†ç¾¤</h4><h5 id="_3-4-1-1é›†ç¾¤æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#_3-4-1-1é›†ç¾¤æ¦‚è¿°" aria-hidden="true">#</a> 3.4.1.1é›†ç¾¤æ¦‚è¿°</h5><p>åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸ºäº†ä¿è¯æ¯ä¸€ä¸ªæœåŠ¡çš„é«˜å¯ç”¨ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±éœ€è¦å»æ„å»ºæœåŠ¡é›†ç¾¤ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯è¯´æŠŠæ‰€æœ‰çš„æœåŠ¡éƒ½éƒ¨ç½²åœ¨ä¸€ä¸ªæœºæˆ¿é‡Œã€‚è€Œæ˜¯å°†å¤šä¸ªæœåŠ¡åˆ†æ•£çš„éƒ¨ç½²åˆ°ä¸åŒçš„æœºæˆ¿ä¸­ï¼Œæ¯ä¸€ä¸ªæœºæˆ¿çš„æœåŠ¡å¯ä»¥çœ‹åšæˆæ˜¯ä¸€ä¸ªé›†ç¾¤ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025144212023.png" alt="image-20231025144212023" tabindex="0" loading="lazy"><figcaption>image-20231025144212023</figcaption></figure><p>å¾®æœåŠ¡äº’ç›¸è®¿é—®æ—¶ï¼Œåº”è¯¥å°½å¯èƒ½è®¿é—®åŒé›†ç¾¤å®ä¾‹ï¼Œå› ä¸ºæœ¬åœ°è®¿é—®é€Ÿåº¦æ›´å¿«ã€‚å½“æœ¬é›†ç¾¤å†…ä¸å¯ç”¨æ—¶ï¼Œæ‰è®¿é—®å…¶å®ƒé›†ç¾¤ã€‚ä¾‹å¦‚ï¼šä¸Šæµ·æœºæˆ¿å†…çš„orderå¾®æœåŠ¡åº”è¯¥ä¼˜å…ˆè®¿é—®åŒæœºæˆ¿çš„userå¾®æœåŠ¡ã€‚</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025184553633.png" alt="image-20231025184553633" tabindex="0" loading="lazy"><figcaption>image-20231025184553633</figcaption></figure><p>æ ¹æ®æœºæˆ¿è¿›è¡Œé…ç½®,æŒ‡å®šå½“å‰æœåŠ¡é»˜è®¤æ˜¯å“ªä¸ªæœºæˆ¿.ä¿è¯é›†ç¾¤çš„é«˜å¯ç”¨</p><p><strong>â“</strong> <strong>æ€ä¹ˆä¿è¯æœåŠ¡çš„é«˜å¯ç”¨</strong></p><p>ç¬¬ä¸€æ­¥:åœ¨Useræ¨¡å—é…ç½®æ–‡ä»¶æ·»åŠ é…ç½®,æŒ‡å®šè®¿é—®é›†ç¾¤æœºæˆ¿</p><p>ç¬¬äºŒæ­¥:åœ¨æœåŠ¡ç«¯Userè¿›è¡Œé…ç½®:é…ç½®æ‰€å±åŒºåŸŸ</p><p>ç¬¬ä¸‰æ­¥:åœ¨è°ƒç”¨ç«¯Orderè¿›è¡Œé…ç½®:é…ç½®Orderæ¨¡å—è¿œç¨‹è®¿é—®çš„é›†ç¾¤æ˜¯ä»€ä¹ˆ,é…ç½®è´Ÿè½½å‡è¡¡æ•ˆæœ</p><p>ç¬¬å››æ­¥:æµ‹è¯•:å¦‚æœé”™è¯¯,æ£€æŸ¥é…ç½®æ–‡ä»¶æ ¼å¼</p><p>è½®å¾ªç¯æ•ˆæœ:å…¶ä¸­ä¸€ä¸ªåœ°åŒºæœåŠ¡å™¨ä¸‹çº¿å°±ä¼šè®¿é—®å¦å¤–ä¸€ä¸ª,æ¢å¤,ä¼šé‡æ–°è¿›è¡Œè®¿é—®ç¬¬ä¸€ä¸ª.</p><p>âŒä¸Šçº¿ä¸‹çº¿ä¼šé‡æ–°è®¿é—®åŸæ¥çš„,å¦‚æœæ˜¯æœåŠ¡å™¨æŒ‚äº†,å°±ä¸ä¼šè®¿é—®ä¹‹å‰çš„äº†</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong>:æŠŠä¹‹å‰çš„ç¼“å­˜åˆ é™¤,é‡æ–°è¿›è¡Œå¯åŠ¨</p><h5 id="_3-4-1-2é›†ç¾¤é…ç½®" tabindex="-1"><a class="header-anchor" href="#_3-4-1-2é›†ç¾¤é…ç½®" aria-hidden="true">#</a> 3.4.1.2é›†ç¾¤é…ç½®</h5><ul><li>ä¿®æ”¹spzx-cloud-userçš„application.ymlæ–‡ä»¶ï¼Œæ·»åŠ é›†ç¾¤é…ç½®ï¼š</li></ul><div class="language-YAML line-numbers-mode" data-ext="YAML"><pre class="language-YAML"><code>spring:
  cloud:
    nacos:
      discovery:
        cluster-name: SH		# é…ç½®æœåŠ¡æ‰€å±é›†ç¾¤
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯åŠ¨ä¸‰ä¸ªæœåŠ¡userå¾®æœåŠ¡å®ä¾‹ï¼Œå®ä¾‹æ‰€å±é›†ç¾¤åˆ†é…æƒ…å†µï¼šå®ä¾‹1å±äºSHï¼Œå®ä¾‹2å’Œå®ä¾‹3å±äºBJ</p><ul><li>é€šè¿‡æ·»åŠ æ·»åŠ JVMå‚æ•°æ›´æ”¹æœåŠ¡å®ä¾‹æ‰€å±é›†ç¾¤ï¼Œå¯åŠ¨å®ä¾‹2å’Œå®ä¾‹3</li></ul><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230809102346561.png" alt="image-20230809102346561" tabindex="0" loading="lazy"><figcaption>image-20230809102346561</figcaption></figure><p>å®ä¾‹2ï¼š10101</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token parameter variable">-Dserver.port</span><span class="token operator">=</span><span class="token number">10101</span> -Dspring.cloud.nacos.discovery.cluster-name<span class="token operator">=</span>BJ
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å®ä¾‹3ï¼š10103</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token parameter variable">-Dserver.port</span><span class="token operator">=</span><span class="token number">10103</span> -Dspring.cloud.nacos.discovery.cluster-name<span class="token operator">=</span>BJ
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>å¯åŠ¨ä¸‰ä¸ªç”¨æˆ·å¾®æœåŠ¡å®ä¾‹ï¼ŒæŸ¥çœ‹å®ä¾‹åˆ†é…æƒ…å†µï¼š</li></ul><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230503183655565.png" alt="image-20230503183655565" tabindex="0" loading="lazy"><figcaption>image-20230503183655565</figcaption></figure><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230503183721175.png" alt="image-20230503183721175" tabindex="0" loading="lazy"><figcaption>image-20230503183721175</figcaption></figure><h5 id="_3-4-1-3é›†ç¾¤è®¿é—®" tabindex="-1"><a class="header-anchor" href="#_3-4-1-3é›†ç¾¤è®¿é—®" aria-hidden="true">#</a> 3.4.1.3é›†ç¾¤è®¿é—®</h5><p>éœ€æ±‚ï¼šå½“orderæœåŠ¡ä¼˜å…ˆè®¿é—®SHé›†ç¾¤ä¸­çš„userå¾®æœåŠ¡å®ä¾‹ï¼Œå½“SHé›†ç¾¤ä¸­çš„userå¾®æœåŠ¡å®ä¾‹å‡ºç°é—®é¢˜ä»¥åï¼Œåœ¨è®¿é—®BJé›†ç¾¤ä¸­çš„å®ä¾‹ã€‚</p><p>æ­¥éª¤ï¼š</p><p>1ã€ç»™orderå¾®æœåŠ¡çš„application.ymlæ–‡ä»¶ï¼Œæ·»åŠ é›†ç¾¤é…ç½®ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">cluster-name</span><span class="token punctuation">:</span> SH		<span class="token comment"># é…ç½®æœåŠ¡æ‰€å±é›†ç¾¤</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2ã€orderå¾®æœåŠ¡åœ¨loadbalancerç»„ä»¶ä¸­é›†æˆnacos</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token comment"># é…ç½®nacosæ³¨å†Œä¸­å¿ƒçš„åœ°å€</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">loadbalancer</span><span class="token punctuation">:</span>
      <span class="token key atrule">nacos</span><span class="token punctuation">:</span>    <span class="token comment"># é›†æˆnacosçš„è´Ÿè½½å‡è¡¡ç®—æ³•</span>
        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-5nacosé«˜çº§ç‰¹æ€§-æƒé‡é…ç½®-äº†è§£" tabindex="-1"><a class="header-anchor" href="#_3-5nacosé«˜çº§ç‰¹æ€§-æƒé‡é…ç½®-äº†è§£" aria-hidden="true">#</a> 3.5Nacosé«˜çº§ç‰¹æ€§:æƒé‡é…ç½®(äº†è§£)</h3><p>ä½¿ç”¨LoadBalance,é»˜è®¤æ•ˆæœæ˜¯è½®å¾ªæœºåˆ¶,,æˆ‘ä»¬å¯ä»¥è®¾ç½®æƒé‡,æƒé‡å€¼è¶Šé«˜,è¢«è®¿é—®çš„æ¦‚ç‡è¶Šå¤§.ä¸€èˆ¬æ¥è®²ä¿®æ”¹æƒé‡çš„æ¦‚ç‡ä¸å¤§,åœºæ™¯ä¸å¤š.äº†è§£.</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025144200255.png" alt="image-20231025144200255" tabindex="0" loading="lazy"><figcaption>image-20231025144200255</figcaption></figure><p>å®é™…éƒ¨ç½²ä¸­ä¼šå‡ºç°è¿™æ ·çš„åœºæ™¯ï¼šæœåŠ¡å™¨è®¾å¤‡æ€§èƒ½æœ‰å·®å¼‚ï¼Œéƒ¨åˆ†å®ä¾‹æ‰€åœ¨æœºå™¨æ€§èƒ½è¾ƒå¥½ï¼Œå¦ä¸€äº›è¾ƒå·®ï¼Œæˆ‘ä»¬å¸Œæœ›æ€§èƒ½å¥½çš„æœºå™¨æ‰¿æ‹…æ›´å¤šçš„ç”¨æˆ·è¯·æ±‚ã€‚</p><p>ä½†é»˜è®¤æƒ…å†µä¸‹Nacosçš„è´Ÿè½½å‡è¡¡ç®—æ³•æ˜¯åŒé›†ç¾¤å†…éšæœºæŒ‘é€‰ï¼Œä¸ä¼šè€ƒè™‘æœºå™¨çš„æ€§èƒ½é—®é¢˜ã€‚</p><p>å› æ­¤ï¼ŒNacosæä¾›äº†æƒé‡é…ç½®æ¥<strong>æ§åˆ¶è®¿é—®é¢‘ç‡</strong>ï¼Œæƒé‡è¶Šå¤§åˆ™è®¿é—®é¢‘ç‡è¶Šé«˜ã€‚</p><ul><li>åœ¨Nacosæ§åˆ¶å°ï¼Œæ‰¾åˆ°spzx-cloud-userçš„å®ä¾‹åˆ—è¡¨ï¼Œç‚¹å‡»ç¼–è¾‘ï¼Œå³å¯ä¿®æ”¹æƒé‡ï¼š</li></ul><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230503185416608.png" alt="image-20230503185416608" tabindex="0" loading="lazy"><figcaption>image-20230503185416608</figcaption></figure><p>æƒé‡å–å€¼èŒƒå›´ï¼š0~1</p><ul><li>åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œæƒé‡é…ç½®ï¼š</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">weight</span><span class="token punctuation">:</span> <span class="token number">0.1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ³¨æ„</strong>ï¼šå¦‚æœæƒé‡ä¿®æ”¹ä¸º0ï¼Œåˆ™è¯¥å®ä¾‹æ°¸è¿œä¸ä¼šè¢«è®¿é—®</p><h3 id="_3-6nacosé«˜çº§ç‰¹æ€§-ç¯å¢ƒéš”ç¦»" tabindex="-1"><a class="header-anchor" href="#_3-6nacosé«˜çº§ç‰¹æ€§-ç¯å¢ƒéš”ç¦»" aria-hidden="true">#</a> 3.6Nacosé«˜çº§ç‰¹æ€§:ç¯å¢ƒéš”ç¦»</h3><h4 id="_3-6-1ç¯å¢ƒéš”ç¦»æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#_3-6-1ç¯å¢ƒéš”ç¦»æ¦‚è¿°" aria-hidden="true">#</a> 3.6.1ç¯å¢ƒéš”ç¦»æ¦‚è¿°</h4><p>åœ¨å®é™…çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå­˜åœ¨å¾ˆå¤šä¸ªè½¯ä»¶ç¯å¢ƒï¼šå¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒã€ç”Ÿäº§ç¯å¢ƒã€‚</p><p>nacosä¹Ÿæ˜¯æ”¯æŒå¤šç¯å¢ƒéš”ç¦»é…ç½®çš„ï¼Œåœ¨nacosæ˜¯é€šè¿‡<strong>namespace</strong>æ¥å®ç°å¤šç¯å¢ƒçš„éš”ç¦»ã€‚</p><p>å®Œæ•´çš„æœåŠ¡æ³¨å†Œæ•°æ®å­˜å‚¨ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230503185847770.png" alt="image-20230503185847770" tabindex="0" loading="lazy"><figcaption>image-20230503185847770</figcaption></figure><p>namespace + group æ‰å¯ä»¥ç¡®å®šå…·ä½“çš„å¾®æœåŠ¡å®ä¾‹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰serviceã€groupéƒ½åœ¨åŒä¸€ä¸ªnamespaceï¼Œåä¸ºpublicã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230503190738675.png" alt="image-20230503190738675" tabindex="0" loading="lazy"><figcaption>image-20230503190738675</figcaption></figure><h4 id="_3-6-2åˆ›å»ºåç§°ç©ºé—´" tabindex="-1"><a class="header-anchor" href="#_3-6-2åˆ›å»ºåç§°ç©ºé—´" aria-hidden="true">#</a> 3.6.2åˆ›å»ºåç§°ç©ºé—´</h4><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»ºæ–°çš„åç§°ç©ºé—´ï¼Œæ¥å°†ä¸åŒçš„æœåŠ¡éš”ç¦»åˆ°ä¸åŒçš„ç¯å¢ƒä¸‹é¢ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230503191050511.png" alt="image-20230503191050511" tabindex="0" loading="lazy"><figcaption>image-20230503191050511</figcaption></figure><h4 id="_3-6-3å¾®æœåŠ¡é…ç½®åç§°ç©ºé—´" tabindex="-1"><a class="header-anchor" href="#_3-6-3å¾®æœåŠ¡é…ç½®åç§°ç©ºé—´" aria-hidden="true">#</a> 3.6.3å¾®æœåŠ¡é…ç½®åç§°ç©ºé—´</h4><p>ç»™å¾®æœåŠ¡æ·»åŠ åç§°ç©ºé—´çš„é…ç½®ï¼Œæ¥æŒ‡å®šè¯¥å¾®æœåŠ¡æ‰€å±ç¯å¢ƒã€‚</p><p>ä¾‹å¦‚ï¼Œä¿®æ”¹spzx-cloud-orderçš„application.ymlæ–‡ä»¶ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token comment"># é…ç½®nacosæ³¨å†Œä¸­å¿ƒçš„åœ°å€</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">namespace</span><span class="token punctuation">:</span> 4a88035e<span class="token punctuation">-</span>acf3<span class="token punctuation">-</span>45a9<span class="token punctuation">-</span>924f<span class="token punctuation">-</span>2421acbff67a  <span class="token comment"># é…ç½®æœåŠ¡å®ä¾‹æ‰€å±åç§°ç©ºé—´</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤æ—¶orderå¾®æœåŠ¡æ‰€å¯¹åº”çš„æœåŠ¡å®ä¾‹å°±å±äºæ–°çš„åç§°ç©ºé—´ï¼Œuserå¾®æœåŠ¡æ‰€å¯¹åº”çš„æœåŠ¡å®ä¾‹å±äºpublicçš„åç§°ç©ºé—´ï¼Œé‚£ä¹ˆæ­¤æ—¶åœ¨è¿›è¡Œè¿œç¨‹è°ƒç”¨çš„æ—¶å€™ï¼Œå°±ä¼šå‡ºç°å¦‚ä¸‹çš„é”™è¯¯ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230503191655562.png" alt="image-20230503191655562" tabindex="0" loading="lazy"><figcaption>image-20230503191655562</figcaption></figure><h3 id="_3-7nacosé«˜çº§ç‰¹æ€§-å®ä¾‹ç±»å‹" tabindex="-1"><a class="header-anchor" href="#_3-7nacosé«˜çº§ç‰¹æ€§-å®ä¾‹ç±»å‹" aria-hidden="true">#</a> 3.7Nacosé«˜çº§ç‰¹æ€§:å®ä¾‹ç±»å‹</h3><p>Nacosä¸­çš„æœåŠ¡å®ä¾‹å­˜åœ¨ä¸¤ç§ç±»å‹ï¼š</p><p>1ã€ä¸´æ—¶å®ä¾‹ï¼šå¦‚æœå®ä¾‹å®•æœºè¶…è¿‡ä¸€å®šæ—¶é—´ï¼Œä¼šä»æœåŠ¡åˆ—è¡¨å‰”é™¤ï¼Œå¹¶ä¸”å®ä¾‹ä¼šå®šæ—¶ä¸ŠæŠ¥è‡ªèº«çš„å¥åº·çŠ¶æ€ç»™Nacosæ³¨å†Œä¸­å¿ƒï¼Œé»˜è®¤çš„ç±»å‹ã€‚</p><p>2ã€éä¸´æ—¶å®ä¾‹ï¼šå¦‚æœå®ä¾‹å®•æœºï¼Œä¸ä¼šä»æœåŠ¡åˆ—è¡¨å‰”é™¤ï¼ŒNacosæ³¨å†Œä¸­å¿ƒä¼šä¸»åŠ¨è¯¢é—®å®ä¾‹çš„å¥åº·çŠ¶æ€ï¼Œä¹Ÿå¯ä»¥å«æ°¸ä¹…å®ä¾‹ã€‚</p><p>é…ç½®ä¸€ä¸ªæœåŠ¡å®ä¾‹ä¸ºæ°¸ä¹…å®ä¾‹ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">ephemeral</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>  <span class="token comment"># é…ç½®è¯¥å®ä¾‹ä¸ºéä¸´æ—¶å®ä¾‹</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-loadbalancer" tabindex="-1"><a class="header-anchor" href="#_4-loadbalancer" aria-hidden="true">#</a> 4.LoadBalancer</h2><h3 id="_4-1ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#_4-1ç®€ä»‹" aria-hidden="true">#</a> 4.1ç®€ä»‹</h3><p>Spring Cloud LoadBalanceræ˜¯Spring Cloudä¸­è´Ÿè´£å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„æ¨¡å—ï¼Œå…¶ä¸»è¦åŸç†æ˜¯é€šè¿‡é€‰æ‹©åˆé€‚çš„æœåŠ¡å®ä¾‹æ¥å®ç°è´Ÿè½½å‡è¡¡ã€‚</p><p>å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ï¼šå°±æ˜¯è´Ÿè½½å‡è¡¡ç®—æ³•ç”±å®¢æˆ·ç«¯æä¾›</p><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230503213502251.png" alt="image-20230503213502251" tabindex="0" loading="lazy"><figcaption>image-20230503213502251</figcaption></figure><h3 id="_4-2-loadbalancerçš„æ‰§è¡Œæµç¨‹" tabindex="-1"><a class="header-anchor" href="#_4-2-loadbalancerçš„æ‰§è¡Œæµç¨‹" aria-hidden="true">#</a> 4.2 LoadBalancerçš„æ‰§è¡Œæµç¨‹</h3><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025190315177.png" alt="image-20231025190315177" tabindex="0" loading="lazy"><figcaption>image-20231025190315177</figcaption></figure><ol><li>é€šè¿‡LoadBalancerInterceptorè¯·æ±‚æ‹¦æˆªå™¨æ‹¦æˆªæˆ‘ä»¬çš„RestTemplateè¯·æ±‚:</li><li>è·å–è¯·æ±‚URL,ç„¶åä»è¯·æ±‚ä¸­è·å–æä¾›æ–¹çš„ä¸»æœºåç§°</li><li>ç„¶åè°ƒç”¨LoadBalancerClientä¸­executeæ–¹æ³•,å°†æœåŠ¡æä¾›æ–¹çš„åç§°ä¼ é€’è¿‡å»</li><li>åœ¨LoadBalancerClientçš„chooseæ–¹æ³•é€šè¿‡ReactiveLoadBalancer.Factoryä»Nacosæ³¨å†Œä¸­å¿ƒè·å–åˆ—è¡¨ä»¥åŠè´Ÿè½½å‡è¡¡ç®—æ³•å®ä¾‹å¯¹è±¡</li><li>é€šè¿‡ReactieloadBalancerä»æœåŠ¡åˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªæœåŠ¡å®ä¾‹åœ°å€,ç„¶åå‘èµ·è¿œç¨‹è°ƒç”¨</li></ol><h3 id="_4-3æºç è·Ÿè¸ª" tabindex="-1"><a class="header-anchor" href="#_4-3æºç è·Ÿè¸ª" aria-hidden="true">#</a> 4.3æºç è·Ÿè¸ª</h3><blockquote><p>LoadBalancerInterceptor</p></blockquote><p>æ ¸å¿ƒæºç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230503223822056.png" alt="image-20230503223822056" tabindex="0" loading="lazy"><figcaption>image-20230503223822056</figcaption></figure><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„interceptæ–¹æ³•ï¼Œæ‹¦æˆªäº†ç”¨æˆ·çš„HttpRequestè¯·æ±‚ï¼Œç„¶ååšäº†å‡ ä»¶äº‹ï¼š</p><p>1ã€<code>request.getURI()</code>ï¼šè·å–è¯·æ±‚uriï¼Œæœ¬ä¾‹ä¸­å°±æ˜¯ <a href="http://spzx-cloud-user/api/user/findUserByUserId/1" target="_blank" rel="noopener noreferrer">http://spzx-cloud-user/api/user/findUserByUserId/1<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>2ã€<code>originalUri.getHost()</code>ï¼šè·å–uriè·¯å¾„çš„ä¸»æœºåï¼Œå…¶å®å°±æ˜¯æœåŠ¡idï¼Œ<code>spzx-cloud-user</code></p><p>3ã€<code>this.loadBalancer.execute()</code>ï¼šå¤„ç†æœåŠ¡idï¼Œå’Œç”¨æˆ·è¯·æ±‚ã€‚</p><p>è¿™é‡Œçš„<code>this.loadBalancer</code>æ˜¯<code>BlockingLoadBalancerClient</code>ç±»å‹ï¼Œæˆ‘ä»¬ç»§ç»­è·Ÿå…¥ã€‚</p><blockquote><p>BlockingLoadBalancerClient</p></blockquote><p>æ ¸å¿ƒæºç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230503224702411.png" alt="image-20230503224702411" tabindex="0" loading="lazy"><figcaption>image-20230503224702411</figcaption></figure><p>ReactiveLoadBalancer.Factoryçš„getInstanceæ–¹æ³•åšäº†ä¸¤ä»¶äº‹æƒ…ï¼š</p><p>1ã€è·å–äº†ä¸€ä¸ªå…·ä½“çš„è´Ÿè½½å‡è¡¡ç®—æ³•å¯¹è±¡</p><p>2ã€æ ¹æ®æœåŠ¡çš„idä»Nacosæ³¨å†Œä¸­å¿ƒä¸­è·å–æœåŠ¡åœ°å€åˆ—è¡¨</p><p>ç´§è·Ÿç€è°ƒç”¨äº†RoundRobinLoadBalancer#chooseæ–¹æ³•ï¼Œä»æœåŠ¡åˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªæœåŠ¡å®ä¾‹å¯¹è±¡ã€‚</p><p>é»˜è®¤çš„è´Ÿè½½å‡è¡¡ç®—æ³•ï¼šRoundRobinLoadBalancer</p><h3 id="_4-4è¡¥å……çŸ¥è¯†-è´Ÿè½½å‡è¡¡ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#_4-4è¡¥å……çŸ¥è¯†-è´Ÿè½½å‡è¡¡ç®—æ³•" aria-hidden="true">#</a> 4.4è¡¥å……çŸ¥è¯†:è´Ÿè½½å‡è¡¡ç®—æ³•:</h3><p>æŒ‰ç…§ç‰¹å®šçš„æ–¹å¼å®ç°ç‰¹å®šåŠŸèƒ½å°±æ˜¯ç®—æ³•:</p><p>è½®å¾ªç®—æ³•:</p><p>æ•°å­¦çŸ¥è¯†:</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025145227696.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231025145331201.png" alt="è½®å¾ªç®—æ³•æ•°å­¦åŸç†" tabindex="0" loading="lazy"><figcaption>è½®å¾ªç®—æ³•æ•°å­¦åŸç†</figcaption></figure><p>è¯·æ±‚æ¬¡æ•°%æœåŠ¡å™¨æ•°é‡=</p><h3 id="_4-5æ›´æ”¹è´Ÿè½½å‡è¡¡ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#_4-5æ›´æ”¹è´Ÿè½½å‡è¡¡ç®—æ³•" aria-hidden="true">#</a> 4.5æ›´æ”¹è´Ÿè½½å‡è¡¡ç®—æ³•</h3><p>LoadBalanceré»˜è®¤çš„è´Ÿè½½å‡è¡¡ç®—æ³•æ˜¯RoundRobinLoadBalancerï¼Œå¦‚æœæƒ³æ›´æ”¹é»˜è®¤çš„è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé‚£ä¹ˆæ­¤æ—¶éœ€è¦å‘Springå®¹å™¨ä¸­æ³¨å†Œä¸€ä¸ªBeanï¼Œå¹¶ä¸”é…ç½®è´Ÿè½½å‡è¡¡çš„ä½¿ç”¨è€…ã€‚</p><p>ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>1ã€åœ¨Springå®¹å™¨ä¸­æ³¨å†Œä¸€ä¸ªBean</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomLoadBalancerConfiguration</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * <span class="token keyword">@param</span> <span class="token parameter">environment</span>: ç”¨äºè·å–ç¯å¢ƒå±æ€§é…ç½®ï¼Œå…¶ä¸­LoadBalancerClientFactory.PROPERTY_NAMEè¡¨ç¤ºè¯¥è´Ÿè½½å‡è¡¡å™¨è¦åº”ç”¨çš„æœåŠ¡åç§°ã€‚
     * <span class="token keyword">@param</span> <span class="token parameter">loadBalancerClientFactory</span>: æ˜¯Spring Cloudä¸­ç”¨äºåˆ›å»ºè´Ÿè½½å‡è¡¡å™¨çš„å·¥å‚ç±»ï¼Œé€šè¿‡getLazyProvideræ–¹æ³•è·å–ServiceInstanceListSupplierå¯¹è±¡ï¼Œä»¥æä¾›å¯ç”¨çš„æœåŠ¡åˆ—è¡¨ã€‚
     * ServiceInstanceListSupplierï¼šç”¨äºæä¾›ServiceInstanceåˆ—è¡¨çš„æ¥å£ï¼Œå¯ä»¥ä»DiscoveryClientæˆ–è€…å…¶ä»–æ³¨å†Œä¸­å¿ƒä¸­è·å–å¯ç”¨çš„æœåŠ¡å®ä¾‹åˆ—è¡¨ã€‚
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token class-name">ReactorLoadBalancer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ServiceInstance</span><span class="token punctuation">&gt;</span></span> <span class="token function">randomLoadBalancer</span><span class="token punctuation">(</span><span class="token class-name">Environment</span> environment<span class="token punctuation">,</span> <span class="token class-name">LoadBalancerClientFactory</span> loadBalancerClientFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> name <span class="token operator">=</span> environment<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token class-name">LoadBalancerClientFactory</span><span class="token punctuation">.</span><span class="token constant">PROPERTY_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RandomLoadBalancer</span><span class="token punctuation">(</span>loadBalancerClientFactory<span class="token punctuation">.</span><span class="token function">getLazyProvider</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token class-name">ServiceInstanceListSupplier</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2ã€é…ç½®è´Ÿè½½å‡è¡¡ç®—æ³•çš„ä½¿ç”¨è€…</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@LoadBalancerClients</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@LoadBalancerClient</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;spzx-cloud-user&quot;</span> <span class="token punctuation">,</span> configuration <span class="token operator">=</span> <span class="token class-name">CustomLoadBalancerConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>      <span class="token comment">// å°†è´Ÿè½½å‡è¡¡ç®—æ³•åº”ç”¨åˆ°æŒ‡å®šçš„æœåŠ¡æä¾›æ–¹ä¸­</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RestTemplateConfiguration</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@LoadBalanced</span>       <span class="token comment">// è®©RestTemplateå…·æœ‰è´Ÿè½½å‡è¡¡çš„èƒ½åŠ›</span>
    <span class="token keyword">public</span> <span class="token class-name">RestTemplate</span> <span class="token function">restTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-openfeignç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#_5-openfeignç»„ä»¶" aria-hidden="true">#</a> 5.OpenFeignç»„ä»¶</h2><h3 id="_5-1openfeignç»„ä»¶ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#_5-1openfeignç»„ä»¶ä»‹ç»" aria-hidden="true">#</a> 5.1OpenFeignç»„ä»¶ä»‹ç»</h3><p>åŸºäºNacoså’ŒOpenFeignç»„ä»¶ä¸€èµ·ä½¿ç”¨,å®ç°è¿œç¨‹è°ƒç”¨è¿‡ç¨‹</p><p>æ¦‚è¿°ï¼šfeignæ˜¯ä¸€ä¸ªå£°æ˜å¼çš„httpå®¢æˆ·ç«¯ï¼Œå®˜æ–¹åœ°å€ï¼š<a href="https://github.com/OpenFeign/feign%E5%85%B6%E4%BD%9C%E7%94%A8%E5%B0%B1%E6%98%AF%E5%B8%AE%E5%8A%A9%E6%88%91%E4%BB%AC%E4%BC%98%E9%9B%85%E7%9A%84%E5%AE%9E%E7%8E%B0http%E8%AF%B7%E6%B1%82%E7%9A%84%E5%8F%91%E9%80%81%E3%80%82" target="_blank" rel="noopener noreferrer">https://github.com/OpenFeign/feignå…¶ä½œç”¨å°±æ˜¯å¸®åŠ©æˆ‘ä»¬ä¼˜é›…çš„å®ç°httpè¯·æ±‚çš„å‘é€ã€‚<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624093622996.png" alt="image-20230624093622996" tabindex="0" loading="lazy"><figcaption>image-20230624093622996</figcaption></figure><p>ä½¿ç”¨RestTemplateè¿›è¡Œè¿œç¨‹è°ƒç”¨ä»£ç å›é¡¾ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624093650991.png" alt="image-20230624093650991" tabindex="0" loading="lazy"><figcaption>image-20230624093650991</figcaption></figure><p>å­˜åœ¨çš„å¼Šç«¯ï¼šå‚æ•°ä¼ é€’ä¸å¤ªæ–¹ä¾¿</p><h3 id="_5-2openfeignåˆä½“éªŒ" tabindex="-1"><a class="header-anchor" href="#_5-2openfeignåˆä½“éªŒ" aria-hidden="true">#</a> 5.2OpenFeignåˆä½“éªŒ</h3><p>OpenFeignçš„ä½¿ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š</p><p>1ã€æˆ‘ä»¬åœ¨spzx-cloud-orderæœåŠ¡çš„pomæ–‡ä»¶ä¸­å¼•å…¥OpenFeignçš„ä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- åŠ å…¥OpenFeignçš„ä¾èµ– --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-openfeign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2ã€åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ **@EnableFeignClients**å¼€å¯OpenFeignçš„åŠŸèƒ½æ”¯æŒ</p><p>3ã€ç¼–å†™OpenFeignçš„å®¢æˆ·ç«¯</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;spzx-cloud-user&quot;</span><span class="token punctuation">)</span>		<span class="token comment">// å£°æ˜å½“å‰æ¥å£æ˜¯ä¸€ä¸ªè®¿é—®user-serviceçš„feignçš„å®¢æˆ·ç«¯</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserFeignClient</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/api/user/findUserByUserId/{userId}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">User</span> <span class="token function">queryById</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;userId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId<span class="token punctuation">)</span> <span class="token punctuation">;</span>	<span class="token comment">// æ ¹æ®userIdæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯çš„æ¥å£æ–¹æ³•</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªå®¢æˆ·ç«¯ä¸»è¦æ˜¯åŸºäºSpringMVCçš„æ³¨è§£æ¥å£°æ˜è¿œç¨‹è°ƒç”¨çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š</p><p>â‘  è¯·æ±‚æ–¹å¼ï¼šGET</p><p userId="">â‘¡ è¯·æ±‚è·¯å¾„ï¼š/api/user/findUserByUserId/</p><p>â‘¢ è¯·æ±‚å‚æ•°ï¼šLong userId</p><p>â‘£ è¿”å›å€¼ç±»å‹ï¼šUser</p><p>è¿™æ ·ï¼ŒFeignå°±å¯ä»¥å¸®åŠ©æˆ‘ä»¬å‘é€httpè¯·æ±‚ï¼Œæ— éœ€è‡ªå·±ä½¿ç”¨RestTemplateæ¥å‘é€äº†ã€‚</p><p>4ã€ä¿®æ”¹OrderServiceä¸­çš„è¿œç¨‹è°ƒç”¨ä»£ç ï¼Œä½¿ç”¨Feignå®¢æˆ·ç«¯ä»£æ›¿RestTemplateï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">OrderMapper</span> orderMapper <span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserFeignClient</span> userFeignClient <span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Order</span> <span class="token function">findOrderByOrderId</span><span class="token punctuation">(</span><span class="token class-name">Long</span> orderId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Order</span> order <span class="token operator">=</span> orderMapper<span class="token punctuation">.</span><span class="token function">findOrderByOrderId</span><span class="token punctuation">(</span>orderId<span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// è¿œç¨‹è°ƒç”¨</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> userFeignClient<span class="token punctuation">.</span><span class="token function">queryById</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        order<span class="token punctuation">.</span><span class="token function">setUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> order <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-3openfeignè‡ªå®šä¹‰é…ç½®" tabindex="-1"><a class="header-anchor" href="#_5-3openfeignè‡ªå®šä¹‰é…ç½®" aria-hidden="true">#</a> 5.3OpenFeignè‡ªå®šä¹‰é…ç½®</h3><h4 id="_5-3-1-æ—¥å¿—é…ç½®" tabindex="-1"><a class="header-anchor" href="#_5-3-1-æ—¥å¿—é…ç½®" aria-hidden="true">#</a> 5.3.1 æ—¥å¿—é…ç½®</h4><p>OpenFeignå¯ä»¥æ”¯æŒå¾ˆå¤šçš„è‡ªå®šä¹‰é…ç½®ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><table><thead><tr><th>ç±»å‹</th><th>ä½œç”¨</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><strong>feign.Logger.Level</strong></td><td>ä¿®æ”¹æ—¥å¿—çº§åˆ«</td><td>åŒ…å«å››ç§ä¸åŒçš„çº§åˆ«ï¼šNONEã€BASICã€HEADERSã€FULL</td></tr><tr><td>feign.codec.Decoder</td><td>å“åº”ç»“æœçš„è§£æå™¨</td><td>httpè¿œç¨‹è°ƒç”¨çš„ç»“æœåšè§£æï¼Œä¾‹å¦‚è§£æjsonå­—ç¬¦ä¸²ä¸ºjavaå¯¹è±¡</td></tr><tr><td>feign.codec.Encoder</td><td>è¯·æ±‚å‚æ•°ç¼–ç </td><td>å°†è¯·æ±‚å‚æ•°ç¼–ç ï¼Œä¾¿äºé€šè¿‡httpè¯·æ±‚å‘é€</td></tr><tr><td>feign.Contract</td><td>æ”¯æŒçš„æ³¨è§£æ ¼å¼</td><td>é»˜è®¤æ˜¯SpringMVCçš„æ³¨è§£</td></tr><tr><td>feign.Retryer</td><td>å¤±è´¥é‡è¯•æœºåˆ¶</td><td>è¯·æ±‚å¤±è´¥çš„é‡è¯•æœºåˆ¶ï¼Œé»˜è®¤æ˜¯æ²¡æœ‰ï¼Œä¸è¿‡ä¼šä½¿ç”¨Ribbonçš„é‡è¯•</td></tr></tbody></table><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œé»˜è®¤å€¼å°±èƒ½æ»¡è¶³æˆ‘ä»¬ä½¿ç”¨ï¼Œå¦‚æœè¦è‡ªå®šä¹‰æ—¶ï¼Œåªéœ€è¦åˆ›å»ºè‡ªå®šä¹‰çš„@Beanè¦†ç›–é»˜è®¤Beanå³å¯ã€‚</p><p>ä¸‹é¢ä»¥æ—¥å¿—ä¸ºä¾‹æ¥æ¼”ç¤ºå¦‚ä½•è‡ªå®šä¹‰é…ç½®ï¼Œæ”¯æŒä¸¤ç§æ–¹å¼çš„é…ç½®ï¼š</p><blockquote><h5 id="åŸºäºé…ç½®æ–‡ä»¶çš„æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#åŸºäºé…ç½®æ–‡ä»¶çš„æ–¹å¼" aria-hidden="true">#</a> åŸºäºé…ç½®æ–‡ä»¶çš„æ–¹å¼</h5></blockquote><p>åŸºäºé…ç½®æ–‡ä»¶ä¿®æ”¹feignçš„æ—¥å¿—çº§åˆ«å¯ä»¥é’ˆå¯¹å•ä¸ªæœåŠ¡ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># å°†feignåŒ…ä¸‹äº§ç”Ÿçš„æ—¥å¿—çš„çº§åˆ«è®¾ç½®ä¸ºdebug</span>
<span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token key atrule">com.atguigu.spzx.cloud.order.feign</span><span class="token punctuation">:</span> debug
    
<span class="token comment"># openfeignæ—¥å¿—çº§åˆ«é…ç½®</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">openfeign</span><span class="token punctuation">:</span>
      <span class="token key atrule">client</span><span class="token punctuation">:</span>
        <span class="token key atrule">config</span><span class="token punctuation">:</span> 
          <span class="token key atrule">spzx-cloud-user</span><span class="token punctuation">:</span>  
            <span class="token key atrule">loggerLevel</span><span class="token punctuation">:</span> full
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¹Ÿå¯ä»¥é’ˆå¯¹æ‰€æœ‰æœåŠ¡ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># å°†feignåŒ…ä¸‹äº§ç”Ÿçš„æ—¥å¿—çš„çº§åˆ«è®¾ç½®ä¸ºdebug</span>
<span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token key atrule">com.atguigu.spzx.cloud.order.feign</span><span class="token punctuation">:</span> debug
    
<span class="token comment"># openfeignæ—¥å¿—çº§åˆ«é…ç½®</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">openfeign</span><span class="token punctuation">:</span>
      <span class="token key atrule">client</span><span class="token punctuation">:</span>
        <span class="token key atrule">config</span><span class="token punctuation">:</span> 
          <span class="token key atrule">default</span><span class="token punctuation">:</span>  <span class="token comment"># è¿™é‡Œç”¨defaultå°±æ˜¯å…¨å±€é…ç½®ï¼Œå¦‚æœæ˜¯å†™æœåŠ¡åç§°ï¼Œåˆ™æ˜¯é’ˆå¯¹æŸä¸ªå¾®æœåŠ¡çš„é…ç½®</span>
            <span class="token key atrule">loggerLevel</span><span class="token punctuation">:</span> full
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è€Œæ—¥å¿—çš„çº§åˆ«åˆ†ä¸ºå››ç§ï¼š</p><p>â‘  NONEï¼šä¸è®°å½•ä»»ä½•æ—¥å¿—ä¿¡æ¯ï¼Œè¿™æ˜¯é»˜è®¤å€¼ã€‚</p><p>â‘¡ BASICï¼šä»…è®°å½•è¯·æ±‚çš„æ–¹æ³•ï¼ŒURLä»¥åŠå“åº”çŠ¶æ€ç å’Œæ‰§è¡Œæ—¶é—´</p><p>â‘¢ HEADERSï¼šåœ¨BASICçš„åŸºç¡€ä¸Šï¼Œé¢å¤–è®°å½•äº†è¯·æ±‚å’Œå“åº”çš„å¤´ä¿¡æ¯</p><p>â‘£ FULLï¼šè®°å½•æ‰€æœ‰è¯·æ±‚å’Œå“åº”çš„æ˜ç»†ï¼ŒåŒ…æ‹¬å¤´ä¿¡æ¯ã€è¯·æ±‚ä½“ã€å…ƒæ•°æ®ã€‚</p><blockquote><h5 id="javaä»£ç çš„æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#javaä»£ç çš„æ–¹å¼" aria-hidden="true">#</a> Javaä»£ç çš„æ–¹å¼</h5></blockquote><p>ä¹Ÿå¯ä»¥åŸºäºJavaä»£ç æ¥ä¿®æ”¹æ—¥å¿—çº§åˆ«ï¼Œå…ˆå£°æ˜ä¸€ä¸ªç±»ï¼Œç„¶åå£°æ˜ä¸€ä¸ªLogger.Levelçš„å¯¹è±¡ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DefaultFeignConfiguration</span>  <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">Logger<span class="token punctuation">.</span>Level</span> <span class="token function">feignLogLevel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Logger<span class="token punctuation">.</span>Level</span><span class="token punctuation">.</span><span class="token constant">BASIC</span><span class="token punctuation">;</span> <span class="token comment">// æ—¥å¿—çº§åˆ«ä¸ºBASIC</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœè¦<strong>å…¨å±€ç”Ÿæ•ˆ</strong>ï¼Œå°†å…¶æ”¾åˆ°å¯åŠ¨ç±»çš„@EnableFeignClientsè¿™ä¸ªæ³¨è§£ä¸­ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@EnableFeignClients</span><span class="token punctuation">(</span>defaultConfiguration <span class="token operator">=</span> <span class="token class-name">DefaultFeignConfiguration</span> <span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¦‚æœæ˜¯<strong>å±€éƒ¨ç”Ÿæ•ˆ</strong>ï¼Œåˆ™æŠŠå®ƒæ”¾åˆ°å¯¹åº”çš„@FeignClientè¿™ä¸ªæ³¨è§£ä¸­ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;spzx-cloud-user&quot;</span><span class="token punctuation">,</span> configuration <span class="token operator">=</span> <span class="token class-name">DefaultFeignConfiguration</span> <span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_5-3-2-è¶…æ—¶é…ç½®" tabindex="-1"><a class="header-anchor" href="#_5-3-2-è¶…æ—¶é…ç½®" aria-hidden="true">#</a> 5.3.2 è¶…æ—¶é…ç½®</h4><p><strong>è¶…æ—¶æœºåˆ¶æ¦‚è¿°</strong>ï¼šFeign çš„è¶…æ—¶æœºåˆ¶æ˜¯æŒ‡åœ¨ä½¿ç”¨ Feign è¿›è¡ŒæœåŠ¡é—´çš„ HTTP è°ƒç”¨æ—¶ï¼Œè®¾ç½®è¯·æ±‚çš„è¶…æ—¶æ—¶é—´ã€‚å½“è¯·æ±‚è¶…è¿‡è®¾å®šçš„è¶…æ—¶æ—¶é—´åï¼ŒFeign å°†ä¼šä¸­æ–­è¯¥è¯·æ±‚å¹¶æŠ›å‡ºç›¸åº”çš„å¼‚å¸¸ã€‚</p><p><strong>è¶…æ—¶æœºåˆ¶çš„æ„ä¹‰</strong>ï¼š</p><p>1ã€é˜²æ­¢é•¿æ—¶é—´ç­‰å¾…ï¼šé€šè¿‡è®¾ç½®é€‚å½“çš„è¶…æ—¶æ—¶é—´ï¼Œå¯ä»¥é¿å…å®¢æˆ·ç«¯åœ¨è¯·æ±‚æœåŠ¡æ—¶é•¿æ—¶é—´ç­‰å¾…å“åº”è€Œå¯¼è‡´çš„æ€§èƒ½é—®é¢˜ã€‚å¦‚æœæ²¡æœ‰è¶…æ—¶æœºåˆ¶ï¼Œå®¢æˆ·ç«¯å¯èƒ½ä¼šä¸€ç›´ç­‰å¾…ï¼Œä»è€Œå½±å“æ•´ä¸ªç³»ç»Ÿçš„ååé‡å’Œå“åº”æ—¶é—´ã€‚</p><p>2ã€é¿å…èµ„æºæµªè´¹ï¼šè¶…æ—¶æœºåˆ¶å¯ä»¥å¸®åŠ©åŠæ—¶é‡Šæ”¾å ç”¨çš„èµ„æºï¼Œä¾‹å¦‚è¿æ¥ã€çº¿ç¨‹ç­‰ã€‚å¦‚æœè¯·æ±‚ä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€è€Œä¸è¶…æ—¶ï¼Œå°†å¯¼è‡´èµ„æºçš„æµªè´¹å’Œç³»ç»Ÿçš„è´Ÿè½½å¢åŠ ã€‚</p><p>3ã€ä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼šè¶…æ—¶æœºåˆ¶å¯ä»¥é˜²æ­¢ç”¨æˆ·é•¿æ—¶é—´ç­‰å¾…æ— å“åº”çš„æƒ…å†µå‘ç”Ÿï¼Œæä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚å½“è¯·æ±‚è¶…æ—¶æ—¶ï¼Œå¯ä»¥åŠæ—¶ç»™å‡ºé”™è¯¯æç¤ºæˆ–è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œä»¥æé†’ç”¨æˆ·æˆ–é‡‡å–å…¶ä»–æªæ–½ã€‚</p><p>feigné»˜è®¤çš„è¶…æ—¶é…ç½®ä¸ºï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624103625541.png" alt="image-20230624103625541" tabindex="0" loading="lazy"><figcaption>image-20230624103625541</figcaption></figure><p>è¶…æ—¶æ—¶é—´è¶Šé•¿ï¼Œèµ„æºæµªè´¹çš„æ—¶é—´å°±è¶Šé•¿ï¼Œç³»ç»Ÿçš„ç¨³å®šæ€§å°±è¶Šå·®ï¼Œå› æ­¤éœ€è¦è®¾ç½®ä¸ºä¸€ä¸ªè¾ƒä¸ºåˆç†çš„è¶…æ—¶æ—¶é—´ï¼Œè®¾ç½®é˜²æ­¢å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">openfeign</span><span class="token punctuation">:</span>
      <span class="token key atrule">client</span><span class="token punctuation">:</span>
        <span class="token key atrule">config</span><span class="token punctuation">:</span>
          <span class="token key atrule">default</span><span class="token punctuation">:</span>
            <span class="token key atrule">loggerLevel</span><span class="token punctuation">:</span> full	
            <span class="token key atrule">read-timeout</span><span class="token punctuation">:</span> <span class="token number">2000</span>			<span class="token comment"># è¯»å–æ•°æ®çš„è¶…æ—¶æ—¶é—´è®¾ç½®ä¸º2s</span>
            <span class="token key atrule">connect-timeout</span><span class="token punctuation">:</span> <span class="token number">2000</span>		<span class="token comment"># å»ºç«‹è¿æ¥çš„è¶…æ—¶æ—¶é—´è®¾ç½®ä¸º2s</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-3-3-é‡è¯•é…ç½®" tabindex="-1"><a class="header-anchor" href="#_5-3-3-é‡è¯•é…ç½®" aria-hidden="true">#</a> 5.3.3 é‡è¯•é…ç½®</h4><p>feignä¸€æ—¦è¯·æ±‚è¶…æ—¶äº†ï¼Œé‚£ä¹ˆæ­¤æ—¶å°±ä¼šç›´æ¥æŠ›å‡º<strong>SocketTimeoutException</strong>: Read timed outçš„å¼‚å¸¸ã€‚è¯·æ±‚è¶…æ—¶çš„åŸå› æœ‰å¾ˆå¤šç§ï¼Œå¦‚ç½‘ç»œæŠ–åŠ¨ã€æœåŠ¡ä¸å¯ç”¨ç­‰ã€‚å¦‚æœç”±äºç½‘ç»œæš‚æ—¶ä¸å¯ç”¨å¯¼è‡´è§¦å‘äº†è¶…æ—¶æœºåˆ¶ï¼Œé‚£ä¹ˆæ­¤æ—¶ç›´æ¥è¿”å›å¼‚å¸¸ä¿¡æ¯å°±å¹¶ä¸æ˜¯ç‰¹åˆ«çš„åˆç†ï¼Œå°¤å…¶é’ˆå¯¹æŸ¥è¯¢è¯·æ±‚ï¼Œè‚¯å®šå¸Œæœ›å¾—åˆ°ä¸€ä¸ªç»“æœã€‚åˆç†çš„åšæ³•ï¼š<strong>è§¦å‘è¶…æ—¶ä»¥åï¼Œè®©feignè¿›è¡Œé‡è¯•</strong>ã€‚</p><p>å…·ä½“æ­¥éª¤ï¼š</p><p>1ã€è‡ªå®šä¹‰é‡è¯•å™¨</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FeignClientRetryer</span> <span class="token keyword">implements</span> <span class="token class-name">Retryer</span> <span class="token punctuation">{</span>

    <span class="token comment">// å®šä¹‰ä¸¤ä¸ªæˆå‘˜å˜é‡æ¥å†³å®šé‡è¯•æ¬¡æ•°</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> start <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> end <span class="token operator">=</span> <span class="token number">3</span> <span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">continueOrPropagate</span><span class="token punctuation">(</span><span class="token class-name">RetryableException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token comment">// æ˜¯å¦éœ€è¦è¿›è¡Œé‡è¯•å–å†³äºè¯¥æ–¹æ³•æ˜¯å¦æŠ›å‡ºå¼‚å¸¸ï¼Œå¦‚æœæŠ›å‡ºå¼‚å¸¸é‡è¯•ç»“æŸ</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>start <span class="token operator">&gt;=</span> end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        start<span class="token operator">++</span> <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Retryer</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment">// æ¡†æ¶åº•å±‚è°ƒç”¨è¯¥æ–¹æ³•å¾—åˆ°ä¸€ä¸ªé‡è¯•å™¨</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FeignClientRetryer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2ã€é…ç½®é‡è¯•å™¨</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">openfeign</span><span class="token punctuation">:</span>
      <span class="token key atrule">client</span><span class="token punctuation">:</span>
        <span class="token key atrule">config</span><span class="token punctuation">:</span>
          <span class="token key atrule">default</span><span class="token punctuation">:</span>
            <span class="token key atrule">loggerLevel</span><span class="token punctuation">:</span> full
            <span class="token key atrule">read-timeout</span><span class="token punctuation">:</span> <span class="token number">2000</span>
            <span class="token key atrule">connect-timeout</span><span class="token punctuation">:</span> <span class="token number">2000</span>
            <span class="token key atrule">retryer</span><span class="token punctuation">:</span> com.atguigu.spzx.cloud.order.feign.FeignClientRetryer		<span class="token comment"># é…ç½®è‡ªå®šä¹‰é‡è¯•å™¨</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-4ä»£ç ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_5-4ä»£ç ä¼˜åŒ–" aria-hidden="true">#</a> 5.4ä»£ç ä¼˜åŒ–</h3><p><strong>ç°æœ‰ä»£ç ç¼ºç‚¹</strong></p><p>ä¸Šè¿°ä»£ç å­˜åœ¨çš„å¼Šç«¯ï¼šæ¯ä¸€ä¸ªæœåŠ¡æ¶ˆè´¹æ–¹è¦è°ƒç”¨æœåŠ¡æä¾›æ–¹ï¼Œéƒ½æ˜¯éœ€è¦å»å®šä¹‰ä¸€ä¸ªFeignçš„æ¥å£ï¼Œä¸åˆ©äºåæœŸä»£ç ç»´æŠ¤åœ¨å®é™…çš„å·¥ä½œè¿‡ç¨‹ä¸­ï¼Œéƒ½æ˜¯å°†Feignçš„æ¥å£æŠ½å–åˆ°ä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ä¸­ï¼Œå¹¶ä¸”ä¼šå°†æ•°æ®åº“æ‰€å¯¹åº”çš„å®ä½“ç±»ä¹ŸæŠ½å–åˆ°ä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ä¸­ï¼Œä¾›å…¶ä»–çš„æ¨¡å—è¿›è¡Œä½¿ç”¨ã€‚</p><p>ä¾‹å¦‚ï¼Œå°†UserFeginClientã€Feignçš„é»˜è®¤é…ç½®éƒ½æŠ½å–åˆ°ä¸€ä¸ªspzx-feign-apiåŒ…ä¸­ï¼ŒOrderã€Userå®ä½“ç±»æŠ½å–åˆ°ä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ä¸­ï¼Œå…¶ä»–çš„å¾®æœåŠ¡å¼•ç”¨è¯¥ä¾èµ–åŒ…ï¼Œå³å¯ç›´æ¥ä½¿ç”¨ã€‚</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624111700625.png" alt="è°ƒç”¨ä¼˜åŒ–åŸç†" tabindex="0" loading="lazy"><figcaption>è°ƒç”¨ä¼˜åŒ–åŸç†</figcaption></figure><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231027090658693.png" alt="ä¼˜åŒ–è¿‡ç¨‹å›¾è§£" tabindex="0" loading="lazy"><figcaption>ä¼˜åŒ–è¿‡ç¨‹å›¾è§£</figcaption></figure><p>é¢å‘å¯¹è±¡:å®ç°ç»„ä»¶å¤ç”¨çš„ç›®çš„</p><p>ä»£ç å®ç°ï¼š</p><p>1ã€å®šä¹‰ä¸€ä¸ªæ–°çš„æ¨¡å—spzx-cloud-modelï¼Œå¹¶åŠ å…¥å¦‚ä¸‹çš„ä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- lombokä¾èµ–ï¼Œå¿«é€Ÿç”Ÿæˆgetterå’Œsetteræ–¹æ³• --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2ã€å°†spzx-cloud-orderå¾®æœåŠ¡å’Œspzx-cloud-userå¾®æœåŠ¡ä¸­æ‰€å¯¹åº”çš„å®ä½“ç±»æŠ½å–åˆ°spzx-cloud-model</p><p>3ã€åˆ é™¤spzx-cloud-orderå¾®æœåŠ¡å’Œspzx-cloud-userå¾®æœåŠ¡ä¸­æ‰€å®šä¹‰çš„å®ä½“ç±»</p><p>4ã€åœ¨spzx-cloud-userå¾®æœåŠ¡ä¸­åŠ å…¥å¦‚ä¸‹ä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spzx-cloud-model<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>5ã€å®šä¹‰ä¸€ä¸ªæ–°çš„æ¨¡å—spzx-feign-apiï¼ŒåŠ å…¥å¦‚ä¸‹ä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- åŠ å…¥feginçš„ä¾èµ– --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-openfeign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- å®ä½“ç±»æ‰€å¯¹åº”çš„ä¾èµ– --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spzx-cloud-model<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>6ã€å°†spzx-cloud-orderä¸­ç¼–å†™çš„UserFeginClientã€DefaultFeignConfigurationã€DefaultFeignConfigurationéƒ½å¤åˆ¶åˆ°spzx-feign-apié¡¹ç›®ä¸­</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624113033761.png" alt="image-20230624113033761" tabindex="0" loading="lazy"><figcaption>image-20230624113033761</figcaption></figure><p>7ã€spzx-cloud-orderå¾®æœåŠ¡å¼•å…¥spzx-feign-apiä¾èµ–ï¼Œå¹¶ä¸”åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ feignæ¥å£çš„åŒ…æ‰«æè·¯å¾„</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableFeignClients</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;com.atguigu.spzx.cloud.feign.api&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderApplication</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">OrderApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">,</span> args<span class="token punctuation">)</span> <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-gatewayç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#_6-gatewayç»„ä»¶" aria-hidden="true">#</a> 6.Gatewayç»„ä»¶</h2><h3 id="_6-1è®¤è¯†gateway" tabindex="-1"><a class="header-anchor" href="#_6-1è®¤è¯†gateway" aria-hidden="true">#</a> 6.1è®¤è¯†Gateway</h3><ul><li>Gatwayæ˜¯ç½‘å…³ç»„ä»¶,æ˜¯SpringCloudå…¬å¸ç ”å‘çš„</li><li>Gatewayç½‘å…³åº•å±‚ä½¿ç”¨**Filter(è¿‡æ»¤å™¨)**å¯¹è¯·æ±‚è¿›è¡Œæ‹¦æˆª <ul><li>é™æµ(æ‹¦æˆªä¸‹æ¥,è¿›è¡Œåˆ†æ—¶æ”¾è¡Œ)</li><li>é»‘åå•(å®¢æˆ·ç«¯è®¿é—®)</li><li>ç»Ÿä¸€åŠŸèƒ½å¤„ç†(è·¨åŸŸ,ç™»å½•æ ¡éªŒç­‰)</li></ul></li><li>ç½‘å…³æœ‰å¤šä¸ªè¿‡æ»¤å™¨,å«åšè¿‡æ»¤é“¾</li><li>é€šè¿‡ç½‘å…³å¤šä¸€å±‚å¤„ç†ä¿éšœæœåŠ¡å™¨å®‰å…¨</li></ul><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231027092701104.png" alt="ç½‘å…³æ¶æ„åŸç†" tabindex="0" loading="lazy"><figcaption>ç½‘å…³æ¶æ„åŸç†</figcaption></figure><h3 id="_6-2ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#_6-2ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ" aria-hidden="true">#</a> 6.2ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µ</h3><h4 id="_6-2-1è·¯ç”±" tabindex="-1"><a class="header-anchor" href="#_6-2-1è·¯ç”±" aria-hidden="true">#</a> 6.2.1è·¯ç”±:</h4><p>ä¸åŒè·¯ç”±è®¿é—®ä¸åŒå†…å®¹</p><h4 id="_6-2-2æ–­è¨€-åŒ¹é…å…³ç³»" tabindex="-1"><a class="header-anchor" href="#_6-2-2æ–­è¨€-åŒ¹é…å…³ç³»" aria-hidden="true">#</a> 6.2.2æ–­è¨€(åŒ¹é…å…³ç³»):</h4><p>/api/user/**</p><p>/api/user/fing/1</p><p>/api/order/find/2(ä¸èƒ½è®¿é—®)</p><h4 id="_6-2-3è¿‡æ»¤å™¨" tabindex="-1"><a class="header-anchor" href="#_6-2-3è¿‡æ»¤å™¨" aria-hidden="true">#</a> 6.2.3è¿‡æ»¤å™¨:</h4><p>åº•å±‚æ˜¯è¿‡æ»¤å™¨,ç½‘å…³æœ‰å¾ˆå¤šè¿‡æ»¤å™¨,è¿‡æ»¤å™¨é“¾.</p><h3 id="_6-3gatewayå·¥ä½œæµç¨‹" tabindex="-1"><a class="header-anchor" href="#_6-3gatewayå·¥ä½œæµç¨‹" aria-hidden="true">#</a> 6.3Gatewayå·¥ä½œæµç¨‹</h3><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231027093301407.png" alt="image-20231027093301407" tabindex="0" loading="lazy"><figcaption>image-20231027093301407</figcaption></figure><ul><li>å®¢æˆ·ç«¯å‘Spring Cloud Gatewayå‘å‡ºè¯·æ±‚ã€‚ç„¶ååœ¨Gateway Handler Mappingä¸­æ‰¾åˆ°ä¸è¯·æ±‚åŒ¹é…çš„è·¯ç”±ï¼Œå°†å…¶å‘é€åˆ°Gateway Web Handler.</li><li>Handlerå†é€šè¿‡æŒ‡å®šçš„è¿‡æ»¤å™¨é“¾æ¥å°†è¯·æ±‚å‘é€ç»™æˆ‘ä»¬å®é™…çš„æœåŠ¡æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œç„¶åè¿”å›ã€‚</li><li>è¿‡æ»¤å™¨ä¹‹é—´ç”¨è™šçº¿åˆ†å¼€æ˜¯å› ä¸ºè¿‡æ»¤å™¨å¯èƒ½ä¼šåœ¨å‘é€ä»£ç†è¯·æ±‚ä¹‹å‰ï¼ˆ&quot;pre&quot;ï¼‰æˆ–ä¹‹å(&quot;post&quot;)æ‰§è¡Œä¸šåŠ¡é€»è¾‘ã€‚</li><li>Filteråœ¨&quot;pre&quot;ç±»å‹çš„è¿‡æ»¤å™¨å¯ä»¥åšå‚æ•°æ ¡éªŒã€æƒé™æ ¡éªŒã€æµé‡ç›‘æ§ã€æ—¥å¿—è¾“å‡ºã€åè®®è½¬æ¢ç­‰ï¼Œåœ¨&quot;post&quot;ç±»å‹çš„è¿‡æ»¤å™¨ä¸­å¯ä»¥åšå“åº”å†…å®¹ã€å“åº”å¤´çš„ä¿®æ”¹ï¼Œæ—¥å¿—çš„è¾“å‡ºï¼Œæµé‡æ§åˆ¶ç­‰æœ‰ç€éå¸¸é‡è¦çš„ä½œç”¨</li></ul><h3 id="_6-4gatewayåˆä½“éªŒ" tabindex="-1"><a class="header-anchor" href="#_6-4gatewayåˆä½“éªŒ" aria-hidden="true">#</a> 6.4Gatewayåˆä½“éªŒ</h3><p>ä¸‹é¢ï¼Œæˆ‘ä»¬å°±æ¼”ç¤ºä¸‹ç½‘å…³çš„åŸºæœ¬è·¯ç”±åŠŸèƒ½ã€‚åŸºæœ¬æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>åˆ›å»ºç½‘å…³å¾®æœåŠ¡æ¨¡å—</p><ul><li>é…ç½®æ–‡ä»¶</li><li>åˆ›å»ºå¯åŠ¨ç±»</li><li>å¼•å…¥ä¾èµ–</li></ul></li><li><p>å°†ç½‘å…³åœ¨nacosä¸­è¿›è¡Œæ³¨å†Œ</p><ul><li><p>ä¿®æ”¹é…ç½®æ–‡ä»¶</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231027094239923.png" alt="é‡ç‚¹é…ç½®" tabindex="0" loading="lazy"><figcaption>é‡ç‚¹é…ç½®</figcaption></figure></li></ul></li><li><p>åœ¨ç½‘å…³æ¨¡å—ä¸­é…ç½®æ–‡ä»¶ä¸­,é…ç½®è·¯ç”±ä¿¡æ¯.</p></li></ol><ul><li>1ã€åœ¨spzx-cloud-parentä¸‹åˆ›å»ºå­æ¨¡å—spzx-cloud-gateway(åˆ›å»ºç½‘å…³å¾®æœåŠ¡æ¨¡å—)</li></ul><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230721101439700.png" alt="image-20230721101439700" tabindex="0" loading="lazy"><figcaption>image-20230721101439700</figcaption></figure><ul><li>2ã€å¼•å…¥å¦‚ä¸‹ä¾èµ–ï¼š</li></ul><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--ç½‘å…³--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-gateway<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--nacosæœåŠ¡å‘ç°ä¾èµ–--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- è´Ÿè½½å‡è¡¡ç»„ä»¶ --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-loadbalancer<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230721092532222.png" alt="image-20230721092532222" tabindex="0" loading="lazy"><figcaption>image-20230721092532222</figcaption></figure><ul><li>3ã€ç¼–å†™å¯åŠ¨ç±»</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// com.atguigu.spzx.cloud.gateway</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GatewayApplication</span> <span class="token punctuation">{</span>

	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">GatewayApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>4ã€åœ¨application.ymlé…ç½®æ–‡ä»¶ä¸­ç¼–å†™åŸºç¡€é…ç½®å’Œè·¯ç”±è§„åˆ™</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8222</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> spzx<span class="token punctuation">-</span>cloud<span class="token punctuation">-</span>gateway
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">locator</span><span class="token punctuation">:</span>
          <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> spzx<span class="token punctuation">-</span>cloud<span class="token punctuation">-</span>user  <span class="token comment"># è·¯ç”±idï¼Œå¯ä»¥è‡ªå®šä¹‰ï¼Œåªè¦å”¯ä¸€å³å¯</span>
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//spzx<span class="token punctuation">-</span>cloud<span class="token punctuation">-</span>user  <span class="token comment"># è·¯ç”±çš„ç›®æ ‡åœ°å€ lbå°±æ˜¯è´Ÿè½½å‡è¡¡ï¼Œåé¢è·ŸæœåŠ¡åç§°</span>
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/<span class="token important">*/user/**</span> <span class="token comment"># è·¯å¾„åŒ¹é…</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> spzx<span class="token punctuation">-</span>cloud<span class="token punctuation">-</span>order
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//spzx<span class="token punctuation">-</span>cloud<span class="token punctuation">-</span>order
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/<span class="token important">*/order/**</span> <span class="token comment"># è·¯å¾„åŒ¹é…</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">server.port</span><span class="token punctuation">=</span><span class="token value attr-value">8222</span>
<span class="token key attr-name">spring.application.name</span><span class="token punctuation">=</span><span class="token value attr-value">spzx-cloud-gateway</span>
<span class="token key attr-name">spring.cloud.gateway.discovery.locator.enabled</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token key attr-name">spring.cloud.gateway.routes[0].id</span><span class="token punctuation">=</span><span class="token value attr-value">spzx-cloud-user</span>
<span class="token key attr-name">spring.cloud.gateway.routes[0].uri</span><span class="token punctuation">=</span><span class="token value attr-value">lb://spzx-cloud-user</span>
<span class="token key attr-name">spring.cloud.gateway.routes[0].predicates[0]</span><span class="token punctuation">=</span><span class="token value attr-value">Path=/*/user/**</span>
<span class="token key attr-name">spring.cloud.gateway.routes[1].id</span><span class="token punctuation">=</span><span class="token value attr-value">spzx-cloud-order</span>
<span class="token key attr-name">spring.cloud.gateway.routes[1].uri</span><span class="token punctuation">=</span><span class="token value attr-value">lb://spzx-cloud-order</span>
<span class="token key attr-name">spring.cloud.gateway.routes[1].predicates[0]</span><span class="token punctuation">=</span><span class="token value attr-value">Path=/*/order/**</span>
<span class="token key attr-name">spring.cloud.nacos.discovery.server-addr</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1:8848</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>5ã€é‡å¯æµ‹è¯•</li></ul><p>é‡å¯ç½‘å…³ï¼Œè®¿é—®<a href="http://localhost:8222/api/user/findUserByUserId/1%E6%97%B6%EF%BC%8C%E7%AC%A6%E5%90%88%60/api/user/**%60%E8%A7%84%E5%88%99%EF%BC%8C" target="_blank" rel="noopener noreferrer">http://localhost:8222/api/user/findUserByUserId/1æ—¶ï¼Œç¬¦åˆ`/api/user/**`è§„åˆ™ï¼Œ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>è¯·æ±‚è½¬å‘åˆ°uriï¼š<a href="http://spzx-cloud-user/api/user/findUserByUserId/1%EF%BC%8C%E5%BE%97%E5%88%B0%E4%BA%86%E7%BB%93%E6%9E%9C%EF%BC%9A" target="_blank" rel="noopener noreferrer">http://spzx-cloud-user/api/user/findUserByUserId/1ï¼Œå¾—åˆ°äº†ç»“æœï¼š<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624163155679.png" alt="image-20230624163155679" tabindex="0" loading="lazy"><figcaption>image-20230624163155679</figcaption></figure><h3 id="_6-5predicateçš„ä½¿ç”¨-è·¯ç”±æ–­è¨€å·¥å‚" tabindex="-1"><a class="header-anchor" href="#_6-5predicateçš„ä½¿ç”¨-è·¯ç”±æ–­è¨€å·¥å‚" aria-hidden="true">#</a> 6.5Predicateçš„ä½¿ç”¨(è·¯ç”±æ–­è¨€å·¥å‚)</h3><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231027102236948.png" alt="æ–­è¨€å·¥å‚" tabindex="0" loading="lazy"><figcaption>æ–­è¨€å·¥å‚</figcaption></figure><ul><li>å¯åŠ¨ç½‘å…³æœåŠ¡åï¼Œåœ¨æ§åˆ¶å°å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</li></ul><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230721101903404.png" alt="image-20230721101903404" tabindex="0" loading="lazy"><figcaption>image-20230721101903404</figcaption></figure><ul><li>æ€è€ƒé—®é¢˜ï¼šæˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­åªæ˜¯é…ç½®äº†ä¸€ä¸ªè®¿é—®è·¯å¾„çš„è§„åˆ™ï¼Œæ€ä¹ˆå°±å¯ä»¥å®ç°è·¯ç”±å‘¢?</li></ul><p>åº•å±‚åŸç†ï¼šæ¡†æ¶åº•å±‚ä¼šè‡ªåŠ¨è¯»å–é…ç½®æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œç„¶åé€šè¿‡åˆ¶å®šçš„è·¯ç”±å·¥å‚å°†å…¶è½¬æ¢æˆå¯¹åº”çš„åˆ¤æ–­æ¡ä»¶ï¼Œç„¶åè¿›è¡Œåˆ¤æ–­ã€‚åœ¨Gatewayä¸­æä¾›äº†å¾ˆå¤šçš„è·¯ç”±å·¥å‚å¦‚ä¸‹æ‰€ç¤ºï¼š<a href="https://docs.spring.io/spring-cloud-gateway/docs/4.0.6/reference/html/#gateway-request-predicates-factories" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-cloud-gateway/docs/4.0.6/reference/html/#gateway-request-predicates-factories<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624163811030.png" alt="image-20230624163811030" tabindex="0" loading="lazy"><figcaption>image-20230624163811030</figcaption></figure><p>å¤§è‡´æœ‰12ä¸ªï¼Œæ¯ä¸€ç§è·¯ç”±å·¥å‚çš„ä½¿ç”¨Spring Cloudçš„å®˜ç½‘éƒ½ç»™å‡ºäº†å…·ä½“çš„ç¤ºä¾‹ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒç¤ºä¾‹ä»£ç è¿›è¡Œä½¿ç”¨ã€‚ä»¥After Route Predicate</p><p>Factoryè·¯ç”±å·¥å‚ä¸¾ä¾‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> spzx<span class="token punctuation">-</span>cloud<span class="token punctuation">-</span>user
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//spzx<span class="token punctuation">-</span>cloud<span class="token punctuation">-</span>user
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/api/user/<span class="token important">**</span>
            <span class="token punctuation">-</span> After=2023<span class="token punctuation">-</span>07<span class="token punctuation">-</span>21T10<span class="token punctuation">:</span>23<span class="token punctuation">:</span>06.978038800+08<span class="token punctuation">:</span>00<span class="token punctuation">[</span>Asia/Shanghai<span class="token punctuation">]</span>  <span class="token comment"># ç³»ç»Ÿæ—¶é—´åœ¨2023-07-21ä¹‹åæ‰å¯ä»¥è¿›è¡Œè®¿é—®</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//è·å–å½“å‰æ—¶åŒºæ—¶é—´ä»£ç </span>
<span class="token class-name">ZonedDateTime</span> zonedDateTime <span class="token operator">=</span> <span class="token class-name">ZonedDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>zonedDateTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æ€»ç»“</li></ul><blockquote><p>Spring Cloud Gatewayå°†è·¯ç”±åŒ¹é…ä½œä¸ºSpring WebFlux HandlerMapperåŸºç¡€æ¡†æ¶çš„ä¸€éƒ¨åˆ†ã€‚<br> Spring Cloud GatewayåŒ…æ‹¬è®¸å¤šå†…ç½®çš„Route Predicateå·¥å‚ã€‚æ‰€æœ‰è¿™äº›Predicateéƒ½ä¸HTTPè¯·æ±‚çš„ä¸åŒå±æ€§åŒ¹é…ã€‚å¤šä¸ªRoute Predicateå·¥å‚å¯ä»¥è¿›è¡Œç»„åˆ<br> Spring Cloud Gatewayåˆ›å»ºRouteå¯¹è±¡æ—¶ï¼Œä½¿ç”¨RoutePredicateFactoryåˆ›å»ºPredicateå¯¹è±¡ï¼ŒPredicateå¯¹è±¡å¯ä»¥èµ‹å€¼ç»™ Routeã€‚Spring Cloud GatewayåŒ…å«è®¸å¤šå†…ç½®çš„Route Predicate Factoriesã€‚æ‰€æœ‰è¿™äº›è°“è¯éƒ½åŒ¹é…HTTPè¯·æ±‚çš„ä¸åŒå±æ€§ã€‚å¤šç§è°“è¯å·¥å‚å¯ä»¥ç»„åˆï¼Œå¹¶é€šè¿‡é€»è¾‘and ã€‚</p></blockquote><h3 id="_6-6è¿‡æ»¤å™¨" tabindex="-1"><a class="header-anchor" href="#_6-6è¿‡æ»¤å™¨" aria-hidden="true">#</a> 6.6è¿‡æ»¤å™¨</h3><h4 id="_6-6-1-è¿‡æ»¤å™¨ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#_6-6-1-è¿‡æ»¤å™¨ç®€ä»‹" aria-hidden="true">#</a> 6.6.1 è¿‡æ»¤å™¨ç®€ä»‹</h4><p>åœ¨gatewayä¸­è¦å®ç°å…¶ä»–çš„åŠŸèƒ½ï¼šæƒé™æ§åˆ¶ã€æµé‡ç›‘æ§ã€ç»Ÿä¸€æ—¥å¿—å¤„ç†ç­‰ã€‚å°±éœ€è¦ä½¿ç”¨åˆ°gatewayä¸­æ‰€æä¾›çš„è¿‡æ»¤å™¨äº†ã€‚è¿‡æ»¤å™¨ï¼Œå¯ä»¥å¯¹è¿›å…¥ç½‘å…³çš„è¯·æ±‚å’Œå¾®æœåŠ¡è¿”å›çš„å“åº”åšå¤„ç†ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624164230054.png" alt="image-20230624164230054" tabindex="0" loading="lazy"><figcaption>image-20230624164230054</figcaption></figure><h4 id="_6-6-2-å†…ç½®è¿‡æ»¤å™¨" tabindex="-1"><a class="header-anchor" href="#_6-6-2-å†…ç½®è¿‡æ»¤å™¨" aria-hidden="true">#</a> 6.6.2 å†…ç½®è¿‡æ»¤å™¨</h4><p>spring gatewayæä¾›äº†31ç§ä¸åŒçš„è¿‡æ»¤å™¨ã€‚</p><p>å®˜ç½‘åœ°å€ï¼š<a href="https://docs.spring.io/spring-cloud-gateway/docs/2.2.9.RELEASE/reference/html/#gatewayfilter-factories" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-cloud-gateway/docs/2.2.9.RELEASE/reference/html/#gatewayfilter-factories<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>ä¾‹å¦‚ï¼š</p><table><thead><tr><th><strong>åç§°</strong></th><th><strong>è¯´æ˜</strong></th></tr></thead><tbody><tr><td>AddRequestHeader</td><td>ç»™å½“å‰è¯·æ±‚æ·»åŠ ä¸€ä¸ªè¯·æ±‚å¤´</td></tr><tr><td>RemoveRequestHeader</td><td>ç§»é™¤è¯·æ±‚ä¸­çš„ä¸€ä¸ªè¯·æ±‚å¤´</td></tr><tr><td>AddResponseHeader</td><td>ç»™å“åº”ç»“æœä¸­æ·»åŠ ä¸€ä¸ªå“åº”å¤´</td></tr><tr><td>RemoveResponseHeader</td><td>ä»å“åº”ç»“æœä¸­ç§»é™¤æœ‰ä¸€ä¸ªå“åº”å¤´</td></tr><tr><td>RequestRateLimiter</td><td>é™åˆ¶è¯·æ±‚çš„æµé‡</td></tr></tbody></table><p>åœ¨Gatewayä¸­æä¾›äº†ä¸‰ç§çº§åˆ«çš„ç±»å‹çš„è¿‡æ»¤å™¨ï¼š</p><p>1ã€è·¯ç”±è¿‡æ»¤å™¨ï¼šåªé’ˆå¯¹å½“å‰è·¯ç”±æœ‰æ•ˆ</p><p>2ã€é»˜è®¤è¿‡æ»¤å™¨ï¼šé’ˆå¯¹æ‰€æœ‰çš„è·¯ç”±éƒ½æœ‰æ•ˆ</p><p>3ã€å…¨å±€è¿‡æ»¤å™¨ï¼šé’ˆå¯¹æ‰€æœ‰çš„è·¯ç”±éƒ½æœ‰æ•ˆï¼Œéœ€è¦è¿›è¡Œè‡ªå®šä¹‰</p><h4 id="_6-6-3-è·¯ç”±è¿‡æ»¤å™¨" tabindex="-1"><a class="header-anchor" href="#_6-6-3-è·¯ç”±è¿‡æ»¤å™¨" aria-hidden="true">#</a> 6.6.3 è·¯ç”±è¿‡æ»¤å™¨</h4><p>éœ€æ±‚ï¼šç»™æ‰€æœ‰è¿›å…¥spzx-cloud-userçš„è¯·æ±‚æ·»åŠ ä¸€ä¸ªè¯·æ±‚å¤´ï¼šTruth=atguigu</p><p>å®ç°ï¼š</p><p>1ã€ä¿®æ”¹gatewayæœåŠ¡çš„application.ymlæ–‡ä»¶ï¼Œæ·»åŠ è·¯ç”±è¿‡æ»¤</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> spzx<span class="token punctuation">-</span>cloud<span class="token punctuation">-</span>user
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//spzx<span class="token punctuation">-</span>cloud<span class="token punctuation">-</span>user
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/api/user/<span class="token important">**</span>
          <span class="token key atrule">filters</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> AddRequestHeader=Truth<span class="token punctuation">,</span> daimakuai		<span class="token comment"># é…ç½®è·¯ç”±åŸºæœ¬çš„è¿‡æ»¤å™¨ï¼Œç»™è®¿é—®userå¾®æœåŠ¡çš„æ‰€æœ‰æ¥å£æ·»åŠ Truthè¯·æ±‚å¤´</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“å‰è¿‡æ»¤å™¨å†™åœ¨spzx-cloud-userè·¯ç”±ä¸‹ï¼Œå› æ­¤ä»…ä»…å¯¹è®¿é—®spzx-cloud-userçš„è¯·æ±‚æœ‰æ•ˆã€‚</p><p>2ã€åœ¨spzx-cloud-userçš„æ¥å£æ–¹æ³•ä¸­è¯»å–è¯·æ±‚å¤´æ•°æ®ï¼Œè¿›è¡Œæµ‹è¯•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/findUserByUserId/{userId}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">findUserByUserId</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;userId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId <span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestHeader</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Truth&quot;</span><span class="token punctuation">)</span><span class="token class-name">String</span> header<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;UserController...findUserByUserIdæ–¹æ³•æ‰§è¡Œäº†... ,header: {} &quot;</span> <span class="token punctuation">,</span> header<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> userService<span class="token punctuation">.</span><span class="token function">findUserByUserId</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-6-4-é»˜è®¤è¿‡æ»¤å™¨" tabindex="-1"><a class="header-anchor" href="#_6-6-4-é»˜è®¤è¿‡æ»¤å™¨" aria-hidden="true">#</a> 6.6.4 é»˜è®¤è¿‡æ»¤å™¨</h4><p>å¦‚æœè¦å¯¹æ‰€æœ‰çš„è·¯ç”±éƒ½ç”Ÿæ•ˆï¼Œåˆ™å¯ä»¥å°†è¿‡æ»¤å™¨å·¥å‚å†™åˆ°defaultä¸‹ã€‚æ ¼å¼å¦‚ä¸‹ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">gateway</span><span class="token punctuation">:</span>
      <span class="token key atrule">routes</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">id</span><span class="token punctuation">:</span> spzx<span class="token punctuation">-</span>cloud<span class="token punctuation">-</span>user
          <span class="token key atrule">uri</span><span class="token punctuation">:</span> lb<span class="token punctuation">:</span>//spzx<span class="token punctuation">-</span>cloud<span class="token punctuation">-</span>user
          <span class="token key atrule">predicates</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> Path=/api/user/<span class="token important">**</span>
            <span class="token punctuation">-</span> After=2017<span class="token punctuation">-</span>01<span class="token punctuation">-</span>20T17<span class="token punctuation">:</span>42<span class="token punctuation">:</span>47.789<span class="token punctuation">-</span>07<span class="token punctuation">:</span>00<span class="token punctuation">[</span>America/Denver<span class="token punctuation">]</span>
      <span class="token key atrule">default-filters</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> AddRequestHeader=Truth<span class="token punctuation">,</span> daimakuai is good
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-6-5-å…¨å±€è¿‡æ»¤å™¨" tabindex="-1"><a class="header-anchor" href="#_6-6-5-å…¨å±€è¿‡æ»¤å™¨" aria-hidden="true">#</a> 6.6.5 å…¨å±€è¿‡æ»¤å™¨</h4><ul><li>æ¦‚è¿°</li></ul><p>**ä¸Šè¿°çš„è¿‡æ»¤å™¨æ˜¯gatewayä¸­æä¾›çš„é»˜è®¤çš„è¿‡æ»¤å™¨ï¼Œæ¯ä¸€ä¸ªè¿‡æ»¤å™¨çš„åŠŸèƒ½éƒ½æ˜¯å›ºå®šçš„ã€‚**ä½†æ˜¯å¦‚æœæˆ‘ä»¬å¸Œæœ›æ‹¦æˆªè¯·æ±‚ï¼Œåšè‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ï¼Œé»˜è®¤çš„è¿‡æ»¤å™¨å°±æ²¡åŠæ³•å®ç°ã€‚æ­¤æ—¶å°±éœ€æ±‚ä½¿ç”¨å…¨å±€è¿‡æ»¤å™¨ï¼Œå…¨å±€è¿‡æ»¤å™¨çš„ä½œç”¨ä¹Ÿæ˜¯å¤„ç†ä¸€åˆ‡è¿›å…¥ç½‘å…³çš„è¯·æ±‚å’Œå¾®æœåŠ¡å“åº”ï¼Œä¸GatewayFilterçš„ä½œç”¨ä¸€æ ·ã€‚åŒºåˆ«åœ¨äºGatewayFilteré€šè¿‡é…ç½®å®šä¹‰ï¼Œå¤„ç†é€»è¾‘æ˜¯å›ºå®šçš„ï¼›è€ŒGlobalFilterçš„é€»è¾‘éœ€è¦è‡ªå·±å†™ä»£ç å®ç°ã€‚</p><ul><li>éœ€æ±‚ï¼šå®šä¹‰å…¨å±€è¿‡æ»¤å™¨ï¼Œæ‹¦æˆªè¯·æ±‚ï¼Œåˆ¤æ–­è¯·æ±‚çš„å‚æ•°æ˜¯å¦æ»¡è¶³ä¸‹é¢æ¡ä»¶ï¼š</li></ul><p><strong>è¯·æ±‚å‚æ•°ä¸­æ˜¯å¦æœ‰usernameï¼Œå¦‚æœåŒæ—¶æ»¡è¶³åˆ™æ”¾è¡Œï¼Œå¦åˆ™æ‹¦æˆª</strong></p><ul><li>æ­¥éª¤åˆ†æï¼š</li></ul><ol><li><p>å®šä¹‰ä¸€ä¸ªç±»å®ç°<strong>GlobalFilter</strong>æ¥å£â“å…¨å±€è¿‡æ»¤å™¨æ¥å£</p></li><li><p>é‡å†™filteræ–¹æ³•</p></li><li><p>å°†è¯¥ç±»çº³å…¥åˆ°springå®¹å™¨ä¸­</p></li><li><p>å®ç°<strong>Ordered</strong>æ¥å£å®šä¹‰è¯¥è¿‡æ»¤å™¨çš„é¡ºåºâ“è¿‡æ»¤å™¨é¡ºæ¥å£</p></li><li><p>å®ç°<strong>globleFilte</strong>ré‡Œé¢çš„æ–¹æ³•,ç„¶åè¿›è¡Œæ”¾è¡Œæ“ä½œ</p></li><li><p>å®ç°<strong>getOrder</strong>æ–¹æ³•,å®ç°è¿‡æ»¤å™¨æ’åº</p></li></ol><ul><li>å®ç°ä»£ç ï¼šåˆ¤æ–­è¯·æ±‚è·¯å¾„ä¸­ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¦æ˜¯username,å¦‚æœæ˜¯æ­£å¸¸è®¿é—®,å¦‚æœä¸æ˜¯å°±ä¸èƒ½æ­£å¸¸è®¿é—®</li></ul><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231027105508582.png" alt="å…·ä½“" tabindex="0" loading="lazy"><figcaption>å…·ä½“</figcaption></figure><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span><span class="token comment">//ç±»äº¤ç»™Springè¿›è¡Œç®¡ç†</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AuthorizationFilter</span> <span class="token keyword">implements</span> <span class="token class-name">GlobalFilter</span><span class="token punctuation">,</span> <span class="token class-name">Ordered</span> <span class="token punctuation">{</span><span class="token comment">//å®ç°æ¥å¹´ä¸¤ä¸ªæ¥å£</span>

    <span class="token comment">//å®ç°è¿‡æ»¤å™¨é€»è¾‘</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Mono</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token class-name">ServerWebExchange</span> exchange<span class="token punctuation">,</span> <span class="token class-name">GatewayFilterChain</span> chain<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//è·å–è¯·æ±‚è·¯å¾„ä¸­å‚æ•°,åˆ¤æ–­å‚æ•°æ˜¯å¦æ˜¯username,å¦‚æœæ˜¯æ”¾è¡Œ,å¦‚æœä¸æ˜¯ä¸èƒ½è®¿é—®,å°±ä¸æ”¾è¡Œ</span>
        <span class="token comment">//å‚æ•°ä¸­exchage:é€šè¿‡è¿™ä¸ªå¯ä»¥è·å¾—requestå¯¹è±¡</span>
        <span class="token comment">//å‚æ•°ä¸­chain:</span>
        <span class="token comment">//æ–¹æ³•getQueryParams()ä¼šè¿”å›ä¸€ä¸ªMapå¯¹è±¡,ä¿å­˜å‚æ•°çš„ä¿¡æ¯,å‚æ•°åæ˜¯å¯ä»¥,å‚æ•°å€¼æ˜¯value</span>
        <span class="token comment">//éå†map,è·å–æ‰€æœ‰çš„keyæ ¹æ®keyè¿›è¡Œéå†</span>
        <span class="token class-name">String</span> username <span class="token operator">=</span> exchange<span class="token punctuation">.</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueryParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFirst</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">hasText</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">//è®¾ç½®å“åº”çŠ¶æ€ç </span>
            exchange<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setStatusCode</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">UNAUTHORIZED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> exchange<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setComplete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> chain<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//å®šä¹‰è¯¥è¿‡æ»¤å™¨çš„ä¼˜å…ˆçº§</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-6-6-è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåº" tabindex="-1"><a class="header-anchor" href="#_6-6-6-è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåº" aria-hidden="true">#</a> 6.6.6 è¿‡æ»¤å™¨æ‰§è¡Œé¡ºåº</h4><p>è¯·æ±‚è¿›å…¥ç½‘å…³ä¼šç¢°åˆ°ä¸‰ç±»è¿‡æ»¤å™¨ï¼šå½“å‰è·¯ç”±çš„è¿‡æ»¤å™¨ã€DefaultFilterã€GlobalFilter</p><p>è¯·æ±‚è·¯ç”±åï¼Œä¼šå°†å½“å‰è·¯ç”±è¿‡æ»¤å™¨å’ŒDefaultFilterã€GlobalFilterï¼Œåˆå¹¶åˆ°ä¸€ä¸ªè¿‡æ»¤å™¨é“¾ï¼ˆé›†åˆï¼‰ä¸­ï¼Œæ’åºåä¾æ¬¡æ‰§è¡Œæ¯ä¸ªè¿‡æ»¤å™¨ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624170925571.png" alt="image-20230624170925571" tabindex="0" loading="lazy"><figcaption>image-20230624170925571</figcaption></figure><p>æ’åºçš„è§„åˆ™æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>1ã€æŒ‰ç…§orderçš„å€¼è¿›è¡Œæ’åºï¼Œorderçš„å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼Œæ‰§è¡Œé¡ºåºè¶Šé å‰ã€‚</p><p>2ã€è·¯ç”±è¿‡æ»¤å™¨å’Œé»˜è®¤è¿‡æ»¤å™¨ä¼šæŒ‰ç…§orderçš„å€¼è¿›è¡Œæ’åºï¼Œè¿™ä¸ªå€¼ç”±springè¿›è¡ŒæŒ‡å®šï¼Œé»˜è®¤æ˜¯æŒ‰ç…§å£°æ˜é¡ºåºä»1é€’å¢</p><p>3ã€å½“è¿‡æ»¤å™¨çš„orderå€¼ä¸€æ ·æ—¶ï¼Œä¼šæŒ‰ç…§ globalFilter &gt; defaultFilter &gt; è·¯ç”±è¿‡æ»¤å™¨çš„é¡ºåºæ‰§è¡Œ</p><p>æ ¸å¿ƒæºç åˆ†æï¼šorg.springframework.cloud.gateway.handler.FilteringWebHandler#handleæ–¹æ³•ä¼šåŠ è½½å…¨å±€è¿‡æ»¤å™¨ï¼Œä¸å‰é¢çš„è¿‡æ»¤å™¨åˆå¹¶åæ ¹æ®orderæ’åºï¼Œç»„ç»‡è¿‡æ»¤å™¨é“¾</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Mono</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token class-name">ServerWebExchange</span> exchange<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Route</span> route <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Route</span><span class="token punctuation">)</span>exchange<span class="token punctuation">.</span><span class="token function">getRequiredAttribute</span><span class="token punctuation">(</span><span class="token class-name">ServerWebExchangeUtils</span><span class="token punctuation">.</span><span class="token constant">GATEWAY_ROUTE_ATTR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// è·å–è·¯ç”±çº§åˆ«çš„è¿‡æ»¤å™¨å’Œé»˜è®¤è¿‡æ»¤å™¨çš„é›†åˆ</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GatewayFilter</span><span class="token punctuation">&gt;</span></span> gatewayFilters <span class="token operator">=</span> route<span class="token punctuation">.</span><span class="token function">getFilters</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// è·å–å…¨å±€è¿‡æ»¤å™¨çš„é›†åˆ</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GatewayFilter</span><span class="token punctuation">&gt;</span></span> combined <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>globalFilters<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// å°†å–è·¯ç”±çº§åˆ«çš„è¿‡æ»¤å™¨å’Œé»˜è®¤è¿‡æ»¤å™¨çš„é›†åˆä¸­çš„å…ƒç´ æ·»åŠ åˆ°å…¨å±€è¿‡æ»¤å™¨çš„é›†åˆä¸­</span>
    combined<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>gatewayFilters<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// è¿›è¡Œæ’åº</span>
    <span class="token class-name">AnnotationAwareOrderComparator</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>combined<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>logger<span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        logger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;Sorted gatewayFilterFactories: &quot;</span> <span class="token operator">+</span> combined<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// è°ƒç”¨è¿‡æ»¤å™¨é“¾ä¸­çš„filteræ–¹æ³•</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DefaultGatewayFilterChain</span><span class="token punctuation">(</span>combined<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>exchange<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7-nacosé…ç½®ä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#_7-nacosé…ç½®ä¸­å¿ƒ" aria-hidden="true">#</a> 7.Nacosé…ç½®ä¸­å¿ƒ</h2><p>Nacosé™¤äº†å¯ä»¥åšæ³¨å†Œä¸­å¿ƒï¼ŒåŒæ ·å¯ä»¥åšé…ç½®ç®¡ç†æ¥ä½¿ç”¨ã€‚</p><p>æŠŠå¤šä¸ªä¸ºæœåŠ¡æ¨¡å—ä¸­ç›¸åŒé…ç½®,é…ç½®åˆ°é…ç½®ä¸­å¿ƒä¸­,æ‰€æœ‰æ¨¡å—è¯»å–é…ç½®ä¸­å¿ƒä¸­çš„å†…å®¹.</p><ul><li>æ³¨å†Œä¸­å¿ƒ</li><li>é…ç½®ä¸­å¿ƒ</li></ul><h3 id="_7-1-ç»Ÿä¸€é…ç½®ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#_7-1-ç»Ÿä¸€é…ç½®ç®¡ç†" aria-hidden="true">#</a> 7.1 ç»Ÿä¸€é…ç½®ç®¡ç†</h3><p>ç›¸åŒé…ç½®éƒ¨åˆ†è¿›è¡ŒæŠ½å–.</p><p>å½“å¾®æœåŠ¡éƒ¨ç½²çš„å®ä¾‹è¶Šæ¥è¶Šå¤šï¼Œè¾¾åˆ°æ•°åã€æ•°ç™¾æ—¶ï¼Œé€ä¸ªä¿®æ”¹å¾®æœåŠ¡é…ç½®å°±æ˜¾å¾—ååˆ†çš„ä¸æ–¹ä¾¿ï¼Œè€Œä¸”å¾ˆå®¹æ˜“å‡ºé”™ã€‚æˆ‘ä»¬éœ€è¦ä¸€ç§ç»Ÿä¸€é…ç½®ç®¡ç†æ–¹æ¡ˆï¼Œå¯ä»¥é›†ä¸­ç®¡ç†æ‰€æœ‰å®ä¾‹çš„é…ç½®ã€‚</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624171403235.png" alt="image-20230624171403235" tabindex="0" loading="lazy"><figcaption>image-20230624171403235</figcaption></figure><p>nacosä¸€æ–¹é¢å¯ä»¥å°†é…ç½®é›†ä¸­ç®¡ç†ï¼Œå¦ä¸€æ–¹å¯ä»¥åœ¨é…ç½®å˜æ›´æ—¶ï¼ŒåŠæ—¶é€šçŸ¥å¾®æœåŠ¡ï¼Œå®ç°é…ç½®çš„çƒ­æ›´æ–°ã€‚</p><h3 id="_7-2-nacoså…¥é—¨" tabindex="-1"><a class="header-anchor" href="#_7-2-nacoså…¥é—¨" aria-hidden="true">#</a> 7.2 Nacoså…¥é—¨</h3><h4 id="_7-2-1-nacosä¸­æ·»åŠ é…ç½®" tabindex="-1"><a class="header-anchor" href="#_7-2-1-nacosä¸­æ·»åŠ é…ç½®" aria-hidden="true">#</a> 7.2.1 Nacosä¸­æ·»åŠ é…ç½®</h4><p>åœ¨NacosæœåŠ¡ç«¯åˆ›å»ºä¸€ä¸ªé…ç½®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624171530387.png" alt="image-20230624171530387" tabindex="0" loading="lazy"><figcaption>image-20230624171530387</figcaption></figure><p>ç„¶ååœ¨å¼¹å‡ºçš„è¡¨å•ä¸­ï¼Œå¡«å†™é…ç½®ä¿¡æ¯ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20210714164856664.png" alt="image-20210714164856664" tabindex="0" loading="lazy"><figcaption>image-20210714164856664</figcaption></figure><h4 id="_7-2-2-å¾®æœåŠ¡é›†æˆé…ç½®ä¸­å¿ƒ" tabindex="-1"><a class="header-anchor" href="#_7-2-2-å¾®æœåŠ¡é›†æˆé…ç½®ä¸­å¿ƒ" aria-hidden="true">#</a> 7.2.2 å¾®æœåŠ¡é›†æˆé…ç½®ä¸­å¿ƒ</h4><p>å¾®æœåŠ¡éœ€è¦è¿›è¡Œæ”¹é€ ï¼Œä»Nacosé…ç½®ä¸­å¿ƒä¸­è·å–é…ç½®ä¿¡æ¯è¿›è¡Œä½¿ç”¨ã€‚</p><p>æ­¥éª¤ï¼š</p><p>1ã€åœ¨spzx-cloud-userå¾®æœåŠ¡ä¸­ï¼Œå¼•å…¥spring-cloud-starter-alibaba-nacos-configä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- nacosä½œä¸ºé…ç½®ä¸­å¿ƒæ—¶æ‰€å¯¹åº”çš„ä¾èµ– --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2ã€åœ¨spzx-cloud-useré¡¹ç›®çš„ /src/main/resources/application.yml é…ç½®æ–‡ä»¶ä¸­é…ç½® Nacos Config åœ°å€å¹¶å¼•å…¥æœåŠ¡é…ç½®</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># é…ç½®æ•°æ®åº“çš„è¿æ¥ä¿¡æ¯</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">config</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 192.168.136.142<span class="token punctuation">:</span><span class="token number">8848</span>
  <span class="token key atrule">config</span><span class="token punctuation">:</span>
    <span class="token key atrule">import</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> nacos<span class="token punctuation">:</span>spzx<span class="token punctuation">-</span>cloud<span class="token punctuation">-</span>user<span class="token punctuation">-</span>dev.yml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7-2-3-è¯»å–è‡ªå®šä¹‰é…ç½®" tabindex="-1"><a class="header-anchor" href="#_7-2-3-è¯»å–è‡ªå®šä¹‰é…ç½®" aria-hidden="true">#</a> 7.2.3 è¯»å–è‡ªå®šä¹‰é…ç½®</h4><h5 id="value" tabindex="-1"><a class="header-anchor" href="#value" aria-hidden="true">#</a> @Value</h5><p>é€šè¿‡@Valueæ³¨è§£è¯»å–è‡ªå®šä¹‰é…ç½®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/api/user&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserService</span> userService <span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${pattern.dateformat}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> pattern <span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/findUserByUserId/{userId}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">findUserByUserId</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;userId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId <span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestHeader</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Truth&quot;</span><span class="token punctuation">)</span><span class="token class-name">String</span> header<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;UserController...findUserByUserIdæ–¹æ³•æ‰§è¡Œäº†... ,header: {} , dateformat: {} &quot;</span> <span class="token punctuation">,</span> header <span class="token punctuation">,</span> pattern<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> userService<span class="token punctuation">.</span><span class="token function">findUserByUserId</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span> <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="configurationproperties" tabindex="-1"><a class="header-anchor" href="#configurationproperties" aria-hidden="true">#</a> @ConfigurationProperties</h5><p>ä¹Ÿå¯ä»¥é€šè¿‡å®ä½“ç±»ï¼Œé…åˆ@ConfigurationPropertiesæ³¨è§£è¯»å–è‡ªå®šä¹‰é…ç½®ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>1ã€å®šä¹‰ä¸€ä¸ªå®ä½“ç±»ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;pattern&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PatternProperties</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> dateformat <span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2ã€åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ @EnableConfigurationPropertiesæ³¨è§£ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token class-name">PatternProperties</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserApplication</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">UserApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">,</span> args<span class="token punctuation">)</span> <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3ã€ä½¿ç”¨è¯¥å®ä½“ç±»ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/api/user&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserService</span> userService <span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${pattern.dateformat}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> pattern <span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>   <span class="token comment">// æ³¨å…¥å®ä½“ç±»</span>
    <span class="token keyword">private</span> <span class="token class-name">PatternProperties</span> patternProperties <span class="token punctuation">;</span> 

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/findUserByUserId/{userId}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">findUserByUserId</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;userId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId <span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestHeader</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Truth&quot;</span><span class="token punctuation">)</span><span class="token class-name">String</span> header<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;UserController...findUserByUserIdæ–¹æ³•æ‰§è¡Œäº†... ,header: {} , dateformat: {} &quot;</span> <span class="token punctuation">,</span> header <span class="token punctuation">,</span> patternProperties<span class="token punctuation">.</span><span class="token function">getDateformat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> userService<span class="token punctuation">.</span><span class="token function">findUserByUserId</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span> <span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-3-é…ç½®çƒ­æ›´æ–°" tabindex="-1"><a class="header-anchor" href="#_7-3-é…ç½®çƒ­æ›´æ–°" aria-hidden="true">#</a> 7.3 é…ç½®çƒ­æ›´æ–°</h3><p>â­æˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„ï¼Œæ˜¯ä¿®æ”¹Nacosä¸­çš„é…ç½®åï¼Œå¾®æœåŠ¡ä¸­æ— éœ€é‡å¯å³å¯è®©é…ç½®ç”Ÿæ•ˆï¼Œä¹Ÿå°±æ˜¯<strong>é…ç½®çƒ­æ›´æ–°</strong>ã€‚å®ç°é…ç½®çš„çƒ­æ›´æ–°æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><blockquote><p>æ–¹å¼ä¸€ï¼šåœ¨@Valueæ³¨å…¥çš„å˜é‡æ‰€åœ¨ç±»ä¸Šæ·»åŠ æ³¨è§£**@RefreshScope**</p></blockquote><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624200928589.png" alt="image-20230624200928589" tabindex="0" loading="lazy"><figcaption>image-20230624200928589</figcaption></figure><blockquote><p>æ–¹å¼äºŒï¼šé€šè¿‡å®ä½“ç±»ï¼Œé…åˆ@ConfigurationPropertiesæ³¨è§£è¯»å–é…ç½®ä¿¡æ¯ï¼Œ<strong>è‡ªåŠ¨</strong>æ”¯æŒçƒ­æ›´æ–°</p></blockquote><h3 id="_7-4-é…ç½®ä¼˜å…ˆçº§" tabindex="-1"><a class="header-anchor" href="#_7-4-é…ç½®ä¼˜å…ˆçº§" aria-hidden="true">#</a> 7.4 é…ç½®ä¼˜å…ˆçº§</h3><p>æ€è€ƒé—®é¢˜ï¼šå¦‚æœåœ¨application.ymlæ–‡ä»¶ä¸­å’ŒNacosé…ç½®ä¸­å¿ƒä¸­éƒ½å®šä¹‰äº†ç›¸åŒçš„é…ç½®å†…å®¹ï¼Œé‚£ä¹ˆå“ªä¸€ä¸ªé…ç½®çš„ä¼˜å…ˆçº§è¾ƒé«˜å‘¢?</p><p>ä¼˜å…ˆçº§é¡ºåºï¼šNacosé…ç½®ä¸­å¿ƒçš„é…ç½®(åå¯¼å…¥çš„é…ç½® &gt; å…ˆå¯¼å…¥çš„é…ç½®) &gt; application.yml</p><h2 id="_8-sentineléƒ¨åˆ†" tabindex="-1"><a class="header-anchor" href="#_8-sentineléƒ¨åˆ†" aria-hidden="true">#</a> 8.Sentineléƒ¨åˆ†</h2><h3 id="_8-1-åˆè¯†sentinel" tabindex="-1"><a class="header-anchor" href="#_8-1-åˆè¯†sentinel" aria-hidden="true">#</a> 8.1 åˆè¯†sentinel</h3><h4 id="_8-1-1-é›ªå´©æ•ˆåº”" tabindex="-1"><a class="header-anchor" href="#_8-1-1-é›ªå´©æ•ˆåº”" aria-hidden="true">#</a> 8.1.1 é›ªå´©æ•ˆåº”</h4><p>æ¦‚è¿°ï¼šåœ¨å¾®æœåŠ¡ç³»ç»Ÿæ¶æ„ä¸­ï¼ŒæœåŠ¡é—´è°ƒç”¨å…³ç³»é”™ç»¼å¤æ‚ï¼Œä¸€ä¸ªå¾®æœåŠ¡å¾€å¾€ä¾èµ–äºå¤šä¸ªå…¶å®ƒå¾®æœåŠ¡ã€‚ä¸€ä¸ªæœåŠ¡çš„ä¸å¯ç”¨å¯¼è‡´æ•´ä¸ªç³»ç»Ÿçš„ä¸å¯ç”¨çš„ç°è±¡å°±è¢«ç§°ä¹‹ä¸ºé›ªå´©æ•ˆåº”ã€‚</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231027143355361.png" alt="é›ªå´©åŸç†" tabindex="0" loading="lazy"><figcaption>é›ªå´©åŸç†</figcaption></figure><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624203044831-16882902699931.png" alt="image-20230624203044831" tabindex="0" loading="lazy"><figcaption>image-20230624203044831</figcaption></figure><p>å½“æœåŠ¡Då‡ºç°äº†é—®é¢˜äº†ä»¥åï¼Œè°ƒç”¨æœåŠ¡Dçš„æœåŠ¡Açš„çº¿ç¨‹å°±å¾—ä¸åˆ°åŠæ—¶çš„é‡Šæ”¾ï¼Œåœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œéšç€æ—¶é—´çš„ä¸æ–­æ¨ç§»æœåŠ¡Açš„ç³»ç»Ÿèµ„æºä¼šè¢«çº¿ç¨‹è€—å°½ï¼Œæœ€ç»ˆå¯¼è‡´æœåŠ¡Aå‡ºç°äº†é—®é¢˜ï¼ŒåŒç†å°±ä¼šå¯¼è‡´å…¶ä»–çš„æœåŠ¡ä¹Ÿä¸èƒ½è¿›è¡Œè®¿é—®äº†ã€‚</p><h4 id="_8-1-2-è§£å†³æ–¹æ¡ˆ" tabindex="-1"><a class="header-anchor" href="#_8-1-2-è§£å†³æ–¹æ¡ˆ" aria-hidden="true">#</a> 8.1.2 è§£å†³æ–¹æ¡ˆ</h4><h5 id="è¶…æ—¶å¤„ç†" tabindex="-1"><a class="header-anchor" href="#è¶…æ—¶å¤„ç†" aria-hidden="true">#</a> è¶…æ—¶å¤„ç†</h5><p>è¶…æ—¶å¤„ç†ï¼šè®¾å®šè¶…æ—¶æ—¶é—´ï¼Œè¯·æ±‚è¶…è¿‡ä¸€å®šæ—¶é—´æ²¡æœ‰å“åº”å°±è¿”å›é”™è¯¯ä¿¡æ¯ï¼Œä¸ä¼šæ— ä¼‘æ­¢ç­‰å¾…</p><p>ç§°ä¸º:æœåŠ¡é™çº§</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624203153340-16882902699943.png" alt="image-20230624203153340" tabindex="0" loading="lazy"><figcaption>image-20230624203153340</figcaption></figure><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231027144115270.png" alt="è¶…æ—¶å¤„ç†åŸç†" tabindex="0" loading="lazy"><figcaption>è¶…æ—¶å¤„ç†åŸç†</figcaption></figure><h5 id="éš”ç¦»å¤„ç†" tabindex="-1"><a class="header-anchor" href="#éš”ç¦»å¤„ç†" aria-hidden="true">#</a> éš”ç¦»å¤„ç†</h5><p>éš”ç¦»å¤„ç†ï¼šå°†é”™è¯¯éš”ç¦»åœ¨å¯æ§çš„èŒƒå›´ä¹‹å†…ï¼Œä¸è¦è®©å…¶å½±å“åˆ°å…¶ä»–çš„ç¨‹åºçš„è¿è¡Œã€‚</p><p>è¿™ç§è®¾è®¡æ€æƒ³ï¼Œæ¥æºäºèˆ¹èˆ±çš„è®¾è®¡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624203222353-16882902699932.png" alt="image-20230624203222353" tabindex="0" loading="lazy"><figcaption>image-20230624203222353</figcaption></figure><p>èˆ¹èˆ±éƒ½ä¼šè¢«éš”æ¿åˆ†ç¦»ä¸ºå¤šä¸ªç‹¬ç«‹ç©ºé—´ï¼Œå½“èˆ¹ä½“ç ´æŸæ—¶ï¼Œåªä¼šå¯¼è‡´éƒ¨åˆ†ç©ºé—´è¿›å…¥ï¼Œå°†æ•…éšœæ§åˆ¶åœ¨ä¸€å®šèŒƒå›´å†…ï¼Œé¿å…æ•´ä¸ªèˆ¹ä½“éƒ½è¢«æ·¹æ²¡ã€‚äºæ­¤ç±»ä¼¼ï¼Œæˆ‘ä»¬ä¸šåŠ¡ç³»ç»Ÿä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ç§æ€æƒ³æ¥é˜²æ­¢å‡ºç°é›ªå´©æ•ˆåº”ï¼Œå¸¸è§çš„éš”ç¦»æ–¹å¼ï¼šçº¿ç¨‹éš”ç¦»</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624203256590-16882902699944.png" alt="image-20230624203256590" tabindex="0" loading="lazy"><figcaption>image-20230624203256590</figcaption></figure><h5 id="ç†”æ–­å¤„ç†" tabindex="-1"><a class="header-anchor" href="#ç†”æ–­å¤„ç†" aria-hidden="true">#</a> ç†”æ–­å¤„ç†</h5><p>ç±»ä¼¼äºä¿é™©ä¸,ç”µå‹è¿‡é«˜ä¼šè¿›è¡Œç†”æ–­.ç†”æ–­æ˜¯åœ¨<strong>é™çº§çš„åŸºç¡€ä¹‹ä¸Šå‘ç”Ÿ</strong>çš„.</p><p>ç†”æ–­å¤„ç†ï¼šç”±<strong>æ–­è·¯å™¨</strong>ç»Ÿè®¡ä¸šåŠ¡æ‰§è¡Œçš„å¼‚å¸¸æ¯”ä¾‹ï¼Œå¦‚æœè¶…å‡ºé˜ˆå€¼åˆ™ä¼š<strong>ç†”æ–­</strong>è¯¥ä¸šåŠ¡ï¼Œæ‹¦æˆªè®¿é—®è¯¥ä¸šåŠ¡çš„ä¸€åˆ‡è¯·æ±‚ã€‚</p><p>æ–­è·¯å™¨ä¼šç»Ÿè®¡è®¿é—®æŸä¸ªæœåŠ¡çš„è¯·æ±‚æ•°é‡ï¼Œå¼‚å¸¸æ¯”ä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>ç†”æ–­æ˜¯åœ¨é™çº§çš„åŸºç¡€ä¸Šå‘ç”Ÿçš„</p><p>â­è®¾ç½®è¿œç¨‹è°ƒç”¨çš„è¶…æ—¶æ—¶é—´.å¦‚æœåªåšé™çº§å¤„ç†,éƒ½åªä¼šå‘é€å…œåº•æ•°æ®,æˆ‘ä»¬éœ€è¦åšç†”æ–­æ“ä½œ,1è°ƒç”¨2,å¤šæ¬¡è°ƒç”¨éƒ½æ˜¯å¤±è´¥,ä¸å†è°ƒç”¨æ‰§è¡Œç†”æ–­,1è°ƒç”¨2ç›´æ¥è¿”å›å…œåº•æ•°æ®.</p><p><strong>åˆ¶å®šä¸€ä¸ªè§„åˆ™</strong>,åæ¬¡è°ƒç”¨ä¸­æœ‰äº”æ¬¡æ˜¯è°ƒç”¨å¤±è´¥,æˆ‘ä»¬å°±ä¼šæ‰§è¡Œç†”æ–­</p><p>ç‰¹ç‚¹:æé«˜å¾ˆé«˜çš„æ•°æ®,ç†”æ–­ä¸å¯ä»¥æ— é™,ç†”æ–­éœ€è¦è®¾ç½®æ—¶é•¿,ç†”æ–­äº”ç§’,è¶…è¿‡äº”ç§’ä¹‹å,ä¼šç»§ç»­è¿›è¡Œè®¿é—®.è¿™å°±æ˜¯ç†”æ–­çš„æœºåˆ¶.</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624203334370-16882902699945.png" alt="image-20230624203334370" tabindex="0" loading="lazy"><figcaption>image-20230624203334370</figcaption></figure><p>è¯·æ±‚äº†ä¸‰æ¬¡ï¼Œä¸¤æ¬¡å‡ºç°å¼‚å¸¸ï¼Œä¸€æ¬¡æˆåŠŸã€‚å½“å‘ç°è®¿é—®æœåŠ¡Dçš„è¯·æ±‚å¼‚å¸¸æ¯”ä¾‹è¿‡é«˜æ—¶ï¼Œè®¤ä¸ºæœåŠ¡Dæœ‰å¯¼è‡´é›ªå´©çš„é£é™©ï¼Œä¼šæ‹¦æˆªè®¿é—®æœåŠ¡Dçš„ä¸€åˆ‡è¯·æ±‚ï¼Œå½¢æˆç†”æ–­ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624203409785-16882902699946.png" alt="image-20230624203409785" tabindex="0" loading="lazy"><figcaption>image-20230624203409785</figcaption></figure><p>è§¦å‘ç†”æ–­äº†ä»¥åï¼Œå½“åœ¨è®¿é—®æœåŠ¡Açš„æ—¶å€™ï¼Œå°±ä¸ä¼šåœ¨é€šè¿‡æœåŠ¡Aå»è®¿é—®æœåŠ¡Däº†ï¼Œç«‹é©¬ç»™ç”¨æˆ·è¿›è¡Œè¿”å›ï¼Œè¿”å›çš„æ˜¯ä¸€ç§é»˜è®¤å€¼ï¼Œè¿™ç§è¿”å›å°±æ˜¯ä¸€ç§å…œåº•æ–¹æ¡ˆã€‚è¿™ç§å…œåº•æ–¹æ¡ˆä¹Ÿå°†å…¶ç§°ä¹‹ä¸ºé™çº§é€»è¾‘ã€‚</p><h5 id="æµé‡æ§åˆ¶" tabindex="-1"><a class="header-anchor" href="#æµé‡æ§åˆ¶" aria-hidden="true">#</a> æµé‡æ§åˆ¶</h5><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231027153224912.png" alt="æµé‡æ§åˆ¶åŸç†å›¾" tabindex="0" loading="lazy"><figcaption>æµé‡æ§åˆ¶åŸç†å›¾</figcaption></figure><p>æµé‡æ§åˆ¶ï¼šé™åˆ¶ä¸šåŠ¡è®¿é—®çš„QPS(æ¯ç§’çš„è¯·æ±‚æ•°)ï¼Œé¿å…æœåŠ¡å› æµé‡çš„çªå¢è€Œæ•…éšœã€‚</p><p>è®¾ç½®ç­‰å¾…æ—¶é—´,æ—¶é—´è¿‡äº†å°±ä¼šè¿”å›å…œåº•ä¿¡æ¯.</p><p>æœåŠ¡å™¨åœ¨å‹åŠ›è¿‡å¤§çš„æƒ…å†µä¸‹ä¼šå‘ç”Ÿå®•æœº,æ‰€ä»¥æˆ‘ä»¬å¯¹æµé‡è¿›è¡Œæ§åˆ¶</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624203508014-16882902699947.png" alt="image-20230624203508014" tabindex="0" loading="lazy"><figcaption>image-20230624203508014</figcaption></figure><p>é™æµæ˜¯ä¸€ç§<strong>é¢„é˜²</strong>æªæ–½ï¼Œé¿å…å› ç¬é—´é«˜å¹¶å‘æµé‡è€Œå¯¼è‡´æœåŠ¡æ•…éšœï¼Œè¿›è€Œé¿å…é›ªå´©ã€‚å…¶ä»–çš„å¤„ç†æ–¹å¼æ˜¯ä¸€ç§<strong>è¡¥æ•‘</strong>æªæ–½ï¼Œåœ¨éƒ¨åˆ†æœåŠ¡æ•…éšœæ—¶ï¼Œå°†æ•…éšœæ§åˆ¶åœ¨ä¸€å®šèŒƒå›´ï¼Œé¿å…é›ªå´©ã€‚</p><h5 id="æœ€ç»ˆçš„ç›®çš„" tabindex="-1"><a class="header-anchor" href="#æœ€ç»ˆçš„ç›®çš„" aria-hidden="true">#</a> æœ€ç»ˆçš„ç›®çš„</h5><p>ä¿æŠ¤æœåŠ¡å™¨,é˜²æ­¢å®•æœº</p><h5 id="qps-query-per-seconds" tabindex="-1"><a class="header-anchor" href="#qps-query-per-seconds" aria-hidden="true">#</a> QPS:query per seconds</h5><p>æœåŠ¡å™¨æ¯ç§’èƒ½å¤„ç†çš„è¯·æ±‚æ•°é‡,è¡¡é‡æœåŠ¡å™¨çš„ååé‡</p><h5 id="é˜ˆå€¼" tabindex="-1"><a class="header-anchor" href="#é˜ˆå€¼" aria-hidden="true">#</a> é˜ˆå€¼</h5><p>ä¸´ç•Œå€¼,æ¯”å¦‚æœåŠ¡å™¨çš„qpsæ˜¯5,æ¯ç§’å¤„ç†5ä¸ªè¯·æ±‚,è¿™ä¸ªå°±å«åšé˜ˆå€¼.</p><h4 id="_8-1-3-sentinelä»‹ç»" tabindex="-1"><a class="header-anchor" href="#_8-1-3-sentinelä»‹ç»" aria-hidden="true">#</a> 8.1.3 sentinelä»‹ç»</h4><p>â­:åˆ†ä¸ºä¸¤éƒ¨åˆ†:</p><ul><li>ç¬¬ä¸€éƒ¨åˆ†:æ ¸å¿ƒåº“(javaå®¢æˆ·ç«¯)ä½¿ç”¨javaä»£ç èƒ½å®ç°sentinelä½¿ç”¨</li><li>ç¬¬äºŒéƒ¨åˆ†:æ§åˆ¶å°,å›¾å½¢åŒ–ç•Œé¢,é€šè¿‡ç•Œé¢é…ç½®sentinelçš„æ§åˆ¶</li></ul><p>å®˜ç½‘åœ°å€ï¼š<a href="https://sentinelguard.io/zh-cn/" target="_blank" rel="noopener noreferrer">https://sentinelguard.io/zh-cn/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>éšç€å¾®æœåŠ¡çš„æµè¡Œï¼ŒæœåŠ¡å’ŒæœåŠ¡ä¹‹é—´çš„ç¨³å®šæ€§å˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚Sentinel ä»¥æµé‡ä¸ºåˆ‡å…¥ç‚¹ï¼Œä»æµé‡æ§åˆ¶ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿè´Ÿè½½ä¿æŠ¤ç­‰å¤šä¸ªç»´åº¦ä¿æŠ¤æœåŠ¡çš„ç¨³å®šæ€§ã€‚</p><ul><li>Sentinel çš„å†å²ï¼š</li></ul><p>- 2012 å¹´ï¼ŒSentinel è¯ç”Ÿï¼Œä¸»è¦åŠŸèƒ½ä¸ºå…¥å£æµé‡æ§åˆ¶ã€‚</p><p>- 2013-2017 å¹´ï¼ŒSentinel åœ¨é˜¿é‡Œå·´å·´é›†å›¢å†…éƒ¨è¿…é€Ÿå‘å±•ï¼Œæˆä¸ºåŸºç¡€æŠ€æœ¯æ¨¡å—ï¼Œè¦†ç›–äº†æ‰€æœ‰çš„æ ¸å¿ƒåœºæ™¯ã€‚Sentinel ä¹Ÿå› æ­¤ç§¯ç´¯äº†å¤§é‡çš„æµé‡å½’æ•´åœºæ™¯ä»¥åŠç”Ÿäº§å®è·µã€‚</p><p>- 2018 å¹´ï¼ŒSentinel å¼€æºï¼Œå¹¶æŒç»­æ¼”è¿›ã€‚</p><p>- 2019 å¹´ï¼ŒSentinel æœç€å¤šè¯­è¨€æ‰©å±•çš„æ–¹å‘ä¸æ–­æ¢ç´¢ï¼Œæ¨å‡º C++ åŸç”Ÿç‰ˆæœ¬ï¼ŒåŒæ—¶é’ˆå¯¹ Service Mesh åœºæ™¯ä¹Ÿæ¨å‡ºäº† Envoy é›†ç¾¤æµé‡æ§åˆ¶æ”¯æŒï¼Œä»¥è§£å†³ Service Mesh æ¶æ„ä¸‹å¤šè¯­è¨€é™æµçš„é—®é¢˜ã€‚</p><p>- 2020 å¹´ï¼Œæ¨å‡º Sentinel Go ç‰ˆæœ¬ï¼Œç»§ç»­æœç€äº‘åŸç”Ÿæ–¹å‘æ¼”è¿›ã€‚</p><ul><li>Sentinel åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†:</li></ul><p>- æ ¸å¿ƒåº“ï¼ˆJava å®¢æˆ·ç«¯ï¼‰ä¸ä¾èµ–ä»»ä½•æ¡†æ¶/åº“ï¼Œèƒ½å¤Ÿè¿è¡Œäºæ‰€æœ‰ Java è¿è¡Œæ—¶ç¯å¢ƒï¼ŒåŒæ—¶å¯¹ Dubbo / Spring Cloud ç­‰æ¡†æ¶ä¹Ÿæœ‰è¾ƒå¥½çš„æ”¯æŒã€‚</p><p>- æ§åˆ¶å°ï¼ˆDashboardï¼‰åŸºäº Spring Boot å¼€å‘ï¼Œæ‰“åŒ…åå¯ä»¥ç›´æ¥è¿è¡Œï¼Œä¸éœ€è¦é¢å¤–çš„ Tomcat ç­‰åº”ç”¨å®¹å™¨ã€‚</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624203655208-16882902699948.png" alt="image-20230624203655208" tabindex="0" loading="lazy"><figcaption>image-20230624203655208</figcaption></figure><p>å…·æœ‰çš„ç‰¹å¾:</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624203730680-16882902699949.png" alt="image-20230624203730680" tabindex="0" loading="lazy"><figcaption>image-20230624203730680</figcaption></figure><h3 id="_8-2-sentinelå…¥é—¨" tabindex="-1"><a class="header-anchor" href="#_8-2-sentinelå…¥é—¨" aria-hidden="true">#</a> 8.2 sentinelå…¥é—¨</h3><h4 id="_8-2-1-ä¸‹è½½sentinelæ§åˆ¶å°" tabindex="-1"><a class="header-anchor" href="#_8-2-1-ä¸‹è½½sentinelæ§åˆ¶å°" aria-hidden="true">#</a> 8.2.1 ä¸‹è½½sentinelæ§åˆ¶å°</h4><p>sentinelç®¡ç†åå°ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/alibaba/Sentinel/releases" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/Sentinel/releases<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624215112184-168829026999410.png" alt="image-20230624215112184" tabindex="0" loading="lazy"><figcaption>image-20230624215112184</figcaption></figure><p>ä¸‹è½½å®Œæ¯•ä»¥åå°±ä¼šå¾—åˆ°ä¸€ä¸ªjaråŒ…</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624215403344-168829026999411.png" alt="image-20230624215403344" tabindex="0" loading="lazy"><figcaption>image-20230624215403344</figcaption></figure><h4 id="_8-2-2-å¯åŠ¨sentinel" tabindex="-1"><a class="header-anchor" href="#_8-2-2-å¯åŠ¨sentinel" aria-hidden="true">#</a> 8.2.2 å¯åŠ¨sentinel</h4><ul><li>å°†jaråŒ…æ”¾åˆ°ä»»æ„éä¸­æ–‡ç›®å½•ï¼Œæ‰§è¡Œå‘½ä»¤ï¼š</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">java</span> <span class="token parameter variable">-jar</span> sentinel-dashboard-2.0.0-alpha-preview.jar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>å¦‚æœè¦ä¿®æ”¹Sentinelçš„é»˜è®¤ç«¯å£ã€è´¦æˆ·ã€å¯†ç ï¼Œå¯ä»¥é€šè¿‡ä¸‹åˆ—é…ç½®ï¼š</li></ul><table><thead><tr><th><strong>é…ç½®é¡¹</strong></th><th><strong>é»˜è®¤å€¼</strong></th><th><strong>è¯´æ˜</strong></th></tr></thead><tbody><tr><td>server.port</td><td>8080</td><td>æœåŠ¡ç«¯å£</td></tr><tr><td>sentinel.dashboard.auth.username</td><td>sentinel</td><td>é»˜è®¤ç”¨æˆ·å</td></tr><tr><td>sentinel.dashboard.auth.password</td><td>sentinel</td><td>é»˜è®¤å¯†ç </td></tr></tbody></table><ul><li>ä¾‹å¦‚ï¼Œä¿®æ”¹ç«¯å£ï¼š</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">java</span> <span class="token parameter variable">-Dserver.port</span><span class="token operator">=</span><span class="token number">8090</span> <span class="token parameter variable">-jar</span> sentinel-dashboard-2.0.0-alpha-preview.jar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_8-2-3-è®¿é—®sentinel" tabindex="-1"><a class="header-anchor" href="#_8-2-3-è®¿é—®sentinel" aria-hidden="true">#</a> 8.2.3 è®¿é—®sentinel</h4><p>è®¿é—®http://localhost:8080é¡µé¢ï¼Œå°±å¯ä»¥çœ‹åˆ°sentinelçš„æ§åˆ¶å°äº†ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624215635555-168829026999412.png" alt="image-20230624215635555" tabindex="0" loading="lazy"><figcaption>image-20230624215635555</figcaption></figure><p>éœ€è¦è¾“å…¥è´¦å·å’Œå¯†ç ï¼Œé»˜è®¤éƒ½æ˜¯ï¼šsentinel</p><p>ç™»å½•åï¼Œå‘ç°ä¸€ç‰‡ç©ºç™½ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ï¼šå› ä¸ºè¿˜æ²¡æœ‰ç›‘æ§ä»»ä½•æœåŠ¡ã€‚å¦å¤–ï¼Œsentinelæ˜¯æ‡’åŠ è½½çš„ï¼Œå¦‚æœæœåŠ¡æ²¡æœ‰è®¿é—®ï¼Œçœ‹ä¸åˆ°è¯¥æœåŠ¡ä¿¡æ¯ã€‚</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624215704921-168829026999413.png" alt="image-20230624215704921" tabindex="0" loading="lazy"><figcaption>image-20230624215704921</figcaption></figure><h4 id="_8-2-4-æ•´åˆsentinel" tabindex="-1"><a class="header-anchor" href="#_8-2-4-æ•´åˆsentinel" aria-hidden="true">#</a> 8.2.4 æ•´åˆsentinel</h4><p>æˆ‘ä»¬åœ¨spzx-cloud-userä¸­æ•´åˆsentinelï¼Œå¹¶è¿æ¥sentinelçš„æ§åˆ¶å°ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><p>1ã€å¼•å…¥sentinelä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--sentinel--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span> 
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-sentinel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2ã€é…ç½®æ§åˆ¶å°</p><p>ä¿®æ”¹application.yamlæ–‡ä»¶ï¼Œæ·»åŠ ä¸‹é¢å†…å®¹</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">sentinel</span><span class="token punctuation">:</span>
      <span class="token key atrule">transport</span><span class="token punctuation">:</span>
        <span class="token key atrule">dashboard</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8080</span>  <span class="token comment"># é…ç½®sentinelæ§åˆ¶å°åœ°å€</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3ã€è®¿é—®spzx-cloud-userçš„ä»»æ„æ¥å£</p><p>æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®<a href="http://localhost:10100/api/user/findUserByUserId/1%EF%BC%8C%E8%BF%99%E6%A0%B7%E6%89%8D%E8%83%BD%E8%A7%A6%E5%8F%91sentinel%E7%9A%84%E7%9B%91%E6%8E%A7%E3%80%82%E7%84%B6%E5%90%8E%E5%86%8D%E8%AE%BF%E9%97%AEsentinel%E7%9A%84%E6%8E%A7%E5%88%B6%E5%8F%B0%EF%BC%8C%E6%9F%A5%E7%9C%8B%E6%95%88%E6%9E%9C%EF%BC%9A" target="_blank" rel="noopener noreferrer">http://localhost:10100/api/user/findUserByUserId/1ï¼Œè¿™æ ·æ‰èƒ½è§¦å‘sentinelçš„ç›‘æ§ã€‚ç„¶åå†è®¿é—®sentinelçš„æ§åˆ¶å°ï¼ŒæŸ¥çœ‹æ•ˆæœï¼š<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624220303385-168829026999414.png" alt="image-20230624220303385" tabindex="0" loading="lazy"><figcaption>image-20230624220303385</figcaption></figure><h3 id="_8-3-æµé‡æ§åˆ¶" tabindex="-1"><a class="header-anchor" href="#_8-3-æµé‡æ§åˆ¶" aria-hidden="true">#</a> 8.3 æµé‡æ§åˆ¶</h3><p>é›ªå´©é—®é¢˜è™½ç„¶æœ‰å››ç§æ–¹æ¡ˆï¼Œä½†æ˜¯é™æµæ˜¯é¿å…æœåŠ¡å› çªå‘çš„æµé‡è€Œå‘ç”Ÿæ•…éšœï¼Œæ˜¯å¯¹å¾®æœåŠ¡é›ªå´©é—®é¢˜çš„é¢„é˜²ã€‚æˆ‘ä»¬å…ˆå­¦ä¹ è¿™ç§æ¨¡å¼ã€‚</p><h4 id="_8-3-1-ç›¸å…³æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#_8-3-1-ç›¸å…³æ¦‚å¿µ" aria-hidden="true">#</a> 8.3.1 ç›¸å…³æ¦‚å¿µ</h4><p><strong>ç°‡ç‚¹é“¾è·¯</strong>ï¼šå½“è¯·æ±‚è¿›å…¥å¾®æœåŠ¡æ—¶ï¼Œé¦–å…ˆä¼šè®¿é—®DispatcherServletï¼Œç„¶åè¿›å…¥Controllerã€Serviceã€Mapperï¼Œè¿™æ ·çš„ä¸€ä¸ªè°ƒç”¨é“¾å°±å«åšç°‡ç‚¹é“¾è·¯ã€‚</p><p><strong>èµ„æº</strong>ï¼šç°‡ç‚¹é“¾è·¯ä¸­è¢«ç›‘æ§çš„æ¯ä¸€ä¸ªæ¥å£å°±æ˜¯ä¸€ä¸ªèµ„æºï¼Œæµæ§ã€ç†”æ–­ç­‰éƒ½æ˜¯é’ˆå¯¹ç°‡ç‚¹é“¾è·¯ä¸­çš„èµ„æºæ¥è®¾ç½®çš„ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹sentinelä¼šç›‘æ§spring mvcçš„æ¯ä¸€ä¸ªç«¯ç‚¹ï¼ˆEndpointï¼Œä¹Ÿå°±æ˜¯controllerä¸­çš„æ–¹æ³•ï¼‰ï¼Œå› æ­¤spring mvcçš„æ¯ä¸€ä¸ªç«¯ç‚¹å°±æ˜¯è°ƒç”¨é“¾è·¯ä¸­çš„ä¸€ä¸ªèµ„æºã€‚</p><p userId="">ä¾‹å¦‚ï¼Œæˆ‘ä»¬åˆšæ‰è®¿é—®çš„spzx-cloud-userä¸­çš„UserControllerä¸­çš„ç«¯ç‚¹ï¼š/api/user/findUserByUserId/</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230624220603571-168829026999415.png" alt="image-20230624220603571" tabindex="0" loading="lazy"><figcaption>image-20230624220603571</figcaption></figure><p>æˆ‘ä»¬å¯ä»¥ç‚¹å‡»å¯¹åº”èµ„æºåé¢çš„æŒ‰é’®æ¥è®¾ç½®è§„åˆ™ï¼š</p><p>1ã€æµæ§ï¼šæµé‡æ§åˆ¶</p><p>2ã€é™çº§ï¼šé™çº§ç†”æ–­</p><p>3ã€çƒ­ç‚¹ï¼šçƒ­ç‚¹å‚æ•°é™æµï¼Œæ˜¯é™æµçš„ä¸€ç§</p><p>4ã€æˆæƒï¼šè¯·æ±‚çš„æƒé™æ§åˆ¶</p><h4 id="_8-3-2-å¿«é€Ÿå…¥é—¨" tabindex="-1"><a class="header-anchor" href="#_8-3-2-å¿«é€Ÿå…¥é—¨" aria-hidden="true">#</a> 8.3.2 å¿«é€Ÿå…¥é—¨</h4><p>éœ€æ±‚ï¼šç»™ /api/user/findUserByUserId/{userId}è¿™ä¸ªèµ„æºè®¾ç½®æµæ§è§„åˆ™ï¼ŒQPSä¸èƒ½è¶…è¿‡ 5ï¼Œç„¶åæµ‹è¯•ã€‚</p><p>æ­¥éª¤ï¼š</p><p>1ã€é¦–å…ˆåœ¨sentinelæ§åˆ¶å°æ·»åŠ é™æµè§„åˆ™</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628090407483-168829026999416.png" alt="image-20230628090407483" tabindex="0" loading="lazy"><figcaption>image-20230628090407483</figcaption></figure><p>2ã€åˆ©ç”¨jmeteræµ‹è¯•(æ¨¡æ‹Ÿå¹¶å‘è¯·æ±‚)</p><blockquote><p>Apache JMeter æ˜¯ Apache ç»„ç»‡åŸºäº Java å¼€å‘çš„å‹åŠ›æµ‹è¯•å·¥å…·ï¼Œç”¨äºå¯¹è½¯ä»¶åš<strong>å‹åŠ›æµ‹è¯•</strong>ã€‚</p><p>ä¸‹è½½åœ°å€ï¼š<a href="https://archive.apache.org/dist/jmeter/binaries/" target="_blank" rel="noopener noreferrer">https://archive.apache.org/dist/jmeter/binaries/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><p>è¯¾å‰èµ„æ–™æä¾›äº†ç¼–å†™å¥½çš„Jmeteræµ‹è¯•æ ·ä¾‹</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628115300889-168829026999417.png" alt="image-20230628115300889" tabindex="0" loading="lazy"><figcaption>image-20230628115300889</figcaption></figure><p>é€šè¿‡å¦‚ä¸‹å‘½ä»¤æ‰“å¼€jmeter</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">java</span> <span class="token parameter variable">-jar</span> ApacheJMeter.jar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¯¼å…¥è¯¾å‰èµ„æ–™æä¾›çš„æµ‹è¯•æ ·ä¾‹</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20220320111824238-168829026999418.png" alt="image-20220320111824238" tabindex="0" loading="lazy"><figcaption>image-20220320111824238</figcaption></figure><p>é€‰æ‹©æµæ§å…¥é—¨</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20220320111955904-168829026999419.png" alt="image-20220320111955904" tabindex="0" loading="lazy"><figcaption>image-20220320111955904</figcaption></figure><p>10ä¸ªçº¿ç¨‹ï¼Œ1ç§’å†…è¿è¡Œå®Œï¼ŒQPSæ˜¯10ï¼Œè¶…è¿‡äº†5ã€‚</p><p>é€‰ä¸­<strong>æµæ§å…¥é—¨ï¼ŒQPS&lt;5</strong>å³é”®è¿è¡Œ</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20220320112040803-168829026999420.png" alt="image-20220320112040803" tabindex="0" loading="lazy"><figcaption>image-20220320112040803</figcaption></figure><p>æ³¨æ„ï¼šä¸è¦ç‚¹å‡»èœå•ä¸­çš„æ‰§è¡ŒæŒ‰é’®æ¥è¿è¡Œã€‚</p><p>ç‚¹å‡»æŸ¥çœ‹ç»“æœæ ‘ï¼Œç†æƒ³çš„è¯·æ±‚æ‰§è¡Œç»“æœåº”è¯¥å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20220320112142379-168829026999421.png" alt="image-20220320112142379" tabindex="0" loading="lazy"><figcaption>image-20220320112142379</figcaption></figure><p>å¯ä»¥çœ‹åˆ°ï¼ŒæˆåŠŸçš„è¯·æ±‚æ¯æ¬¡åªæœ‰5ä¸ªã€‚</p><p><strong>æ³¨æ„ï¼šå¦‚æœæµ‹è¯•ç»“æœä¸æ˜¯ä¸Šè¿°æƒ…å†µï¼Œé‚£æ˜¯å› ä¸ºsentinelåœ¨ç»Ÿè®¡è¯·æ±‚çš„æ—¶å€™ï¼ŒæŠŠä¸€éƒ¨åˆ†çš„è¯·æ±‚ç»Ÿè®¡åˆ°äº†ä¸‹ä¸€ç§’ä¸­å¯¼è‡´çš„ã€‚</strong></p><h4 id="_8-3-3-æµæ§æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#_8-3-3-æµæ§æ¨¡å¼" aria-hidden="true">#</a> 8.3.3 æµæ§æ¨¡å¼</h4><h5 id="æµæ§æ¨¡å¼ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#æµæ§æ¨¡å¼ç®€ä»‹" aria-hidden="true">#</a> æµæ§æ¨¡å¼ç®€ä»‹</h5><p>åœ¨æ·»åŠ é™æµè§„åˆ™æ—¶ï¼Œç‚¹å‡»é«˜çº§é€‰é¡¹ï¼Œå¯ä»¥é€‰æ‹©ä¸‰ç§<strong>æµæ§æ¨¡å¼</strong>ï¼š</p><p>1ã€ç›´æ¥ï¼šç»Ÿè®¡å½“å‰èµ„æºçš„è¯·æ±‚ï¼Œè§¦å‘é˜ˆå€¼æ—¶<strong>å¯¹å½“å‰èµ„æºç›´æ¥é™æµï¼Œä¹Ÿæ˜¯é»˜è®¤çš„æ¨¡å¼</strong></p><p>2ã€å…³è”ï¼šç»Ÿè®¡ä¸å½“å‰èµ„æºç›¸å…³çš„å¦ä¸€ä¸ªèµ„æºï¼Œè§¦å‘é˜ˆå€¼æ—¶ï¼Œå¯¹å½“å‰èµ„æºé™æµ</p><p>3ã€é“¾è·¯ï¼šç»Ÿè®¡ä»æŒ‡å®šé“¾è·¯è®¿é—®åˆ°æœ¬èµ„æºçš„è¯·æ±‚ï¼Œè§¦å‘é˜ˆå€¼æ—¶ï¼Œå¯¹æŒ‡å®šé“¾è·¯é™æµ</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231028091242707.png" alt="ç†è§£" tabindex="0" loading="lazy"><figcaption>ç†è§£</figcaption></figure><p>å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628091856122-168829026999422.png" alt="image-20230628091856122" tabindex="0" loading="lazy"><figcaption>image-20230628091856122</figcaption></figure><p>å¿«é€Ÿå…¥é—¨æµ‹è¯•çš„å°±æ˜¯ç›´æ¥æ¨¡å¼ã€‚</p><h5 id="å…³è”æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#å…³è”æ¨¡å¼" aria-hidden="true">#</a> å…³è”æ¨¡å¼</h5><p>Aå…³è”B,è®¾ç½®é˜ˆå€¼1,è®¿é—®Bæ—¶å€™è¶…è¿‡é˜ˆå€¼,Bä¸é™æµ,å¯¹Aè¿›è¡Œé™æµ</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231027163806970.png" alt="image-20231027163806970" tabindex="0" loading="lazy"><figcaption>image-20231027163806970</figcaption></figure><p>å…³è”æ¨¡å¼ï¼šç»Ÿè®¡ä¸å½“å‰èµ„æºç›¸å…³çš„å¦ä¸€ä¸ªèµ„æºï¼Œè§¦å‘é˜ˆå€¼æ—¶ï¼Œå¯¹å½“å‰èµ„æºé™æµ</p><p>é…ç½®æ–¹å¼ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628092034118-168829026999423.png" alt="image-20230628092034118" tabindex="0" loading="lazy"><figcaption>image-20230628092034118</figcaption></figure><p>**è¯­æ³•è¯´æ˜ï¼š**å¯¹/api/user/updateUserByIdèµ„æºçš„è¯·æ±‚è¿›è¡Œç»Ÿè®¡ï¼Œå½“è®¿é—®æµé‡è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œå°±å¯¹/api/user/findUserByUserId/{userId}è¿›è¡Œé™æµï¼Œé¿å…å½±å“/api/user/updateUserByIdèµ„æºã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼šæ¯”å¦‚ç”¨æˆ·æ”¯ä»˜æ—¶éœ€è¦ä¿®æ”¹è®¢å•çŠ¶æ€ï¼ŒåŒæ—¶ç”¨æˆ·è¦æŸ¥è¯¢è®¢å•ã€‚æŸ¥è¯¢å’Œä¿®æ”¹æ“ä½œä¼šäº‰æŠ¢æ•°æ®åº“é”ï¼Œäº§ç”Ÿç«äº‰ã€‚ä¸šåŠ¡éœ€æ±‚æ˜¯ä¼˜å…ˆæ”¯ä»˜å’Œæ›´æ–°è®¢å•çš„ä¸šåŠ¡ï¼Œå› æ­¤å½“ä¿®æ”¹è®¢å•ä¸šåŠ¡è§¦å‘é˜ˆå€¼æ—¶ï¼Œéœ€è¦å¯¹æŸ¥è¯¢è®¢å•ä¸šåŠ¡é™æµã€‚</p><p>æ¡ˆä¾‹å®ç°ï¼š</p><p>1ã€åœ¨UserControlleræ–°å»ºä¸€ä¸ªç«¯ç‚¹ï¼š/api/user/updateUserByIdï¼Œæ— éœ€å®ç°ä¸šåŠ¡</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// ä¿®æ”¹ç”¨æˆ·æ•°æ®ç«¯ç‚¹</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/updateUserById&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">updateUserById</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;ä¿®æ”¹ç”¨æˆ·æ•°æ®æˆåŠŸ&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2ã€é‡å¯æœåŠ¡ï¼Œè®¿é—®å¯¹åº”çš„ç«¯ç‚¹ï¼Œè®©å…¶äº§ç”Ÿç°‡ç‚¹é“¾è·¯</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628092515666-168829026999424.png" alt="image-20230628092515666" tabindex="0" loading="lazy"><figcaption>image-20230628092515666</figcaption></figure><p>3ã€é…ç½®æµæ§è§„åˆ™ï¼Œå½“/api/user/updateUserByIdèµ„æºè¢«è®¿é—®çš„QPSè¶…è¿‡5æ—¶ï¼Œå¯¹/api/user/findUserByUserId/1è¯·æ±‚é™æµã€‚å¯¹å“ªä¸ªç«¯ç‚¹é™æµï¼Œå°±ç‚¹å‡»å“ªä¸ªç«¯ç‚¹åé¢çš„æŒ‰é’®ã€‚æˆ‘ä»¬æ˜¯å¯¹ç”¨æˆ·æŸ¥è¯¢/api/user/findUserByUserId/1é™æµï¼Œå› æ­¤ç‚¹å‡»å®ƒåé¢çš„æŒ‰é’®ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628092751648-168829026999425.png" alt="image-20230628092751648" tabindex="0" loading="lazy"><figcaption>image-20230628092751648</figcaption></figure><p>4ã€åœ¨Jmeterä¸­è¿›è¡Œæµ‹è¯•</p><p>é€‰æ‹©ã€Šæµæ§æ¨¡å¼-å…³è”ã€‹ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20220320114459422-168829026999426.png" alt="image-20220320114459422" tabindex="0" loading="lazy"><figcaption>image-20220320114459422</figcaption></figure><p>å¯ä»¥çœ‹åˆ°1000ä¸ªçº¿ç¨‹ï¼Œ100ç§’ï¼Œå› æ­¤QPSä¸º10ï¼Œè¶…è¿‡äº†æˆ‘ä»¬è®¾å®šçš„é˜ˆå€¼ï¼š5</p><p>æŸ¥çœ‹httpè¯·æ±‚ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628093126793-168829026999427.png" alt="image-20230628093126793" tabindex="0" loading="lazy"><figcaption>image-20230628093126793</figcaption></figure><p>è¯·æ±‚çš„ç›®æ ‡æ˜¯/api/user/updateUserByIdï¼Œè¿™æ ·è¿™ä¸ªç«¯ç‚¹å°±ä¼šè§¦å‘é˜ˆå€¼ã€‚ä½†é™æµçš„ç›®æ ‡æ˜¯/api/user/findUserByUserId/1ï¼Œæˆ‘ä»¬åœ¨æµè§ˆå™¨è®¿é—®ï¼Œå¯ä»¥å‘ç°ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628093300378-168829026999428.png" alt="image-20230628093300378" tabindex="0" loading="lazy"><figcaption>image-20230628093300378</figcaption></figure><p>ç¡®å®è¢«é™æµäº†ã€‚</p><p>å…³è”æµæ§æ¨¡å¼çš„ä½¿ç”¨åœºæ™¯ï¼š</p><p>1ã€ä¸¤ä¸ªæœ‰ç«äº‰å…³ç³»çš„èµ„æº</p><p>2ã€ä¸€ä¸ªä¼˜å…ˆçº§è¾ƒé«˜ï¼Œä¸€ä¸ªä¼˜å…ˆçº§è¾ƒä½</p><p>å¯¹é«˜ä¼˜å…ˆçº§çš„èµ„æºçš„æµé‡è¿›è¡Œç»Ÿè®¡ï¼Œå½“è¶…è¿‡é˜ˆå€¼å¯¹ä½ä¼˜å…ˆçº§çš„èµ„æºè¿›è¡Œé™æµã€‚</p><h5 id="é“¾è·¯æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#é“¾è·¯æ¨¡å¼" aria-hidden="true">#</a> é“¾è·¯æ¨¡å¼</h5><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231027163905542.png" alt="image-20231027163905542" tabindex="0" loading="lazy"><figcaption>image-20231027163905542</figcaption></figure><p>é“¾è·¯æ¨¡å¼ï¼šåªé’ˆå¯¹ä»æŒ‡å®šé“¾è·¯è®¿é—®åˆ°æœ¬èµ„æºçš„è¯·æ±‚åšç»Ÿè®¡ï¼Œåˆ¤æ–­æ˜¯å¦è¶…è¿‡é˜ˆå€¼ï¼Œå¦‚æœè¶…è¿‡é˜ˆå€¼å¯¹ä»è¯¥é“¾è·¯è¯·æ±‚è¿›è¡Œé™æµã€‚</p><p>é…ç½®æ–¹å¼ï¼š</p><p>1ã€/api/user/save --&gt; users</p><p>2ã€/api/user/query --&gt; users</p><p>å¦‚æœåªå¸Œæœ›ç»Ÿè®¡ä»/api/user/queryè¿›å…¥åˆ°usersçš„è¯·æ±‚ï¼Œå¹¶è¿›è¡Œé™æµæ“ä½œï¼Œåˆ™å¯ä»¥è¿™æ ·é…ç½®ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628095013326-168829026999429.png" alt="image-20230628095013326" tabindex="0" loading="lazy"><figcaption>image-20230628095013326</figcaption></figure><p>æ¡ˆä¾‹å®ç°ï¼š</p><p>1ã€åœ¨UserServiceä¸­æ·»åŠ ä¸€ä¸ªqueryUsersæ–¹æ³•ï¼Œä¸ç”¨å®ç°ä¸šåŠ¡</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">queryUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æŸ¥è¯¢ç”¨æˆ·&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2ã€åœ¨UserControllerä¸­ï¼Œæ·»åŠ ä¸¤ä¸ªç«¯ç‚¹ï¼Œåœ¨è¿™ä¸¤ä¸ªç«¯ç‚¹ä¸­åˆ†åˆ«è°ƒç”¨UserServiceä¸­çš„queryUsersæ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/save&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    userService<span class="token punctuation">.</span><span class="token function">queryUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ä¿å­˜ç”¨æˆ·&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;è®¢å•ä¿å­˜æˆåŠŸ&quot;</span> <span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/query&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    userService<span class="token punctuation">.</span><span class="token function">queryUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æŸ¥è¯¢ç”¨æˆ·&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;æŸ¥è¯¢ç”¨æˆ·æˆåŠŸ&quot;</span> <span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>4ã€é€šè¿‡**@SentinelResource**æ ‡è®°UserServiceä¸­çš„queryUsersæ–¹æ³•ä¸ºä¸€ä¸ªsentinelç›‘æ§çš„èµ„æº(é»˜è®¤æƒ…å†µä¸‹ï¼Œsentinelåªç›‘æ§controlleræ–¹æ³•)</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span><span class="token string">&quot;users&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">queryUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>err<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æŸ¥è¯¢ç”¨æˆ·&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>5ã€æ›´æ”¹application.ymlæ–‡ä»¶ä¸­çš„sentinelé…ç½®</p><p>é“¾è·¯æ¨¡å¼ä¸­ï¼Œæ˜¯å¯¹ä¸åŒæ¥æºçš„ä¸¤ä¸ªé“¾è·¯åšç›‘æ§ã€‚ä½†æ˜¯sentinelé»˜è®¤ä¼šç»™è¿›å…¥spring mvcçš„æ‰€æœ‰è¯·æ±‚è®¾ç½®åŒä¸€ä¸ªrootèµ„æºï¼Œä¼šå¯¼è‡´é“¾è·¯æ¨¡å¼å¤±æ•ˆã€‚å› æ­¤éœ€è¦å…³é—­è¿™ç§èµ„æºæ•´åˆã€‚</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">sentinel</span><span class="token punctuation">:</span>
      <span class="token key atrule">web-context-unify</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># å…³é—­contextæ•´åˆ</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>6ã€é‡å¯æœåŠ¡ï¼Œè®¿é—®/api/user/saveå’Œ/api/user/queryï¼Œå¯ä»¥æŸ¥çœ‹åˆ°sentinelçš„ç°‡ç‚¹é“¾è·¯è§„åˆ™ä¸­ï¼Œå‡ºç°äº†æ–°çš„èµ„æº</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628094306219-168829026999430.png" alt="image-20230628094306219" tabindex="0" loading="lazy"><figcaption>image-20230628094306219</figcaption></figure><p>7ã€æ·»åŠ æµæ§è§„åˆ™</p><p>ç‚¹å‡»usersèµ„æºåé¢çš„æµæ§æŒ‰é’®ï¼Œåœ¨å¼¹å‡ºçš„è¡¨å•ä¸­å¡«å†™ä¸‹é¢ä¿¡æ¯ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628094433574-168829026999431.png" alt="image-20230628094433574" tabindex="0" loading="lazy"><figcaption>image-20230628094433574</figcaption></figure><p>åªç»Ÿè®¡ä»/api/user/queryè¿›å…¥/usersçš„èµ„æºï¼ŒQPSé˜ˆå€¼ä¸º2ï¼Œè¶…å‡ºåˆ™è¢«é™æµã€‚</p><p>8ã€jmeteræµ‹è¯•</p><p>é€‰æ‹©ã€Šæµæ§æ¨¡å¼-é“¾è·¯ã€‹</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20220320150559229-168829026999432.png" alt="image-20220320150559229" tabindex="0" loading="lazy"><figcaption>image-20220320150559229</figcaption></figure><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œ200ä¸ªçº¿ç¨‹ï¼Œ50ç§’å†…å‘å®Œï¼ŒQPSä¸º4ï¼Œè¶…è¿‡äº†æˆ‘ä»¬è®¾å®šçš„é˜ˆå€¼2ã€‚</p><p>ä¸€ä¸ªhttpè¯·æ±‚æ˜¯è®¿é—®/api/user/save</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628094648097-168829026999433.png" alt="image-20230628094648097" tabindex="0" loading="lazy"><figcaption>image-20230628094648097</figcaption></figure><p>å¦ä¸€ä¸ªæ˜¯è®¿é—®/api/user/query</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628094713655-168829026999434.png" alt="image-20230628094713655" tabindex="0" loading="lazy"><figcaption>image-20230628094713655</figcaption></figure><p>è¿è¡Œæµ‹è¯•ï¼Œå¯Ÿçœ‹ç»“æœæ ‘ï¼š</p><p>è®¿é—®/api/user/save,æ²¡æœ‰è¿›è¡Œé™æµ</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628094814795-168829026999435.png" alt="image-20230628094814795" tabindex="0" loading="lazy"><figcaption>image-20230628094814795</figcaption></figure><p>è®¿é—®/api/user/query,è¿›è¡Œé™æµäº†</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628094857374-168829026999536.png" alt="image-20230628094857374" tabindex="0" loading="lazy"><figcaption>image-20230628094857374</figcaption></figure><h4 id="_8-3-4-æµæ§æ•ˆæœ" tabindex="-1"><a class="header-anchor" href="#_8-3-4-æµæ§æ•ˆæœ" aria-hidden="true">#</a> 8.3.4 æµæ§æ•ˆæœ</h4><p>åœ¨æµæ§çš„é«˜çº§é€‰é¡¹ä¸­ï¼Œè¿˜æœ‰ä¸€ä¸ªæµæ§æ•ˆæœé€‰é¡¹</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628095109686-168829026999537.png" alt="image-20230628095109686" tabindex="0" loading="lazy"><figcaption>image-20230628095109686</figcaption></figure><p>æµæ§æ•ˆæœæ˜¯æŒ‡è¯·æ±‚è¾¾åˆ°æµæ§é˜ˆå€¼æ—¶åº”è¯¥é‡‡å–çš„æªæ–½ï¼ŒåŒ…æ‹¬ä¸‰ç§ï¼š</p><p>1ã€å¿«é€Ÿå¤±è´¥ï¼šè¾¾åˆ°é˜ˆå€¼åï¼Œæ–°çš„è¯·æ±‚ä¼šè¢«ç«‹å³æ‹’ç»å¹¶æŠ›å‡ºFlowExceptionå¼‚å¸¸ï¼Œæ˜¯é»˜è®¤çš„å¤„ç†æ–¹å¼</p><p>2ã€warm upï¼šé¢„çƒ­æ¨¡å¼ï¼Œå¯¹è¶…å‡ºé˜ˆå€¼çš„è¯·æ±‚åŒæ ·æ˜¯æ‹’ç»å¹¶æŠ›å‡ºå¼‚å¸¸ï¼Œä½†è¿™ç§æ¨¡å¼é˜ˆå€¼ä¼šåŠ¨æ€å˜åŒ–ï¼Œä»ä¸€ä¸ªè¾ƒå°å€¼é€æ¸å¢åŠ åˆ°æœ€å¤§é˜ˆå€¼</p><p>3ã€æ’é˜Ÿç­‰å¾…ï¼šè®©æ‰€æœ‰çš„è¯·æ±‚æŒ‰ç…§å…ˆåæ¬¡åºè¿›å…¥åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­è¿›è¡Œæ’é˜Ÿï¼Œå½“æŸä¸€ä¸ªè¯·æ±‚æœ€å¤§çš„é¢„æœŸç­‰å¾…æ—¶é—´è¶…è¿‡äº†æ‰€è®¾å®šçš„è¶…æ—¶æ—¶é—´æ—¶åŒæ ·æ˜¯æ‹’ç»å¹¶æŠ›å‡ºå¼‚å¸¸</p><h5 id="warm-up" tabindex="-1"><a class="header-anchor" href="#warm-up" aria-hidden="true">#</a> warm up</h5><p>é˜ˆå€¼ä¸€èˆ¬æ˜¯ä¸€ä¸ªå¾®æœåŠ¡èƒ½æ‰¿æ‹…çš„æœ€å¤§QPSï¼Œä½†æ˜¯ä¸€ä¸ªæœåŠ¡åˆšåˆšå¯åŠ¨æ—¶ï¼Œä¸€åˆ‡èµ„æºå°šæœªåˆå§‹åŒ–ï¼ˆ<strong>å†·å¯åŠ¨</strong>ï¼‰ï¼Œå¦‚æœç›´æ¥å°†QPSè·‘åˆ°æœ€å¤§å€¼ï¼Œå¯èƒ½å¯¼è‡´æœåŠ¡ç¬é—´å®•æœºã€‚</p><p>warm upä¹Ÿå«<strong>é¢„çƒ­æ¨¡å¼</strong>ï¼Œæ˜¯åº”å¯¹æœåŠ¡å†·å¯åŠ¨çš„ä¸€ç§æ–¹æ¡ˆã€‚<strong>é˜ˆå€¼ä¼šåŠ¨æ€å˜åŒ–</strong>ï¼Œä»ä¸€ä¸ªè¾ƒå°å€¼é€æ¸å¢åŠ åˆ°æœ€å¤§é˜ˆå€¼ã€‚</p><p><strong>å·¥ä½œç‰¹ç‚¹</strong>ï¼šè¯·æ±‚é˜ˆå€¼åˆå§‹å€¼æ˜¯ maxThreshold / coldFactor, æŒç»­æŒ‡å®šæ—¶é•¿(é¢„çƒ­æ—¶é—´)åï¼Œé€æ¸æé«˜åˆ°maxThresholdå€¼ï¼Œè€ŒcoldFactorçš„é»˜è®¤å€¼æ˜¯3ã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘è®¾ç½®QPSçš„maxThresholdä¸º10ï¼Œé¢„çƒ­æ—¶é—´ä¸º5ç§’ï¼Œé‚£ä¹ˆåˆå§‹é˜ˆå€¼å°±æ˜¯ 10 / 3 ï¼Œä¹Ÿå°±æ˜¯3ï¼Œç„¶ååœ¨5ç§’åé€æ¸å¢é•¿åˆ°10ã€‚</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20220320152944101-168829026999538.png" alt="image-20220320152944101" tabindex="0" loading="lazy"><figcaption>image-20220320152944101</figcaption></figure><p><strong>æ¡ˆä¾‹éœ€æ±‚</strong>ï¼šç»™/api/user/findUserByUserId/{userId}è¿™ä¸ªèµ„æºè®¾ç½®é™æµï¼Œæœ€å¤§QPSä¸º10ï¼Œåˆ©ç”¨warm upæ•ˆæœï¼Œé¢„çƒ­æ—¶é•¿ä¸º5ç§’</p><p>1ã€é…ç½®æµæ§è§„åˆ™</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628095505037-168829026999539.png" alt="image-20230628095505037" tabindex="0" loading="lazy"><figcaption>image-20230628095505037</figcaption></figure><p>2ã€jmeteræµ‹è¯•</p><p>é€‰æ‹©ã€Šæµæ§æ•ˆæœï¼Œwarm upã€‹</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20220320153409220-168829026999540.png" alt="image-20220320153409220" tabindex="0" loading="lazy"><figcaption>image-20220320153409220</figcaption></figure><p>QPSä¸º10</p><p>åˆšåˆšå¯åŠ¨æ—¶ï¼Œå¤§éƒ¨åˆ†è¯·æ±‚å¤±è´¥ï¼ŒæˆåŠŸçš„åªæœ‰3ä¸ªï¼Œè¯´æ˜QPSè¢«é™å®šåœ¨3ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20220320153522505-168829026999541.png" alt="image-20220320153522505" tabindex="0" loading="lazy"><figcaption>image-20220320153522505</figcaption></figure><p>éšç€æ—¶é—´æ¨ç§»ï¼ŒæˆåŠŸæ¯”ä¾‹è¶Šæ¥è¶Šé«˜</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20220320153646510-168829026999542.png" alt="image-20220320153646510" tabindex="0" loading="lazy"><figcaption>image-20220320153646510</figcaption></figure><p>åˆ°sentinelæ§åˆ¶å°æŸ¥çœ‹å®æ—¶ç›‘æ§</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628095925921-168829026999543.png" alt="image-20230628095925921" tabindex="0" loading="lazy"><figcaption>image-20230628095925921</figcaption></figure><h5 id="æ’é˜Ÿç­‰å¾…" tabindex="-1"><a class="header-anchor" href="#æ’é˜Ÿç­‰å¾…" aria-hidden="true">#</a> æ’é˜Ÿç­‰å¾…</h5><p><strong>æ’é˜Ÿç­‰å¾…</strong>ï¼šè®©æ‰€æœ‰çš„è¯·æ±‚æŒ‰ç…§å…ˆåæ¬¡åºè¿›å…¥åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­è¿›è¡Œæ’é˜Ÿï¼Œå½“æŸä¸€ä¸ªè¯·æ±‚æœ€å¤§çš„é¢„æœŸç­‰å¾…æ—¶é—´è¶…è¿‡äº†æ‰€è®¾å®šçš„è¶…æ—¶æ—¶é—´æ—¶åŒæ ·æ˜¯æ‹’ç»å¹¶æŠ›å‡ºå¼‚å¸¸</p><p>ä¾‹å¦‚ï¼šQPS = 5ï¼Œæ„å‘³ç€æ¯200mså¤„ç†ä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„è¯·æ±‚ï¼›timeout = 2000ï¼Œæ„å‘³ç€<strong>é¢„æœŸç­‰å¾…æ—¶é•¿</strong>è¶…è¿‡2000msçš„è¯·æ±‚ä¼šè¢«æ‹’ç»å¹¶æŠ›å‡ºå¼‚å¸¸ã€‚</p><p>é‚£ä»€ä¹ˆå«åšé¢„æœŸç­‰å¾…æ—¶é•¿å‘¢ï¼Ÿ</p><p>æ¯”å¦‚ç°åœ¨ä¸€ä¸‹å­æ¥äº†12 ä¸ªè¯·æ±‚ï¼Œå› ä¸ºæ¯200msæ‰§è¡Œä¸€ä¸ªè¯·æ±‚ï¼Œé‚£ä¹ˆï¼š</p><p>1ã€ç¬¬6ä¸ªè¯·æ±‚çš„<strong>é¢„æœŸç­‰å¾…æ—¶é•¿</strong> = 200 * ï¼ˆ6 - 1ï¼‰ = 1000ms</p><p>2ã€ç¬¬12ä¸ªè¯·æ±‚çš„é¢„æœŸç­‰å¾…æ—¶é•¿ = 200 * ï¼ˆ12-1ï¼‰ = 2200ms</p><p>ç°åœ¨ï¼Œç¬¬1ç§’åŒæ—¶æ¥æ”¶åˆ°10ä¸ªè¯·æ±‚ï¼Œä½†ç¬¬2ç§’åªæœ‰1ä¸ªè¯·æ±‚ï¼Œæ­¤æ—¶QPSçš„æ›²çº¿è¿™æ ·çš„ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628100019712-168829026999544.png" alt="image-20230628100019712" tabindex="0" loading="lazy"><figcaption>image-20230628100019712</figcaption></figure><p>å¦‚æœä½¿ç”¨é˜Ÿåˆ—æ¨¡å¼åšæµæ§ï¼Œæ‰€æœ‰è¿›å…¥çš„è¯·æ±‚éƒ½è¦æ’é˜Ÿï¼Œä»¥å›ºå®šçš„200msçš„é—´éš”æ‰§è¡Œï¼ŒQPSä¼šå˜çš„å¾ˆå¹³æ»‘</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628100049968-168829026999545.png" alt="image-20230628100049968" tabindex="0" loading="lazy"><figcaption>image-20230628100049968</figcaption></figure><p>å¹³æ»‘çš„QPSæ›²çº¿ï¼Œå¯¹äºæœåŠ¡å™¨æ¥è¯´æ˜¯æ›´å‹å¥½çš„ã€‚</p><p><strong>æ¡ˆä¾‹éœ€æ±‚</strong>ï¼šç»™/api/user/findUserByUserId/{userId}è¿™ä¸ªèµ„æºè®¾ç½®é™æµï¼Œæœ€å¤§QPSä¸º10ï¼Œåˆ©ç”¨æ’é˜Ÿçš„æµæ§æ•ˆæœï¼Œè¶…æ—¶æ—¶é•¿è®¾ç½®ä¸º5s</p><p>1ã€æ·»åŠ æµæ§è§„åˆ™</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628100313331-168829026999546.png" alt="image-20230628100313331" tabindex="0" loading="lazy"><figcaption>image-20230628100313331</figcaption></figure><p>2ã€jmeteræµ‹è¯•</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20220320154801992-168829026999547.png" alt="image-20220320154801992" tabindex="0" loading="lazy"><figcaption>image-20220320154801992</figcaption></figure><p>QPSä¸º15ï¼Œå·²ç»è¶…è¿‡äº†æˆ‘ä»¬è®¾å®šçš„10ã€‚</p><p>è¿è¡Œæµ‹è¯•ç”¨ä¾‹ï¼Œå¯Ÿçœ‹ç»“æœæ ‘ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20220320155103019-168829026999548.png" alt="image-20220320155103019" tabindex="0" loading="lazy"><figcaption>image-20220320155103019</figcaption></figure><p>å…¨éƒ¨éƒ½é€šè¿‡äº†ã€‚</p><p>å†å»sentinelæŸ¥çœ‹å®æ—¶ç›‘æ§çš„QPSæ›²çº¿</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20220320155202523-168829026999549.png" alt="image-20220320155202523" tabindex="0" loading="lazy"><figcaption>image-20220320155202523</figcaption></figure><p>QPSéå¸¸å¹³æ»‘ï¼Œä¸€è‡´ä¿æŒåœ¨10ï¼Œä½†æ˜¯è¶…å‡ºçš„è¯·æ±‚æ²¡æœ‰è¢«æ‹’ç»ï¼Œè€Œæ˜¯æ”¾å…¥é˜Ÿåˆ—ã€‚å› æ­¤<strong>å“åº”æ—¶é—´</strong>ï¼ˆç­‰å¾…æ—¶é—´ï¼‰ä¼šè¶Šæ¥è¶Šé•¿ã€‚</p><h4 id="_8-3-5-çƒ­ç‚¹å‚æ•°é™æµ" tabindex="-1"><a class="header-anchor" href="#_8-3-5-çƒ­ç‚¹å‚æ•°é™æµ" aria-hidden="true">#</a> 8.3.5 çƒ­ç‚¹å‚æ•°é™æµ</h4><h5 id="é…ç½®ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#é…ç½®ä»‹ç»" aria-hidden="true">#</a> é…ç½®ä»‹ç»</h5><p>ä¹‹å‰çš„é™æµæ˜¯ç»Ÿè®¡è®¿é—®æŸä¸ªèµ„æºçš„æ‰€æœ‰è¯·æ±‚ï¼Œåˆ¤æ–­æ˜¯å¦è¶…è¿‡QPSé˜ˆå€¼ã€‚è€Œçƒ­ç‚¹å‚æ•°é™æµæ˜¯<strong>åˆ†åˆ«ç»Ÿè®¡å‚æ•°å€¼ç›¸åŒçš„è¯·æ±‚</strong>ï¼Œåˆ¤æ–­æ˜¯å¦è¶…è¿‡QPSé˜ˆå€¼ã€‚</p><p>ä¾‹å¦‚ï¼Œä¸€ä¸ªæ ¹æ®idæŸ¥è¯¢å•†å“çš„æ¥å£ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628100914491-168829026999550.png" alt="image-20230628100914491" tabindex="0" loading="lazy"><figcaption>image-20230628100914491</figcaption></figure><p>è®¿é—®/goods/{id}çš„è¯·æ±‚ä¸­ï¼Œidå‚æ•°å€¼ä¼šæœ‰å˜åŒ–ï¼Œçƒ­ç‚¹å‚æ•°é™æµä¼šæ ¹æ®å‚æ•°å€¼åˆ†åˆ«ç»Ÿè®¡QPSï¼Œç»Ÿè®¡ç»“æœï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628101012945-168829026999551.png" alt="image-20230628101012945" tabindex="0" loading="lazy"><figcaption>image-20230628101012945</figcaption></figure><p>å½“id=1çš„è¯·æ±‚è§¦å‘é˜ˆå€¼è¢«é™æµæ—¶ï¼Œidå€¼ä¸ä¸º1çš„è¯·æ±‚ä¸å—å½±å“ã€‚</p><p>é…ç½®æ–¹å¼(ç‚¹å‡»èµ„æºä¸­çš„çƒ­ç‚¹æŒ‰é’®)ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628101216576-168829026999552.png" alt="image-20230628101216576" tabindex="0" loading="lazy"><figcaption>image-20230628101216576</figcaption></figure><p>ä»£è¡¨çš„å«ä¹‰æ˜¯ï¼šå¯¹hotè¿™ä¸ªèµ„æºçš„0å·å‚æ•°ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ï¼‰åšç»Ÿè®¡ï¼Œæ¯1ç§’<strong>ç›¸åŒå‚æ•°å€¼</strong>çš„è¯·æ±‚æ•°ä¸èƒ½è¶…è¿‡2ã€‚è¿™ç§é…ç½®æ˜¯å¯¹æŸ¥è¯¢å•†å“è¿™ä¸ªæ¥å£çš„æ‰€æœ‰å•†å“ä¸€è§†åŒä»ï¼ŒQPSéƒ½é™å®šä¸º5ã€‚è€Œåœ¨å®é™…å¼€å‘ä¸­ï¼Œå¯èƒ½éƒ¨åˆ†å•†å“æ˜¯çƒ­ç‚¹å•†å“ï¼Œä¾‹å¦‚ç§’æ€å•†å“ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™éƒ¨åˆ†å•†å“çš„QPSé™åˆ¶ä¸å…¶å®ƒå•†å“ä¸ä¸€æ ·ï¼Œé«˜ä¸€äº›ã€‚é‚£å°±éœ€è¦é…ç½®çƒ­ç‚¹å‚æ•°é™æµçš„é«˜çº§é€‰é¡¹äº†ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628101331468-168829026999553.png" alt="image-20230628101331468" tabindex="0" loading="lazy"><figcaption>image-20230628101331468</figcaption></figure><h5 id="æ¡ˆä¾‹æ¼”ç¤º" tabindex="-1"><a class="header-anchor" href="#æ¡ˆä¾‹æ¼”ç¤º" aria-hidden="true">#</a> æ¡ˆä¾‹æ¼”ç¤º</h5><p><strong>æ¡ˆä¾‹éœ€æ±‚</strong>ï¼šç»™/api/user/findUserByUserId/{userId}è¿™ä¸ªèµ„æºæ·»åŠ çƒ­ç‚¹å‚æ•°é™æµï¼Œè§„åˆ™å¦‚ä¸‹ï¼š</p><p>1ã€é»˜è®¤çš„çƒ­ç‚¹å‚æ•°è§„åˆ™æ˜¯æ¯1ç§’è¯·æ±‚é‡ä¸è¶…è¿‡2</p><p>2ã€ç»™2è¿™ä¸ªå‚æ•°è®¾ç½®ä¾‹å¤–ï¼šæ¯1ç§’è¯·æ±‚é‡ä¸è¶…è¿‡4</p><p>3ã€ç»™3è¿™ä¸ªå‚æ•°è®¾ç½®ä¾‹å¤–ï¼šæ¯1ç§’è¯·æ±‚é‡ä¸è¶…è¿‡10</p><p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼šçƒ­ç‚¹å‚æ•°é™æµå¯¹é»˜è®¤çš„spring mvcèµ„æºæ— æ•ˆï¼Œéœ€è¦åˆ©ç”¨@SentinelResourceæ³¨è§£æ ‡è®°èµ„æº</p><p>å®ç°æ­¥éª¤ï¼š</p><p>1ã€æ ‡è®°èµ„æº</p><p>ç»™UserControllerä¸­çš„/api/user/findUserByUserId/{userId}èµ„æºæ·»åŠ æ³¨è§£ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span><span class="token string">&quot;hot&quot;</span><span class="token punctuation">)</span>  <span class="token comment">// å£°æ˜èµ„æºåç§°</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/findUserByUserId/{userId}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">findUserByUserId</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;userId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId <span class="token punctuation">,</span>
                             <span class="token annotation punctuation">@RequestHeader</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;Truth&quot;</span> <span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token class-name">String</span> header<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;UserController...findUserByUserIdæ–¹æ³•æ‰§è¡Œäº†... ,header: {} , dateformat: {} &quot;</span> <span class="token punctuation">,</span> header <span class="token punctuation">,</span> patternProperties<span class="token punctuation">.</span><span class="token function">getDateformat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> userService<span class="token punctuation">.</span><span class="token function">findUserByUserId</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span> <span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2ã€çƒ­ç‚¹å‚æ•°é™æµè§„åˆ™</p><p>è®¿é—®è¯¥æ¥å£ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ ‡è®°çš„hotèµ„æºå‡ºç°äº†</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628101715773-168829026999554.png" alt="image-20230628101715773" tabindex="0" loading="lazy"><figcaption>image-20230628101715773</figcaption></figure><p>è¿™é‡Œä¸è¦ç‚¹å‡»hotåé¢çš„æŒ‰é’®ï¼Œé¡µé¢æœ‰BUG</p><p>ç‚¹å‡»å·¦ä¾§èœå•ä¸­<strong>çƒ­ç‚¹è§„åˆ™</strong>èœå•ï¼š</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20230628102031276-168829026999555.png" alt="image-20230628102031276" tabindex="0" loading="lazy"><figcaption>image-20230628102031276</figcaption></figure><p>3ã€jmeteræµ‹è¯•</p><p>é€‰æ‹©ã€Šçƒ­ç‚¹å‚æ•°é™æµ QPS1ã€‹</p><figure><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20220320162420189-168829026999556.png" alt="image-20220320162420189" tabindex="0" loading="lazy"><figcaption>image-20220320162420189</figcaption></figure><p>è¿™é‡Œå‘èµ·è¯·æ±‚çš„QPSä¸º5ã€‚</p><p>åŒ…å«ä¸‰ä¸ªè¯·æ±‚ï¼Œå‚æ•°åˆ†åˆ«ä¸ºï¼š101 ï¼Œ 102 ï¼Œ 103ï¼Œè¿è¡Œæµ‹è¯•ç¨‹åºï¼Œå¯Ÿçœ‹ç»“æœæ ‘ï¼š</p><table><thead><tr><th>101</th><th><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231027141831817.png" alt="image-20231027141831817" loading="lazy"></th></tr></thead><tbody><tr><td>102</td><td><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231027141847549.png" alt="image-20231027141847549" loading="lazy"></td></tr><tr><td>103</td><td><img src="https://daimakuai.oss-cn-beijing.aliyuncs.com/img/image-20231027141908376.png" alt="image-20231027141908376" loading="lazy"></td></tr></tbody></table></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/src/SpringBoot/SpringCloud.md" rel="noopener noreferrer" target="_blank" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><!----><!----></div></footer><nav class="vp-page-nav"><a aria-label="SpringBoot" class="vp-link nav-link active prev nav-link active prev" href="/SpringBoot/"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>SpringBoot</div></a><a aria-label="SpringCloud" class="vp-link nav-link active next nav-link active next" href="/SpringBoot/SpringCloud.html"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">SpringCloud<span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span></div></a></nav><div id="comment" class="giscus-wrapper input-top" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">é»˜è®¤é¡µè„š</div><div class="vp-copyright">Copyright Â© 2023 Mr.Hope</div></footer></div><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-bcb92fc7.js" defer></script>
  </body>
</html>
